"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _react = _interopRequireDefault(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react"));
var _useCloudListProvider = require("../hooks/use-cloud-list-provider");
var _componentJestUtils = require("../../../../test/helpers/component-jest-utils");
var _shareMapModal = _interopRequireDefault(require("./share-map-modal"));
var _constants = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/constants/src");
var _react2 = require("@testing-library/react");
var _styledComponents = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/styled-components");
var _reactIntl = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react-intl");
var _styles = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/styles/src");
var _localization = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/localization/src");
function ownKeys(e, r) {
  var t = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    r && (o = o.filter(function (r) {
      return Object.getOwnPropertyDescriptor(e, r).enumerable;
    })), t.push.apply(t, o);
  }
  return t;
}
function _objectSpread(e) {
  for (var r = 1; r < arguments.length; r++) {
    var t = null != arguments[r] ? arguments[r] : {};
    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {
      (0, _defineProperty2["default"])(e, r, t[r]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {
      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));
    });
  }
  return e;
} // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
// @ts-nocheck
jest.mock("../hooks/use-cloud-list-provider", function () {
  return {
    useCloudListProvider: jest.fn().mockImplementation(function () {
      return {
        provider: null,
        setProvider: jest.fn(),
        cloudProviders: []
      };
    })
  };
});
var ShareMapUrlModal = (0, _shareMapModal["default"])();
var DEFAULT_PROPS = {
  isProviderLoading: false,
  onExport: jest.fn(),
  providerError: null,
  successInfo: undefined,
  onUpdateImageSetting: jest.fn(),
  cleanupExportImage: jest.fn()
};
describe('ShareMapModal', function () {
  afterEach(function () {
    jest.clearAllMocks();
  });
  test('renders only list of providers', function () {
    var _renderWithTheme = (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, DEFAULT_PROPS)),
      getByText = _renderWithTheme.getByText,
      queryByTestId = _renderWithTheme.queryByTestId;
    expect(getByText('modal.shareMap.title')).toBeInTheDocument();
    expect(queryByTestId(_constants.dataTestIds.providerShareMap)).toBeNull();
  });
  test('renders list of provider and sharing section', function () {
    var mapProvider = {
      name: 'test provider',
      icon: jest.fn(),
      getManagementUrl: jest.fn().mockImplementation(function () {
        return 'provider.url';
      }),
      listMaps: jest.fn().mockResolvedValue([]),
      hasSharingUrl: jest.fn().mockImplementation(function () {
        return true;
      })
    };
    _useCloudListProvider.useCloudListProvider.mockImplementation(function () {
      return {
        provider: mapProvider,
        setProvider: jest.fn(),
        cloudProviders: []
      };
    });
    var _renderWithTheme2 = (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, DEFAULT_PROPS)),
      getByText = _renderWithTheme2.getByText,
      getByTestId = _renderWithTheme2.getByTestId;
    expect(getByText('modal.shareMap.title')).toBeInTheDocument();
    expect(getByTestId(_constants.dataTestIds.providerShareMap)).toBeInTheDocument();
  });
  test('renders loading when isLoading is set to true', function () {
    var mapProvider = {
      name: 'test provider',
      icon: jest.fn(),
      getManagementUrl: jest.fn().mockImplementation(function () {
        return 'provider.url';
      }),
      listMaps: jest.fn().mockResolvedValue([]),
      hasSharingUrl: jest.fn().mockImplementation(function () {
        return true;
      })
    };
    _useCloudListProvider.useCloudListProvider.mockImplementation(function () {
      return {
        provider: mapProvider,
        setProvider: jest.fn(),
        cloudProviders: []
      };
    });
    var providerLoadingProps = _objectSpread(_objectSpread({}, DEFAULT_PROPS), {}, {
      isProviderLoading: true
    });
    var _renderWithTheme3 = (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, providerLoadingProps)),
      getByText = _renderWithTheme3.getByText;
    expect(getByText('modal.statusPanel.mapUploading')).toBeInTheDocument();
  });
  test('calls onExport when provider is set correctly', function () {
    var mapProvider = {
      name: 'test provider',
      icon: jest.fn(),
      getManagementUrl: jest.fn().mockImplementation(function () {
        return 'provider.url';
      }),
      listMaps: jest.fn().mockResolvedValue([]),
      hasSharingUrl: jest.fn().mockImplementation(function () {
        return true;
      })
    };
    _useCloudListProvider.useCloudListProvider.mockImplementation(function () {
      return {
        provider: mapProvider,
        setProvider: jest.fn(),
        cloudProviders: []
      };
    });
    (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, DEFAULT_PROPS));
    expect(DEFAULT_PROPS.onExport).toHaveBeenCalled();
  });
  test('calls onExport after provider was updated', function () {
    var _renderWithTheme4 = (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, DEFAULT_PROPS)),
      rerender = _renderWithTheme4.rerender;
    var mapProvider = {
      name: 'test provider',
      icon: jest.fn(),
      getManagementUrl: jest.fn().mockImplementation(function () {
        return 'provider.url';
      }),
      listMaps: jest.fn().mockResolvedValue([]),
      hasSharingUrl: jest.fn().mockImplementation(function () {
        return true;
      })
    };
    _useCloudListProvider.useCloudListProvider.mockImplementation(function () {
      return {
        provider: mapProvider,
        setProvider: jest.fn(),
        cloudProviders: []
      };
    });
    (0, _react2.act)(function () {
      rerender( /*#__PURE__*/_react["default"].createElement(_styledComponents.ThemeProvider, {
        theme: _styles.theme
      }, /*#__PURE__*/_react["default"].createElement(_reactIntl.IntlProvider, {
        locale: "en",
        messages: _localization.messages
      }, /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, DEFAULT_PROPS))));
    });
    expect(DEFAULT_PROPS.onExport).toHaveBeenCalled();
  });
  it('displays share URL when provided', function () {
    var shareUrl = 'http://example.com';
    var _renderWithTheme5 = (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, (0, _extends2["default"])({}, DEFAULT_PROPS, {
        successInfo: {
          shareUrl: shareUrl
        }
      }))),
      getByText = _renderWithTheme5.getByText;
    expect(getByText('Share Url')).toBeInTheDocument();
  });
  it('renders errors', function () {
    var _renderWithTheme6 = (0, _componentJestUtils.renderWithTheme)( /*#__PURE__*/_react["default"].createElement(ShareMapUrlModal, (0, _extends2["default"])({}, DEFAULT_PROPS, {
        providerError: new Error('timeout')
      }))),
      getByText = _renderWithTheme6.getByText;
    expect(getByText('modal.statusPanel.error')).toBeInTheDocument();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91c2VDbG91ZExpc3RQcm92aWRlciIsIl9jb21wb25lbnRKZXN0VXRpbHMiLCJfc2hhcmVNYXBNb2RhbCIsIl9jb25zdGFudHMiLCJfcmVhY3QyIiwiX3N0eWxlZENvbXBvbmVudHMiLCJfcmVhY3RJbnRsIiwiX3N0eWxlcyIsIl9sb2NhbGl6YXRpb24iLCJvd25LZXlzIiwiZSIsInIiLCJ0IiwiT2JqZWN0Iiwia2V5cyIsImdldE93blByb3BlcnR5U3ltYm9scyIsIm8iLCJmaWx0ZXIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwicHVzaCIsImFwcGx5IiwiX29iamVjdFNwcmVhZCIsImFyZ3VtZW50cyIsImxlbmd0aCIsImZvckVhY2giLCJfZGVmaW5lUHJvcGVydHkyIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJkZWZpbmVQcm9wZXJ0eSIsImplc3QiLCJtb2NrIiwidXNlQ2xvdWRMaXN0UHJvdmlkZXIiLCJmbiIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInByb3ZpZGVyIiwic2V0UHJvdmlkZXIiLCJjbG91ZFByb3ZpZGVycyIsIlNoYXJlTWFwVXJsTW9kYWwiLCJERUZBVUxUX1BST1BTIiwiaXNQcm92aWRlckxvYWRpbmciLCJvbkV4cG9ydCIsInByb3ZpZGVyRXJyb3IiLCJzdWNjZXNzSW5mbyIsInVuZGVmaW5lZCIsIm9uVXBkYXRlSW1hZ2VTZXR0aW5nIiwiY2xlYW51cEV4cG9ydEltYWdlIiwiZGVzY3JpYmUiLCJhZnRlckVhY2giLCJjbGVhckFsbE1vY2tzIiwidGVzdCIsIl9yZW5kZXJXaXRoVGhlbWUiLCJyZW5kZXJXaXRoVGhlbWUiLCJjcmVhdGVFbGVtZW50IiwiZ2V0QnlUZXh0IiwicXVlcnlCeVRlc3RJZCIsImV4cGVjdCIsInRvQmVJblRoZURvY3VtZW50IiwiZGF0YVRlc3RJZHMiLCJwcm92aWRlclNoYXJlTWFwIiwidG9CZU51bGwiLCJtYXBQcm92aWRlciIsIm5hbWUiLCJpY29uIiwiZ2V0TWFuYWdlbWVudFVybCIsImxpc3RNYXBzIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJoYXNTaGFyaW5nVXJsIiwiX3JlbmRlcldpdGhUaGVtZTIiLCJnZXRCeVRlc3RJZCIsInByb3ZpZGVyTG9hZGluZ1Byb3BzIiwiX3JlbmRlcldpdGhUaGVtZTMiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwiX3JlbmRlcldpdGhUaGVtZTQiLCJyZXJlbmRlciIsImFjdCIsIlRoZW1lUHJvdmlkZXIiLCJ0aGVtZSIsIkludGxQcm92aWRlciIsImxvY2FsZSIsIm1lc3NhZ2VzIiwiaXQiLCJzaGFyZVVybCIsIl9yZW5kZXJXaXRoVGhlbWU1IiwiX2V4dGVuZHMyIiwiX3JlbmRlcldpdGhUaGVtZTYiLCJFcnJvciJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb2RhbHMvc2hhcmUtbWFwLW1vZGFsLnNwZWMudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbi8vIEB0cy1ub2NoZWNrXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHt1c2VDbG91ZExpc3RQcm92aWRlcn0gZnJvbSAnLi4vaG9va3MvdXNlLWNsb3VkLWxpc3QtcHJvdmlkZXInO1xuaW1wb3J0IHtyZW5kZXJXaXRoVGhlbWV9IGZyb20gJ3Rlc3QvaGVscGVycy9jb21wb25lbnQtamVzdC11dGlscyc7XG5pbXBvcnQgU2hhcmVNYXBVcmxNb2RhbEZhY3RvcnkgZnJvbSAnLi9zaGFyZS1tYXAtbW9kYWwnO1xuaW1wb3J0IHtkYXRhVGVzdElkc30gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuaW1wb3J0IHthY3R9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHtUaGVtZVByb3ZpZGVyfSBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQge0ludGxQcm92aWRlcn0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQge3RoZW1lfSBmcm9tICdAa2VwbGVyLmdsL3N0eWxlcyc7XG5pbXBvcnQge21lc3NhZ2VzfSBmcm9tICdAa2VwbGVyLmdsL2xvY2FsaXphdGlvbic7XG5cbmplc3QubW9jaygnLi4vaG9va3MvdXNlLWNsb3VkLWxpc3QtcHJvdmlkZXInLCAoKSA9PiAoe1xuICB1c2VDbG91ZExpc3RQcm92aWRlcjogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xuICAgIHByb3ZpZGVyOiBudWxsLFxuICAgIHNldFByb3ZpZGVyOiBqZXN0LmZuKCksXG4gICAgY2xvdWRQcm92aWRlcnM6IFtdXG4gIH0pKVxufSkpO1xuXG5jb25zdCBTaGFyZU1hcFVybE1vZGFsID0gU2hhcmVNYXBVcmxNb2RhbEZhY3RvcnkoKTtcblxuY29uc3QgREVGQVVMVF9QUk9QUyA9IHtcbiAgaXNQcm92aWRlckxvYWRpbmc6IGZhbHNlLFxuICBvbkV4cG9ydDogamVzdC5mbigpLFxuICBwcm92aWRlckVycm9yOiBudWxsLFxuICBzdWNjZXNzSW5mbzogdW5kZWZpbmVkLFxuICBvblVwZGF0ZUltYWdlU2V0dGluZzogamVzdC5mbigpLFxuICBjbGVhbnVwRXhwb3J0SW1hZ2U6IGplc3QuZm4oKVxufTtcblxuZGVzY3JpYmUoJ1NoYXJlTWFwTW9kYWwnLCAoKSA9PiB7XG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JlbmRlcnMgb25seSBsaXN0IG9mIHByb3ZpZGVycycsICgpID0+IHtcbiAgICBjb25zdCB7Z2V0QnlUZXh0LCBxdWVyeUJ5VGVzdElkfSA9IHJlbmRlcldpdGhUaGVtZSg8U2hhcmVNYXBVcmxNb2RhbCB7Li4uREVGQVVMVF9QUk9QU30gLz4pO1xuICAgIGV4cGVjdChnZXRCeVRleHQoJ21vZGFsLnNoYXJlTWFwLnRpdGxlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KHF1ZXJ5QnlUZXN0SWQoZGF0YVRlc3RJZHMucHJvdmlkZXJTaGFyZU1hcCkpLnRvQmVOdWxsKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JlbmRlcnMgbGlzdCBvZiBwcm92aWRlciBhbmQgc2hhcmluZyBzZWN0aW9uJywgKCkgPT4ge1xuICAgIGNvbnN0IG1hcFByb3ZpZGVyID0ge1xuICAgICAgbmFtZTogJ3Rlc3QgcHJvdmlkZXInLFxuICAgICAgaWNvbjogamVzdC5mbigpLFxuICAgICAgZ2V0TWFuYWdlbWVudFVybDogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAncHJvdmlkZXIudXJsJyksXG4gICAgICBsaXN0TWFwczogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtdKSxcbiAgICAgIGhhc1NoYXJpbmdVcmw6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gdHJ1ZSlcbiAgICB9O1xuICAgIHVzZUNsb3VkTGlzdFByb3ZpZGVyLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xuICAgICAgcHJvdmlkZXI6IG1hcFByb3ZpZGVyLFxuICAgICAgc2V0UHJvdmlkZXI6IGplc3QuZm4oKSxcbiAgICAgIGNsb3VkUHJvdmlkZXJzOiBbXVxuICAgIH0pKTtcblxuICAgIGNvbnN0IHtnZXRCeVRleHQsIGdldEJ5VGVzdElkfSA9IHJlbmRlcldpdGhUaGVtZSg8U2hhcmVNYXBVcmxNb2RhbCB7Li4uREVGQVVMVF9QUk9QU30gLz4pO1xuICAgIGV4cGVjdChnZXRCeVRleHQoJ21vZGFsLnNoYXJlTWFwLnRpdGxlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KGdldEJ5VGVzdElkKGRhdGFUZXN0SWRzLnByb3ZpZGVyU2hhcmVNYXApKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICB0ZXN0KCdyZW5kZXJzIGxvYWRpbmcgd2hlbiBpc0xvYWRpbmcgaXMgc2V0IHRvIHRydWUnLCAoKSA9PiB7XG4gICAgY29uc3QgbWFwUHJvdmlkZXIgPSB7XG4gICAgICBuYW1lOiAndGVzdCBwcm92aWRlcicsXG4gICAgICBpY29uOiBqZXN0LmZuKCksXG4gICAgICBnZXRNYW5hZ2VtZW50VXJsOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICdwcm92aWRlci51cmwnKSxcbiAgICAgIGxpc3RNYXBzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pLFxuICAgICAgaGFzU2hhcmluZ1VybDogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB0cnVlKVxuICAgIH07XG4gICAgdXNlQ2xvdWRMaXN0UHJvdmlkZXIubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XG4gICAgICBwcm92aWRlcjogbWFwUHJvdmlkZXIsXG4gICAgICBzZXRQcm92aWRlcjogamVzdC5mbigpLFxuICAgICAgY2xvdWRQcm92aWRlcnM6IFtdXG4gICAgfSkpO1xuXG4gICAgY29uc3QgcHJvdmlkZXJMb2FkaW5nUHJvcHMgPSB7XG4gICAgICAuLi5ERUZBVUxUX1BST1BTLFxuICAgICAgaXNQcm92aWRlckxvYWRpbmc6IHRydWVcbiAgICB9O1xuXG4gICAgY29uc3Qge2dldEJ5VGV4dH0gPSByZW5kZXJXaXRoVGhlbWUoPFNoYXJlTWFwVXJsTW9kYWwgey4uLnByb3ZpZGVyTG9hZGluZ1Byb3BzfSAvPik7XG4gICAgZXhwZWN0KGdldEJ5VGV4dCgnbW9kYWwuc3RhdHVzUGFuZWwubWFwVXBsb2FkaW5nJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbGxzIG9uRXhwb3J0IHdoZW4gcHJvdmlkZXIgaXMgc2V0IGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCBtYXBQcm92aWRlciA9IHtcbiAgICAgIG5hbWU6ICd0ZXN0IHByb3ZpZGVyJyxcbiAgICAgIGljb246IGplc3QuZm4oKSxcbiAgICAgIGdldE1hbmFnZW1lbnRVcmw6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gJ3Byb3ZpZGVyLnVybCcpLFxuICAgICAgbGlzdE1hcHM6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSksXG4gICAgICBoYXNTaGFyaW5nVXJsOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHRydWUpXG4gICAgfTtcbiAgICB1c2VDbG91ZExpc3RQcm92aWRlci5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgICAgIHByb3ZpZGVyOiBtYXBQcm92aWRlcixcbiAgICAgIHNldFByb3ZpZGVyOiBqZXN0LmZuKCksXG4gICAgICBjbG91ZFByb3ZpZGVyczogW11cbiAgICB9KSk7XG5cbiAgICByZW5kZXJXaXRoVGhlbWUoPFNoYXJlTWFwVXJsTW9kYWwgey4uLkRFRkFVTFRfUFJPUFN9IC8+KTtcblxuICAgIGV4cGVjdChERUZBVUxUX1BST1BTLm9uRXhwb3J0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbGxzIG9uRXhwb3J0IGFmdGVyIHByb3ZpZGVyIHdhcyB1cGRhdGVkJywgKCkgPT4ge1xuICAgIGNvbnN0IHtyZXJlbmRlcn0gPSByZW5kZXJXaXRoVGhlbWUoPFNoYXJlTWFwVXJsTW9kYWwgey4uLkRFRkFVTFRfUFJPUFN9IC8+KTtcblxuICAgIGNvbnN0IG1hcFByb3ZpZGVyID0ge1xuICAgICAgbmFtZTogJ3Rlc3QgcHJvdmlkZXInLFxuICAgICAgaWNvbjogamVzdC5mbigpLFxuICAgICAgZ2V0TWFuYWdlbWVudFVybDogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAncHJvdmlkZXIudXJsJyksXG4gICAgICBsaXN0TWFwczogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtdKSxcbiAgICAgIGhhc1NoYXJpbmdVcmw6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gdHJ1ZSlcbiAgICB9O1xuICAgIHVzZUNsb3VkTGlzdFByb3ZpZGVyLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xuICAgICAgcHJvdmlkZXI6IG1hcFByb3ZpZGVyLFxuICAgICAgc2V0UHJvdmlkZXI6IGplc3QuZm4oKSxcbiAgICAgIGNsb3VkUHJvdmlkZXJzOiBbXVxuICAgIH0pKTtcblxuICAgIGFjdCgoKSA9PiB7XG4gICAgICByZXJlbmRlcihcbiAgICAgICAgPFRoZW1lUHJvdmlkZXIgdGhlbWU9e3RoZW1lfT5cbiAgICAgICAgICA8SW50bFByb3ZpZGVyIGxvY2FsZT1cImVuXCIgbWVzc2FnZXM9e21lc3NhZ2VzfT5cbiAgICAgICAgICAgIDxTaGFyZU1hcFVybE1vZGFsIHsuLi5ERUZBVUxUX1BST1BTfSAvPlxuICAgICAgICAgIDwvSW50bFByb3ZpZGVyPlxuICAgICAgICA8L1RoZW1lUHJvdmlkZXI+XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KERFRkFVTFRfUFJPUFMub25FeHBvcnQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgfSk7XG5cbiAgaXQoJ2Rpc3BsYXlzIHNoYXJlIFVSTCB3aGVuIHByb3ZpZGVkJywgKCkgPT4ge1xuICAgIGNvbnN0IHNoYXJlVXJsID0gJ2h0dHA6Ly9leGFtcGxlLmNvbSc7XG4gICAgY29uc3Qge2dldEJ5VGV4dH0gPSByZW5kZXJXaXRoVGhlbWUoXG4gICAgICA8U2hhcmVNYXBVcmxNb2RhbCB7Li4uREVGQVVMVF9QUk9QU30gc3VjY2Vzc0luZm89e3tzaGFyZVVybH19IC8+XG4gICAgKTtcbiAgICBleHBlY3QoZ2V0QnlUZXh0KCdTaGFyZSBVcmwnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ3JlbmRlcnMgZXJyb3JzJywgKCkgPT4ge1xuICAgIGNvbnN0IHtnZXRCeVRleHR9ID0gcmVuZGVyV2l0aFRoZW1lKFxuICAgICAgPFNoYXJlTWFwVXJsTW9kYWwgey4uLkRFRkFVTFRfUFJPUFN9IHByb3ZpZGVyRXJyb3I9e25ldyBFcnJvcigndGltZW91dCcpfSAvPlxuICAgICk7XG4gICAgZXhwZWN0KGdldEJ5VGV4dCgnbW9kYWwuc3RhdHVzUGFuZWwuZXJyb3InKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFJQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxxQkFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsbUJBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLGNBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFVBQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLE9BQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLGlCQUFBLEdBQUFOLE9BQUE7QUFDQSxJQUFBTyxVQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxPQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxhQUFBLEdBQUFULE9BQUE7QUFBaUQsU0FBQVUsUUFBQUMsQ0FBQSxFQUFBQyxDQUFBO0VBQUEsSUFBQUMsQ0FBQSxHQUFBQyxNQUFBLENBQUFDLElBQUEsQ0FBQUosQ0FBQTtFQUFBLElBQUFHLE1BQUEsQ0FBQUUscUJBQUE7SUFBQSxJQUFBQyxDQUFBLEdBQUFILE1BQUEsQ0FBQUUscUJBQUEsQ0FBQUwsQ0FBQTtJQUFBQyxDQUFBLEtBQUFLLENBQUEsR0FBQUEsQ0FBQSxDQUFBQyxNQUFBLFdBQUFOLENBQUE7TUFBQSxPQUFBRSxNQUFBLENBQUFLLHdCQUFBLENBQUFSLENBQUEsRUFBQUMsQ0FBQSxFQUFBUSxVQUFBO0lBQUEsS0FBQVAsQ0FBQSxDQUFBUSxJQUFBLENBQUFDLEtBQUEsQ0FBQVQsQ0FBQSxFQUFBSSxDQUFBO0VBQUE7RUFBQSxPQUFBSixDQUFBO0FBQUE7QUFBQSxTQUFBVSxjQUFBWixDQUFBO0VBQUEsU0FBQUMsQ0FBQSxNQUFBQSxDQUFBLEdBQUFZLFNBQUEsQ0FBQUMsTUFBQSxFQUFBYixDQUFBO0lBQUEsSUFBQUMsQ0FBQSxXQUFBVyxTQUFB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