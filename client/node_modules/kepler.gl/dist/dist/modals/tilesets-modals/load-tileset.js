"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react"));
var _reactJsonPretty = _interopRequireDefault(require("react-json-pretty"));
var _reactVirtualized = require("react-virtualized");
var _styledComponents = _interopRequireDefault(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/styled-components"));
var _layers = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/layers/src");
var _utils = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/utils/src");
var _loadDataFooter = _interopRequireDefault(require("./load-data-footer"));
var _tilesetIcon = _interopRequireDefault(require("./tileset-icon"));
var _tilesetVectorForm = _interopRequireDefault(require("./tileset-vector-form"));
var _tilesetRasterForm = _interopRequireDefault(require("./tileset-raster-form"));
var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap(),
    t = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {
    return e ? t : r;
  })(e);
}
function _interopRequireWildcard(e, r) {
  if (!r && e && e.__esModule) return e;
  if (null === e || "object" != _typeof(e) && "function" != typeof e) return {
    "default": e
  };
  var t = _getRequireWildcardCache(r);
  if (t && t.has(e)) return t.get(e);
  var n = {
      __proto__: null
    },
    a = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) {
    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
  }
  return n["default"] = e, t && t.set(e, n), n;
}
var WIDTH_ICON = '70px';
var LoadTilesetTabContainer = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  color: ", ";\n"])), function (props) {
  return props.theme.AZURE;
});
var Container = _styledComponents["default"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n  grid-gap: 20px;\n  background-color: ", ";\n"])), function (props) {
  return props.theme.WHITE;
});
var TilesetTypeContainer = _styledComponents["default"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  display: grid;\n  grid-template-columns: repeat(4, ", ");\n  column-gap: 10px;\n  margin-bottom: 20px;\n"])), WIDTH_ICON);
var MetaContainer = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  max-height: 400px;\n  background-color: ", ";\n"])), function (_ref) {
  var theme = _ref.theme;
  return theme.editorBackground;
});
var MetaInnerContainer = _styledComponents["default"].div(_templateObject5 || (_templateObject5 = (0, _taggedTemplateLiteral2["default"])(["\n  position: relative;\n  border: 1px solid ", ";\n  background-color: white;\n  border-radius: 2px;\n  display: inline-block;\n  font: inherit;\n  line-height: 1.5em;\n  padding: 0.5em 3.5em 0.5em 1em;\n  box-sizing: border-box;\n  overflow-y: scroll;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  height: ", "px;\n  width: ", "px;\n  color: ", ";\n  font-size: 11px;\n  font-family: ", ";\n  max-width: 600px;\n"])), function (props) {
  return props.theme.selectBorderColorLT;
}, function (props) {
  return props.height;
}, function (props) {
  return props.width;
}, function (props) {
  return props.theme.textColorLT;
}, function (props) {
  return props.theme.fontFamily;
});
var StyledHeaderMessage = _styledComponents["default"].div(_templateObject6 || (_templateObject6 = (0, _taggedTemplateLiteral2["default"])(["\n  color: ", ";\n  font-size: 14px;\n"])), function (props) {
  return props.theme.textColorLT;
});
var TILE_TYPES = [{
  id: 'vectorTile',
  label: 'Vector Tile',
  Icon: _layers.VectorTileIcon,
  Component: _tilesetVectorForm["default"]
}, {
  id: 'rasterTile',
  label: 'Raster Tile',
  Icon: _layers.RasterTileIcon,
  Component: _tilesetRasterForm["default"]
}];
function isReady(response) {
  return response.dataset && !response.loading && !response.error;
}
function LoadTilesetTabFactory() {
  var LoadTilesetTab = function LoadTilesetTab(_ref2) {
    var onTilesetAdded = _ref2.onTilesetAdded,
      isAddingDatasets = _ref2.isAddingDatasets;
    var _useState = (0, _react.useState)(0),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      typeIndex = _useState2[0],
      setTypeIndex = _useState2[1];
    var _useState3 = (0, _react.useState)({}),
      _useState4 = (0, _slicedToArray2["default"])(_useState3, 2),
      response = _useState4[0],
      setResponse = _useState4[1];
    var error = response.error;
    var loading = response.loading;
    var data = response.metadata;
    var jsonDataText = (0, _react.useMemo)(function () {
      return JSON.stringify(data, null, 2);
    }, [data]);
    var createTileDataset = (0, _react.useCallback)(function () {
      var dataset = response.dataset,
        metadata = response.metadata;
      if (dataset) {
        onTilesetAdded(dataset, metadata);
      }
    }, [onTilesetAdded, response]);

    // temp patch to hide raster tile layer while in development
    var enableRasterTileLayer = (0, _utils.getApplicationConfig)().enableRasterTileLayer;
    var tileTypes = (0, _react.useMemo)(function () {
      return enableRasterTileLayer ? TILE_TYPES : [TILE_TYPES[0]];
    }, [enableRasterTileLayer]);
    var CurrentForm = tileTypes[typeIndex].Component;
    return /*#__PURE__*/_react["default"].createElement(LoadTilesetTabContainer, null, /*#__PURE__*/_react["default"].createElement(Container, null, /*#__PURE__*/_react["default"].createElement("div", null, /*#__PURE__*/_react["default"].createElement(StyledHeaderMessage, null, "Tileset Type"), /*#__PURE__*/_react["default"].createElement(TilesetTypeContainer, {
      className: "tileset-type"
    }, tileTypes.map(function (tileType, index) {
      return /*#__PURE__*/_react["default"].createElement(_tilesetIcon["default"], {
        key: tileType.label,
        name: tileType.label,
        Icon: /*#__PURE__*/_react["default"].createElement(tileType.Icon, {
          height: WIDTH_ICON
        }),
        onClick: function onClick() {
          return setTypeIndex(index);
        },
        selected: typeIndex === index
      });
    })), /*#__PURE__*/_react["default"].createElement("div", null, /*#__PURE__*/_react["default"].createElement(CurrentForm, {
      setResponse: setResponse
    }))), /*#__PURE__*/_react["default"].createElement(MetaContainer, null, data && /*#__PURE__*/_react["default"].createElement(_reactVirtualized.AutoSizer, null, function (_ref3) {
      var height = _ref3.height,
        width = _ref3.width;
      return /*#__PURE__*/_react["default"].createElement(MetaInnerContainer, {
        height: height,
        width: width
      }, /*#__PURE__*/_react["default"].createElement(_reactJsonPretty["default"], {
        id: "json-pretty",
        json: jsonDataText
      }));
    }))), /*#__PURE__*/_react["default"].createElement(_loadDataFooter["default"], {
      disabled: Boolean(error) || !isReady(response),
      isLoading: loading || isAddingDatasets,
      onConfirm: createTileDataset,
      confirmText: "tilesetSetup.addTilesetText",
      errorText: error && (0, _utils.getError)(error)
    }));
  };
  return LoadTilesetTab;
}
var _default = exports["default"] = LoadTilesetTabFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfcmVhY3RKc29uUHJldHR5IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9yZWFjdFZpcnR1YWxpemVkIiwiX3N0eWxlZENvbXBvbmVudHMiLCJfbGF5ZXJzIiwiX3V0aWxzIiwiX2xvYWREYXRhRm9vdGVyIiwiX3RpbGVzZXRJY29uIiwiX3RpbGVzZXRWZWN0b3JGb3JtIiwiX3RpbGVzZXRSYXN0ZXJGb3JtIiwiX3RlbXBsYXRlT2JqZWN0IiwiX3RlbXBsYXRlT2JqZWN0MiIsIl90ZW1wbGF0ZU9iamVjdDMiLCJfdGVtcGxhdGVPYmplY3Q0IiwiX3RlbXBsYXRlT2JqZWN0NSIsIl90ZW1wbGF0ZU9iamVjdDYiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsIl90eXBlb2YiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJXSURUSF9JQ09OIiwiTG9hZFRpbGVzZXRUYWJDb250YWluZXIiLCJkaXYiLCJfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsMiIsInByb3BzIiwidGhlbWUiLCJBWlVSRSIsIkNvbnRhaW5lciIsIldISVRFIiwiVGlsZXNldFR5cGVDb250YWluZXIiLCJNZXRhQ29udGFpbmVyIiwiX3JlZiIsImVkaXRvckJhY2tncm91bmQiLCJNZXRhSW5uZXJDb250YWluZXIiLCJzZWxlY3RCb3JkZXJDb2xvckxUIiwiaGVpZ2h0Iiwid2lkdGgiLCJ0ZXh0Q29sb3JMVCIsImZvbnRGYW1pbHkiLCJTdHlsZWRIZWFkZXJNZXNzYWdlIiwiVElMRV9UWVBFUyIsImlkIiwibGFiZWwiLCJJY29uIiwiVmVjdG9yVGlsZUljb24iLCJDb21wb25lbnQiLCJSYXN0ZXJUaWxlSWNvbiIsImlzUmVhZHkiLCJyZXNwb25zZSIsImRhdGFzZXQiLCJsb2FkaW5nIiwiZXJyb3IiLCJMb2FkVGlsZXNldFRhYkZhY3RvcnkiLCJMb2FkVGlsZXNldFRhYiIsIl9yZWYyIiwib25UaWxlc2V0QWRkZWQiLCJpc0FkZGluZ0RhdGFzZXRzIiwiX3VzZVN0YXRlIiwidXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkyIiwidHlwZUluZGV4Iiwic2V0VHlwZUluZGV4IiwiX3VzZVN0YXRlMyIsIl91c2VTdGF0ZTQiLCJzZXRSZXNwb25zZSIsImRhdGEiLCJtZXRhZGF0YSIsImpzb25EYXRhVGV4dCIsInVzZU1lbW8iLCJKU09OIiwic3RyaW5naWZ5IiwiY3JlYXRlVGlsZURhdGFzZXQiLCJ1c2VDYWxsYmFjayIsImVuYWJsZVJhc3RlclRpbGVMYXllciIsImdldEFwcGxpY2F0aW9uQ29uZmlnIiwidGlsZVR5cGVzIiwiQ3VycmVudEZvcm0iLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwibWFwIiwidGlsZVR5cGUiLCJpbmRleCIsImtleSIsIm5hbWUiLCJvbkNsaWNrIiwic2VsZWN0ZWQiLCJBdXRvU2l6ZXIiLCJfcmVmMyIsImpzb24iLCJkaXNhYmxlZCIsIkJvb2xlYW4iLCJpc0xvYWRpbmciLCJvbkNvbmZpcm0iLCJjb25maXJtVGV4dCIsImVycm9yVGV4dCIsImdldEVycm9yIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL21vZGFscy90aWxlc2V0cy1tb2RhbHMvbG9hZC10aWxlc2V0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgUmVhY3QsIHt1c2VDYWxsYmFjaywgdXNlTWVtbywgdXNlU3RhdGV9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7SW50bFNoYXBlfSBmcm9tICdyZWFjdC1pbnRsJztcbmltcG9ydCBKU09OUHJldHR5IGZyb20gJ3JlYWN0LWpzb24tcHJldHR5JztcbmltcG9ydCB7QXV0b1NpemVyfSBmcm9tICdyZWFjdC12aXJ0dWFsaXplZCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcblxuaW1wb3J0IHtWZWN0b3JUaWxlSWNvbiwgUmFzdGVyVGlsZUljb259IGZyb20gJ0BrZXBsZXIuZ2wvbGF5ZXJzJztcbmltcG9ydCB7Z2V0RXJyb3IsIGdldEFwcGxpY2F0aW9uQ29uZmlnfSBmcm9tICdAa2VwbGVyLmdsL3V0aWxzJztcblxuaW1wb3J0IHtNZXRhUmVzcG9uc2V9IGZyb20gJy4vY29tbW9uJztcbmltcG9ydCBMb2FkRGF0YUZvb3RlciBmcm9tICcuL2xvYWQtZGF0YS1mb290ZXInO1xuaW1wb3J0IFRpbGVzZXRJY29uIGZyb20gJy4vdGlsZXNldC1pY29uJztcbmltcG9ydCBUaWxlc2V0VmVjdG9yRm9ybSBmcm9tICcuL3RpbGVzZXQtdmVjdG9yLWZvcm0nO1xuaW1wb3J0IFRpbGVzZXRSYXN0ZXJGb3JtIGZyb20gJy4vdGlsZXNldC1yYXN0ZXItZm9ybSc7XG5cbmNvbnN0IFdJRFRIX0lDT04gPSAnNzBweCc7XG5cbmNvbnN0IExvYWRUaWxlc2V0VGFiQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuQVpVUkV9O1xuYDtcblxuY29uc3QgQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgZGlzcGxheTogZ3JpZDtcbiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMiwgbWlubWF4KDAsIDFmcikpO1xuICBncmlkLWdhcDogMjBweDtcbiAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5XSElURX07XG5gO1xuXG5jb25zdCBUaWxlc2V0VHlwZUNvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGdyaWQ7XG4gIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDQsICR7V0lEVEhfSUNPTn0pO1xuICBjb2x1bW4tZ2FwOiAxMHB4O1xuICBtYXJnaW4tYm90dG9tOiAyMHB4O1xuYDtcblxuY29uc3QgTWV0YUNvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIG1heC1oZWlnaHQ6IDQwMHB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAkeyh7dGhlbWV9KSA9PiB0aGVtZS5lZGl0b3JCYWNrZ3JvdW5kfTtcbmA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWV0YUlubmVyQ29udGFpbmVyUHJvcHMge1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbn1cblxuY29uc3QgTWV0YUlubmVyQ29udGFpbmVyID0gc3R5bGVkLmRpdjxNZXRhSW5uZXJDb250YWluZXJQcm9wcz5gXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgYm9yZGVyOiAxcHggc29saWQgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5zZWxlY3RCb3JkZXJDb2xvckxUfTtcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICBmb250OiBpbmhlcml0O1xuICBsaW5lLWhlaWdodDogMS41ZW07XG4gIHBhZGRpbmc6IDAuNWVtIDMuNWVtIDAuNWVtIDFlbTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgb3ZlcmZsb3cteTogc2Nyb2xsO1xuICBvdmVyZmxvdy14OiBhdXRvO1xuICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7XG4gIHdvcmQtd3JhcDogYnJlYWstd29yZDtcbiAgaGVpZ2h0OiAke3Byb3BzID0+IHByb3BzLmhlaWdodH1weDtcbiAgd2lkdGg6ICR7cHJvcHMgPT4gcHJvcHMud2lkdGh9cHg7XG4gIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnRleHRDb2xvckxUfTtcbiAgZm9udC1zaXplOiAxMXB4O1xuICBmb250LWZhbWlseTogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5mb250RmFtaWx5fTtcbiAgbWF4LXdpZHRoOiA2MDBweDtcbmA7XG5cbmNvbnN0IFN0eWxlZEhlYWRlck1lc3NhZ2UgPSBzdHlsZWQuZGl2YFxuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS50ZXh0Q29sb3JMVH07XG4gIGZvbnQtc2l6ZTogMTRweDtcbmA7XG5cbnR5cGUgTG9hZFRpbGVzZXRUYWJQcm9wcyA9IHtcbiAgbWV0YToge1trZXk6IHN0cmluZ106IGFueX07XG4gIGlzQWRkaW5nRGF0YXNldHM6IGJvb2xlYW47XG4gIG9uVGlsZXNldEFkZGVkOiAodGlsZXNldEluZm86IGFueSwgbWV0YWRhdGE/OiBhbnkpID0+IHZvaWQ7XG4gIGludGw6IEludGxTaGFwZTtcbn07XG5cbmNvbnN0IFRJTEVfVFlQRVMgPSBbXG4gIHtcbiAgICBpZDogJ3ZlY3RvclRpbGUnLFxuICAgIGxhYmVsOiAnVmVjdG9yIFRpbGUnLFxuICAgIEljb246IFZlY3RvclRpbGVJY29uLFxuICAgIENvbXBvbmVudDogVGlsZXNldFZlY3RvckZvcm1cbiAgfSxcbiAge1xuICAgIGlkOiAncmFzdGVyVGlsZScsXG4gICAgbGFiZWw6ICdSYXN0ZXIgVGlsZScsXG4gICAgSWNvbjogUmFzdGVyVGlsZUljb24sXG4gICAgQ29tcG9uZW50OiBUaWxlc2V0UmFzdGVyRm9ybVxuICB9XG5dO1xuXG5mdW5jdGlvbiBpc1JlYWR5KHJlc3BvbnNlKSB7XG4gIHJldHVybiByZXNwb25zZS5kYXRhc2V0ICYmICFyZXNwb25zZS5sb2FkaW5nICYmICFyZXNwb25zZS5lcnJvcjtcbn1cblxuZnVuY3Rpb24gTG9hZFRpbGVzZXRUYWJGYWN0b3J5KCkge1xuICBjb25zdCBMb2FkVGlsZXNldFRhYjogUmVhY3QuRkM8TG9hZFRpbGVzZXRUYWJQcm9wcz4gPSAoe29uVGlsZXNldEFkZGVkLCBpc0FkZGluZ0RhdGFzZXRzfSkgPT4ge1xuICAgIGNvbnN0IFt0eXBlSW5kZXgsIHNldFR5cGVJbmRleF0gPSB1c2VTdGF0ZTxudW1iZXI+KDApO1xuICAgIGNvbnN0IFtyZXNwb25zZSwgc2V0UmVzcG9uc2VdID0gdXNlU3RhdGU8TWV0YVJlc3BvbnNlPih7fSk7XG5cbiAgICBjb25zdCBlcnJvciA9IHJlc3BvbnNlLmVycm9yO1xuICAgIGNvbnN0IGxvYWRpbmcgPSByZXNwb25zZS5sb2FkaW5nO1xuICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5tZXRhZGF0YTtcbiAgICBjb25zdCBqc29uRGF0YVRleHQgPSB1c2VNZW1vKCgpID0+IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpLCBbZGF0YV0pO1xuXG4gICAgY29uc3QgY3JlYXRlVGlsZURhdGFzZXQgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICBjb25zdCB7ZGF0YXNldCwgbWV0YWRhdGF9ID0gcmVzcG9uc2U7XG4gICAgICBpZiAoZGF0YXNldCkge1xuICAgICAgICBvblRpbGVzZXRBZGRlZChkYXRhc2V0LCBtZXRhZGF0YSk7XG4gICAgICB9XG4gICAgfSwgW29uVGlsZXNldEFkZGVkLCByZXNwb25zZV0pO1xuXG4gICAgLy8gdGVtcCBwYXRjaCB0byBoaWRlIHJhc3RlciB0aWxlIGxheWVyIHdoaWxlIGluIGRldmVsb3BtZW50XG4gICAgY29uc3QgZW5hYmxlUmFzdGVyVGlsZUxheWVyID0gZ2V0QXBwbGljYXRpb25Db25maWcoKS5lbmFibGVSYXN0ZXJUaWxlTGF5ZXI7XG4gICAgY29uc3QgdGlsZVR5cGVzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICByZXR1cm4gZW5hYmxlUmFzdGVyVGlsZUxheWVyID8gVElMRV9UWVBFUyA6IFtUSUxFX1RZUEVTWzBdXTtcbiAgICB9LCBbZW5hYmxlUmFzdGVyVGlsZUxheWVyXSk7XG5cbiAgICBjb25zdCBDdXJyZW50Rm9ybSA9IHRpbGVUeXBlc1t0eXBlSW5kZXhdLkNvbXBvbmVudDtcblxuICAgIHJldHVybiAoXG4gICAgICA8TG9hZFRpbGVzZXRUYWJDb250YWluZXI+XG4gICAgICAgIDxDb250YWluZXI+XG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxTdHlsZWRIZWFkZXJNZXNzYWdlPlRpbGVzZXQgVHlwZTwvU3R5bGVkSGVhZGVyTWVzc2FnZT5cblxuICAgICAgICAgICAgPFRpbGVzZXRUeXBlQ29udGFpbmVyIGNsYXNzTmFtZT1cInRpbGVzZXQtdHlwZVwiPlxuICAgICAgICAgICAgICB7dGlsZVR5cGVzLm1hcCgodGlsZVR5cGUsIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgPFRpbGVzZXRJY29uXG4gICAgICAgICAgICAgICAgICBrZXk9e3RpbGVUeXBlLmxhYmVsfVxuICAgICAgICAgICAgICAgICAgbmFtZT17dGlsZVR5cGUubGFiZWx9XG4gICAgICAgICAgICAgICAgICBJY29uPXs8dGlsZVR5cGUuSWNvbiBoZWlnaHQ9e1dJRFRIX0lDT059IC8+fVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0VHlwZUluZGV4KGluZGV4KX1cbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkPXt0eXBlSW5kZXggPT09IGluZGV4fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgPC9UaWxlc2V0VHlwZUNvbnRhaW5lcj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxDdXJyZW50Rm9ybSBzZXRSZXNwb25zZT17c2V0UmVzcG9uc2V9IC8+XG4gICAgICAgICAgICAgIHsvKiogXG4gICAgICAgICAgICAgIHtlcnJvciAmJiA8ZGl2PntnZXRFcnJvcihlcnJvcil9PC9kaXY+fVxuICAgICAgICAgICAgICAqL31cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxNZXRhQ29udGFpbmVyPlxuICAgICAgICAgICAge2RhdGEgJiYgKFxuICAgICAgICAgICAgICA8QXV0b1NpemVyPlxuICAgICAgICAgICAgICAgIHsoe2hlaWdodCwgd2lkdGh9KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8TWV0YUlubmVyQ29udGFpbmVyIGhlaWdodD17aGVpZ2h0fSB3aWR0aD17d2lkdGh9PlxuICAgICAgICAgICAgICAgICAgICA8SlNPTlByZXR0eSBpZD1cImpzb24tcHJldHR5XCIganNvbj17anNvbkRhdGFUZXh0fSAvPlxuICAgICAgICAgICAgICAgICAgPC9NZXRhSW5uZXJDb250YWluZXI+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPC9BdXRvU2l6ZXI+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvTWV0YUNvbnRhaW5lcj5cbiAgICAgICAgPC9Db250YWluZXI+XG4gICAgICAgIDxMb2FkRGF0YUZvb3RlclxuICAgICAgICAgIGRpc2FibGVkPXtCb29sZWFuKGVycm9yKSB8fCAhaXNSZWFkeShyZXNwb25zZSl9XG4gICAgICAgICAgaXNMb2FkaW5nPXtsb2FkaW5nIHx8IGlzQWRkaW5nRGF0YXNldHN9XG4gICAgICAgICAgb25Db25maXJtPXtjcmVhdGVUaWxlRGF0YXNldH1cbiAgICAgICAgICBjb25maXJtVGV4dD1cInRpbGVzZXRTZXR1cC5hZGRUaWxlc2V0VGV4dFwiXG4gICAgICAgICAgZXJyb3JUZXh0PXtlcnJvciAmJiBnZXRFcnJvcihlcnJvcil9XG4gICAgICAgIC8+XG4gICAgICA8L0xvYWRUaWxlc2V0VGFiQ29udGFpbmVyPlxuICAgICk7XG4gIH07XG5cbiAgcmV0dXJuIExvYWRUaWxlc2V0VGFiO1xufVxuXG5leHBvcnQgZGVmYXVsdCBMb2FkVGlsZXNldFRhYkZhY3Rvcnk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFHQSxJQUFBQSxNQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFFQSxJQUFBQyxnQkFBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcsaUJBQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLGlCQUFBLEdBQUFG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QUEsQ0FBQ0csUUFBUSxDQUFDdEMsSUFBSTtVQUFDUixNQUFNLEVBQUVmO1FBQVcsQ0FBRSxDQUFFO1FBQzVDaUUsT0FBTyxFQUFFLFNBQVRBLE9BQU9BLENBQUE7VUFBQSxPQUFRdkIsWUFBWSxDQUFDb0IsS0FBSyxDQUFDO1FBQUEsQ0FBQztRQUNuQ0ksUUFBUSxFQUFFekIsU0FBUyxLQUFLcUI7TUFBTSxDQUMvQixDQUFDO0lBQUEsQ0FDSCxDQUNtQixDQUFDLGVBQ3ZCckcsTUFBQSxZQUFBaUcsYUFBQSwyQkFDRWpHLE1BQUEsWUFBQWlHLGFBQUEsQ0FBQ0QsV0FBVztNQUFDWixXQUFXLEVBQUVBO0lBQVksQ0FBRSxDQUlyQyxDQUNGLENBQUMsZUFDTnBGLE1BQUEsWUFBQWlHLGFBQUEsQ0FBQ2hELGFBQWEsUUFDWG9DLElBQUksaUJBQ0hyRixNQUFBLFlBQUFpRyxhQUFBLENBQUM1RixpQkFBQSxDQUFBcUcsU0FBUyxRQUNQLFVBQUFDLEtBQUE7TUFBQSxJQUFFckQsTUFBTSxHQUFBcUQsS0FBQSxDQUFOckQsTUFBTTtRQUFFQyxLQUFLLEdBQUFvRCxLQUFBLENBQUxwRCxLQUFLO01BQUEsb0JBQ2R2RCxNQUFBLFlBQUFpRyxhQUFBLENBQUM3QyxrQkFBa0I7UUFBQ0UsTUFBTSxFQUFFQSxNQUFPO1FBQUNDLEtBQUssRUFBRUE7TUFBTSxnQkFDL0N2RCxNQUFBLFlBQUFpRyxhQUFBLENBQUM5RixnQkFBQSxXQUFVO1FBQUN5RCxFQUFFLEVBQUMsYUFBYTtRQUFDZ0QsSUFBSSxFQUFFckI7TUFBYSxDQUFFLENBQ2hDLENBQUM7SUFBQSxDQUVkLENBRUEsQ0FDTixDQUFDLGVBQ1p2RixNQUFBLFlBQUFpRyxhQUFBLENBQUN4RixlQUFBLFdBQWM7TUFDYm9HLFFBQVEsRUFBRUMsT0FBTyxDQUFDeEMsS0FBSyxDQUFDLElBQUksQ0FBQ0osT0FBTyxDQUFDQyxRQUFRLENBQUU7TUFDL0M0QyxTQUFTLEVBQUUxQyxPQUFPLElBQUlNLGdCQUFpQjtNQUN2Q3FDLFNBQVMsRUFBRXJCLGlCQUFrQjtNQUM3QnNCLFdBQVcsRUFBQyw2QkFBNkI7TUFDekNDLFNBQVMsRUFBRTVDLEtBQUssSUFBSSxJQUFBOUQsTUFBQSxDQUFBMkcsUUFBUSxFQUFDN0MsS0FBSztJQUFFLENBQ3JDLENBQ3NCLENBQUM7RUFFOUIsQ0FBQztFQUVELE9BQU9FLGNBQWM7QUFDdkI7QUFBQyxJQUFBNEMsUUFBQSxHQUFBQyxPQUFBLGNBRWM5QyxxQkFBcUIiLCJpZ25vcmVMaXN0IjpbXX0=