"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.adjustCellsToContainer = adjustCellsToContainer;
exports.renderedSize = renderedSize;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _document = _interopRequireDefault(require("global/document"));
var _utils = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/utils/src");
function ownKeys(e, r) {
  var t = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    r && (o = o.filter(function (r) {
      return Object.getOwnPropertyDescriptor(e, r).enumerable;
    })), t.push.apply(t, o);
  }
  return t;
}
function _objectSpread(e) {
  for (var r = 1; r < arguments.length; r++) {
    var t = null != arguments[r] ? arguments[r] : {};
    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {
      (0, _defineProperty2["default"])(e, r, t[r]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {
      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));
    });
  }
  return e;
} // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
var MIN_GHOST_CELL_SIZE = 200;
var MIN_CELL_SIZE = 45;
// first column have padding on the left
var EDGE_COLUMN_PADDING = 10;

// in case cell content is small, column name is big, we allow max empty space to
// be added to min cell width in order to show column name
var MAX_EMPTY_COLUMN_SPACE = 60;
/**
 * Measure rows and column content to determine min width for each column
 * @param {RenderSizeParam} param0
 */
function renderedSize(_ref) {
  var _ref$text = _ref.text,
    dataContainer = _ref$text.dataContainer,
    column = _ref$text.column,
    _ref$type = _ref.type,
    type = _ref$type === void 0 ? 'string' : _ref$type,
    colIdx = _ref.colIdx,
    _ref$numRowsToCalcula = _ref.numRowsToCalculate,
    numRowsToCalculate = _ref$numRowsToCalcula === void 0 ? 10 : _ref$numRowsToCalcula,
    _ref$fontSize = _ref.fontSize,
    fontSize = _ref$fontSize === void 0 ? 12 : _ref$fontSize,
    _ref$font = _ref.font,
    font = _ref$font === void 0 ? 'Lato' : _ref$font,
    _ref$cellPadding = _ref.cellPadding,
    cellPadding = _ref$cellPadding === void 0 ? 40 : _ref$cellPadding,
    _ref$maxCellSize = _ref.maxCellSize,
    maxCellSize = _ref$maxCellSize === void 0 ? 500 : _ref$maxCellSize,
    _ref$maxHeaderSize = _ref.maxHeaderSize,
    maxHeaderSize = _ref$maxHeaderSize === void 0 ? 500 : _ref$maxHeaderSize,
    _ref$minCellSize = _ref.minCellSize,
    minCellSize = _ref$minCellSize === void 0 ? MIN_CELL_SIZE : _ref$minCellSize,
    _ref$optionsButton = _ref.optionsButton,
    optionsButton = _ref$optionsButton === void 0 ? 44 : _ref$optionsButton;
  if (!_document["default"]) {
    return {
      row: 0,
      header: 0
    };
  }
  var textCanvas = _document["default"].createElement('canvas');
  _document["default"].body.appendChild(textCanvas);
  var context = textCanvas.getContext('2d');
  context.font = [fontSize, font].join('px ');
  var rowsToSample = (0, _toConsumableArray2["default"])(Array(numRowsToCalculate)).map(function () {
    return Math.floor(Math.random() * (dataContainer.numRows() - 1));
  });

  // If we have less than 10 rows, lets measure all of them
  if (dataContainer.numRows() <= numRowsToCalculate) {
    rowsToSample = Array.from(Array(dataContainer.numRows()).keys());
  }
  var rowWidth = Math.max.apply(Math, (0, _toConsumableArray2["default"])(rowsToSample.map(function (rowIdx) {
    var value = (0, _utils.parseFieldValue)(dataContainer.valueAt(rowIdx, colIdx), type);
    // measuring large text cause slow performance
    if (value.length > maxCellSize) {
      return maxCellSize;
    }
    var textWidth = context.measureText(value).width;
    return Math.ceil(textWidth) + cellPadding;
  })));
  // header cell only has left padding
  var headerWidth = Math.ceil(context.measureText(column).width) + cellPadding / 2 + optionsButton;

  // min row width is measured by cell content
  var minRowWidth = minCellSize + cellPadding;
  // min header width is measured by cell
  var minHeaderWidth = minCellSize + cellPadding / 2 + optionsButton;
  var clampedRowWidth = clamp(minRowWidth, maxCellSize, rowWidth);
  var clampedHeaderWidth = clamp(minHeaderWidth, maxHeaderSize, headerWidth);

  // cleanup
  textCanvas.parentElement.removeChild(textCanvas);
  return {
    row: clampedRowWidth,
    header: clampedHeaderWidth
  };
}
function clamp(min, max, value) {
  return Math.max(Math.min(max, value), min);
}
function getColumnOrder() {
  var pinnedColumns = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var unpinnedColumns = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  return [].concat((0, _toConsumableArray2["default"])(pinnedColumns), (0, _toConsumableArray2["default"])(unpinnedColumns));
}

// If total min cell size is bigger than containerWidth adjust column
function getMinCellSize(cellSizeCache) {
  return Object.keys(cellSizeCache).reduce(function (accu, col) {
    return _objectSpread(_objectSpread({}, accu), {}, (0, _defineProperty2["default"])({}, col, cellSizeCache[col].row > cellSizeCache[col].header ? cellSizeCache[col].row :
    // if row is smaller than header, use the smaller of MAX_EMPTY_COLUMN_SPACE + row width and header
    Math.min(cellSizeCache[col].header, cellSizeCache[col].row + MAX_EMPTY_COLUMN_SPACE)));
  }, {});
}
function getSizeSum(sizeCache, key) {
  return Object.keys(sizeCache).reduce(function (acc, val) {
    return acc + (key ? sizeCache[val][key] : sizeCache[val]);
  }, 0);
}

/**
 * Expand cell to fit both row and header, if there is still room left,
 * expand last cell to fit the entire width of the container
 * @param {CellSizeCache} cellSizeCache
 * @param {string[]} columnOrder
 * @param {number} containerWidth
 * @param {number} roomToFill
 */
function expandCellSize(cellSizeCache, columnOrder, containerWidth, roomToFill) {
  var remaining = roomToFill;
  var expandedCellSize = columnOrder.reduce(function (accu, col) {
    var size = cellSizeCache[col].row;
    if (cellSizeCache[col].row < cellSizeCache[col].header && remaining > 0) {
      // if we are cutting off the header, expand to fit it
      size = cellSizeCache[col].header - cellSizeCache[col].row < remaining ? cellSizeCache[col].header : cellSizeCache[col].row + remaining;
      remaining -= size - cellSizeCache[col].row;
    }
    return _objectSpread(_objectSpread({}, accu), {}, (0, _defineProperty2["default"])({}, col, size));
  }, {});
  var ghost = null;
  if (remaining > 0 && remaining < MIN_GHOST_CELL_SIZE) {
    // expand last cell
    var lastCell = columnOrder[columnOrder.length - 1];
    expandedCellSize[lastCell] += remaining;
  } else if (remaining >= MIN_GHOST_CELL_SIZE) {
    // if too much left add a ghost cell
    ghost = remaining;
  }
  return {
    cellSizeCache: expandedCellSize,
    ghost: ghost
  };
}
function addPaddingToFirstColumn(cellSizeCache) {
  var columnOrder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  var firstCol = columnOrder[0];
  if (firstCol && cellSizeCache[firstCol]) {
    return _objectSpread(_objectSpread({}, cellSizeCache), {}, (0, _defineProperty2["default"])({}, firstCol, {
      header: cellSizeCache[firstCol].header + EDGE_COLUMN_PADDING,
      row: cellSizeCache[firstCol].row + EDGE_COLUMN_PADDING
    }));
  }
  return cellSizeCache;
}

/**
 * Adjust cell size based on container width
 * @param {number} containerWidth
 * @param {CellSizeCache} cellSizeCache
 * @param {string[]} pinnedColumns
 * @param {string[]} unpinnedColumns
 */
function adjustCellsToContainer(containerWidth, cellSizeCache, pinnedColumns, unpinnedColumns) {
  var columnOrder = getColumnOrder(pinnedColumns, unpinnedColumns);
  var paddedCellSize = addPaddingToFirstColumn(cellSizeCache, columnOrder);
  var minRowSum = getSizeSum(paddedCellSize, 'row');
  if (minRowSum >= containerWidth) {
    // we apply the min Width to all cells
    return {
      cellSizeCache: getMinCellSize(paddedCellSize)
    };
  }
  // if we have some room to expand
  return expandCellSize(paddedCellSize, columnOrder, containerWidth, containerWidth - minRowSum);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZG9jdW1lbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dGlscyIsIm93bktleXMiLCJlIiwiciIsInQiLCJPYmplY3QiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlZmluZVByb3BlcnR5IiwiTUlOX0dIT1NUX0NFTExfU0laRSIsIk1JTl9DRUxMX1NJWkUiLCJFREdFX0NPTFVNTl9QQURESU5HIiwiTUFYX0VNUFRZX0NPTFVNTl9TUEFDRSIsInJlbmRlcmVkU2l6ZSIsIl9yZWYiLCJfcmVmJHRleHQiLCJ0ZXh0IiwiZGF0YUNvbnRhaW5lciIsImNvbHVtbiIsIl9yZWYkdHlwZSIsInR5cGUiLCJjb2xJZHgiLCJfcmVmJG51bVJvd3NUb0NhbGN1bGEiLCJudW1Sb3dzVG9DYWxjdWxhdGUiLCJfcmVmJGZvbnRTaXplIiwiZm9udFNpemUiLCJfcmVmJGZvbnQiLCJmb250IiwiX3JlZiRjZWxsUGFkZGluZyIsImNlbGxQYWRkaW5nIiwiX3JlZiRtYXhDZWxsU2l6ZSIsIm1heENlbGxTaXplIiwiX3JlZiRtYXhIZWFkZXJTaXplIiwibWF4SGVhZGVyU2l6ZSIsIl9yZWYkbWluQ2VsbFNpemUiLCJtaW5DZWxsU2l6ZSIsIl9yZWYkb3B0aW9uc0J1dHRvbiIsIm9wdGlvbnNCdXR0b24iLCJyb3ciLCJoZWFkZXIiLCJ0ZXh0Q2FudmFzIiwiY3JlYXRlRWxlbWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImNvbnRleHQiLCJnZXRDb250ZXh0Iiwiam9pbiIsInJvd3NUb1NhbXBsZSIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJBcnJheSIsIm1hcCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm51bVJvd3MiLCJmcm9tIiwicm93V2lkdGgiLCJtYXgiLCJyb3dJZHgiLCJ2YWx1ZSIsInBhcnNlRmllbGRWYWx1ZSIsInZhbHVlQXQiLCJ0ZXh0V2lkdGgiLCJtZWFzdXJlVGV4dCIsIndpZHRoIiwiY2VpbCIsImhlYWRlcldpZHRoIiwibWluUm93V2lkdGgiLCJtaW5IZWFkZXJXaWR0aCIsImNsYW1wZWRSb3dXaWR0aCIsImNsYW1wIiwiY2xhbXBlZEhlYWRlcldpZHRoIiwicGFyZW50RWxlbWVudCIsInJlbW92ZUNoaWxkIiwibWluIiwiZ2V0Q29sdW1uT3JkZXIiLCJwaW5uZWRDb2x1bW5zIiwidW5kZWZpbmVkIiwidW5waW5uZWRDb2x1bW5zIiwiY29uY2F0IiwiZ2V0TWluQ2VsbFNpemUiLCJjZWxsU2l6ZUNhY2hlIiwicmVkdWNlIiwiYWNjdSIsImNvbCIsImdldFNpemVTdW0iLCJzaXplQ2FjaGUiLCJrZXkiLCJhY2MiLCJ2YWwiLCJleHBhbmRDZWxsU2l6ZSIsImNvbHVtbk9yZGVyIiwiY29udGFpbmVyV2lkdGgiLCJyb29tVG9GaWxsIiwicmVtYWluaW5nIiwiZXhwYW5kZWRDZWxsU2l6ZSIsInNpemUiLCJnaG9zdCIsImxhc3RDZWxsIiwiYWRkUGFkZGluZ1RvRmlyc3RDb2x1bW4iLCJmaXJzdENvbCIsImFkanVzdENlbGxzVG9Db250YWluZXIiLCJwYWRkZWRDZWxsU2l6ZSIsIm1pblJvd1N1bSJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21tb24vZGF0YS10YWJsZS9jZWxsLXNpemUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IGRvY3VtZW50IGZyb20gJ2dsb2JhbC9kb2N1bWVudCc7XG5pbXBvcnQge0RhdGFDb250YWluZXJJbnRlcmZhY2UsIHBhcnNlRmllbGRWYWx1ZX0gZnJvbSAnQGtlcGxlci5nbC91dGlscyc7XG5cbmNvbnN0IE1JTl9HSE9TVF9DRUxMX1NJWkUgPSAyMDA7XG5jb25zdCBNSU5fQ0VMTF9TSVpFID0gNDU7XG4vLyBmaXJzdCBjb2x1bW4gaGF2ZSBwYWRkaW5nIG9uIHRoZSBsZWZ0XG5jb25zdCBFREdFX0NPTFVNTl9QQURESU5HID0gMTA7XG5cbi8vIGluIGNhc2UgY2VsbCBjb250ZW50IGlzIHNtYWxsLCBjb2x1bW4gbmFtZSBpcyBiaWcsIHdlIGFsbG93IG1heCBlbXB0eSBzcGFjZSB0b1xuLy8gYmUgYWRkZWQgdG8gbWluIGNlbGwgd2lkdGggaW4gb3JkZXIgdG8gc2hvdyBjb2x1bW4gbmFtZVxuY29uc3QgTUFYX0VNUFRZX0NPTFVNTl9TUEFDRSA9IDYwO1xuXG50eXBlIFJlbmRlclNpemVQYXJhbSA9IHtcbiAgdGV4dDoge2RhdGFDb250YWluZXI6IERhdGFDb250YWluZXJJbnRlcmZhY2U7IGNvbHVtbjogc3RyaW5nfTtcbiAgdHlwZT86IHN0cmluZztcbiAgY29sSWR4OiBudW1iZXI7XG4gIG51bVJvd3NUb0NhbGN1bGF0ZT86IG51bWJlcjtcbiAgZm9udFNpemU/OiBudW1iZXI7XG4gIGZvbnQ/OiBzdHJpbmc7XG4gIGNlbGxQYWRkaW5nPzogbnVtYmVyO1xuICBtYXhDZWxsU2l6ZT86IG51bWJlcjtcbiAgbWF4SGVhZGVyU2l6ZT86IG51bWJlcjtcbiAgbWluQ2VsbFNpemU/OiBudW1iZXI7XG4gIG9wdGlvbnNCdXR0b24/OiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBDZWxsU2l6ZUNhY2hlID0ge1xuICBba2V5OiBzdHJpbmddOiB7XG4gICAgcm93OiBudW1iZXI7XG4gICAgaGVhZGVyOiBudW1iZXI7XG4gIH07XG59O1xuXG4vKipcbiAqIE1lYXN1cmUgcm93cyBhbmQgY29sdW1uIGNvbnRlbnQgdG8gZGV0ZXJtaW5lIG1pbiB3aWR0aCBmb3IgZWFjaCBjb2x1bW5cbiAqIEBwYXJhbSB7UmVuZGVyU2l6ZVBhcmFtfSBwYXJhbTBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcmVkU2l6ZSh7XG4gIHRleHQ6IHtkYXRhQ29udGFpbmVyLCBjb2x1bW59LFxuICB0eXBlID0gJ3N0cmluZycsXG4gIGNvbElkeCxcbiAgbnVtUm93c1RvQ2FsY3VsYXRlID0gMTAsXG4gIGZvbnRTaXplID0gMTIsXG4gIGZvbnQgPSAnTGF0bycsXG4gIGNlbGxQYWRkaW5nID0gNDAsXG4gIG1heENlbGxTaXplID0gNTAwLFxuICBtYXhIZWFkZXJTaXplID0gNTAwLFxuICBtaW5DZWxsU2l6ZSA9IE1JTl9DRUxMX1NJWkUsXG4gIG9wdGlvbnNCdXR0b24gPSA0NFxufTogUmVuZGVyU2l6ZVBhcmFtKToge3JvdzogbnVtYmVyOyBoZWFkZXI6IG51bWJlcn0ge1xuICBpZiAoIWRvY3VtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJvdzogMCxcbiAgICAgIGhlYWRlcjogMFxuICAgIH07XG4gIH1cblxuICBjb25zdCB0ZXh0Q2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGV4dENhbnZhcyk7XG4gIGNvbnN0IGNvbnRleHQgPSB0ZXh0Q2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gIGNvbnRleHQuZm9udCA9IFtmb250U2l6ZSwgZm9udF0uam9pbigncHggJyk7XG5cbiAgbGV0IHJvd3NUb1NhbXBsZSA9IFsuLi5BcnJheShudW1Sb3dzVG9DYWxjdWxhdGUpXS5tYXAoKCkgPT5cbiAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoZGF0YUNvbnRhaW5lci5udW1Sb3dzKCkgLSAxKSlcbiAgKTtcblxuICAvLyBJZiB3ZSBoYXZlIGxlc3MgdGhhbiAxMCByb3dzLCBsZXRzIG1lYXN1cmUgYWxsIG9mIHRoZW1cbiAgaWYgKGRhdGFDb250YWluZXIubnVtUm93cygpIDw9IG51bVJvd3NUb0NhbGN1bGF0ZSkge1xuICAgIHJvd3NUb1NhbXBsZSA9IEFycmF5LmZyb20oQXJyYXkoZGF0YUNvbnRhaW5lci5udW1Sb3dzKCkpLmtleXMoKSk7XG4gIH1cbiAgY29uc3Qgcm93V2lkdGggPSBNYXRoLm1heChcbiAgICAuLi5yb3dzVG9TYW1wbGUubWFwKHJvd0lkeCA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHBhcnNlRmllbGRWYWx1ZShkYXRhQ29udGFpbmVyLnZhbHVlQXQocm93SWR4LCBjb2xJZHgpLCB0eXBlKTtcbiAgICAgIC8vIG1lYXN1cmluZyBsYXJnZSB0ZXh0IGNhdXNlIHNsb3cgcGVyZm9ybWFuY2VcbiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiBtYXhDZWxsU2l6ZSkge1xuICAgICAgICByZXR1cm4gbWF4Q2VsbFNpemU7XG4gICAgICB9XG4gICAgICBjb25zdCB0ZXh0V2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KHZhbHVlKS53aWR0aDtcbiAgICAgIHJldHVybiBNYXRoLmNlaWwodGV4dFdpZHRoKSArIGNlbGxQYWRkaW5nO1xuICAgIH0pXG4gICk7XG4gIC8vIGhlYWRlciBjZWxsIG9ubHkgaGFzIGxlZnQgcGFkZGluZ1xuICBjb25zdCBoZWFkZXJXaWR0aCA9XG4gICAgTWF0aC5jZWlsKGNvbnRleHQubWVhc3VyZVRleHQoY29sdW1uKS53aWR0aCkgKyBjZWxsUGFkZGluZyAvIDIgKyBvcHRpb25zQnV0dG9uO1xuXG4gIC8vIG1pbiByb3cgd2lkdGggaXMgbWVhc3VyZWQgYnkgY2VsbCBjb250ZW50XG4gIGNvbnN0IG1pblJvd1dpZHRoID0gbWluQ2VsbFNpemUgKyBjZWxsUGFkZGluZztcbiAgLy8gbWluIGhlYWRlciB3aWR0aCBpcyBtZWFzdXJlZCBieSBjZWxsXG4gIGNvbnN0IG1pbkhlYWRlcldpZHRoID0gbWluQ2VsbFNpemUgKyBjZWxsUGFkZGluZyAvIDIgKyBvcHRpb25zQnV0dG9uO1xuXG4gIGNvbnN0IGNsYW1wZWRSb3dXaWR0aCA9IGNsYW1wKG1pblJvd1dpZHRoLCBtYXhDZWxsU2l6ZSwgcm93V2lkdGgpO1xuICBjb25zdCBjbGFtcGVkSGVhZGVyV2lkdGggPSBjbGFtcChtaW5IZWFkZXJXaWR0aCwgbWF4SGVhZGVyU2l6ZSwgaGVhZGVyV2lkdGgpO1xuXG4gIC8vIGNsZWFudXBcbiAgdGV4dENhbnZhcy5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRleHRDYW52YXMpO1xuXG4gIHJldHVybiB7XG4gICAgcm93OiBjbGFtcGVkUm93V2lkdGgsXG4gICAgaGVhZGVyOiBjbGFtcGVkSGVhZGVyV2lkdGhcbiAgfTtcbn1cblxuZnVuY3Rpb24gY2xhbXAobWluLCBtYXgsIHZhbHVlKSB7XG4gIHJldHVybiBNYXRoLm1heChNYXRoLm1pbihtYXgsIHZhbHVlKSwgbWluKTtcbn1cblxuZnVuY3Rpb24gZ2V0Q29sdW1uT3JkZXIocGlubmVkQ29sdW1uczogc3RyaW5nW10gPSBbXSwgdW5waW5uZWRDb2x1bW5zOiBzdHJpbmdbXSA9IFtdKSB7XG4gIHJldHVybiBbLi4ucGlubmVkQ29sdW1ucywgLi4udW5waW5uZWRDb2x1bW5zXTtcbn1cblxuLy8gSWYgdG90YWwgbWluIGNlbGwgc2l6ZSBpcyBiaWdnZXIgdGhhbiBjb250YWluZXJXaWR0aCBhZGp1c3QgY29sdW1uXG5mdW5jdGlvbiBnZXRNaW5DZWxsU2l6ZShjZWxsU2l6ZUNhY2hlOiBDZWxsU2l6ZUNhY2hlKSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhjZWxsU2l6ZUNhY2hlKS5yZWR1Y2UoXG4gICAgKGFjY3UsIGNvbCkgPT4gKHtcbiAgICAgIC4uLmFjY3UsXG4gICAgICAvLyBpZiByb3cgaXMgbGFyZ2VyIHRoYW4gaGVhZGVyLCB1c2Ugcm93XG4gICAgICBbY29sXTpcbiAgICAgICAgY2VsbFNpemVDYWNoZVtjb2xdLnJvdyA+IGNlbGxTaXplQ2FjaGVbY29sXS5oZWFkZXJcbiAgICAgICAgICA/IGNlbGxTaXplQ2FjaGVbY29sXS5yb3dcbiAgICAgICAgICA6IC8vIGlmIHJvdyBpcyBzbWFsbGVyIHRoYW4gaGVhZGVyLCB1c2UgdGhlIHNtYWxsZXIgb2YgTUFYX0VNUFRZX0NPTFVNTl9TUEFDRSArIHJvdyB3aWR0aCBhbmQgaGVhZGVyXG4gICAgICAgICAgICBNYXRoLm1pbihjZWxsU2l6ZUNhY2hlW2NvbF0uaGVhZGVyLCBjZWxsU2l6ZUNhY2hlW2NvbF0ucm93ICsgTUFYX0VNUFRZX0NPTFVNTl9TUEFDRSlcbiAgICB9KSxcbiAgICB7fVxuICApO1xufVxuXG5mdW5jdGlvbiBnZXRTaXplU3VtKHNpemVDYWNoZSwga2V5KSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhzaXplQ2FjaGUpLnJlZHVjZShcbiAgICAoYWNjLCB2YWwpID0+IGFjYyArIChrZXkgPyBzaXplQ2FjaGVbdmFsXVtrZXldIDogc2l6ZUNhY2hlW3ZhbF0pLFxuICAgIDBcbiAgKTtcbn1cblxuLyoqXG4gKiBFeHBhbmQgY2VsbCB0byBmaXQgYm90aCByb3cgYW5kIGhlYWRlciwgaWYgdGhlcmUgaXMgc3RpbGwgcm9vbSBsZWZ0LFxuICogZXhwYW5kIGxhc3QgY2VsbCB0byBmaXQgdGhlIGVudGlyZSB3aWR0aCBvZiB0aGUgY29udGFpbmVyXG4gKiBAcGFyYW0ge0NlbGxTaXplQ2FjaGV9IGNlbGxTaXplQ2FjaGVcbiAqIEBwYXJhbSB7c3RyaW5nW119IGNvbHVtbk9yZGVyXG4gKiBAcGFyYW0ge251bWJlcn0gY29udGFpbmVyV2lkdGhcbiAqIEBwYXJhbSB7bnVtYmVyfSByb29tVG9GaWxsXG4gKi9cbmZ1bmN0aW9uIGV4cGFuZENlbGxTaXplKFxuICBjZWxsU2l6ZUNhY2hlOiBDZWxsU2l6ZUNhY2hlLFxuICBjb2x1bW5PcmRlcjogc3RyaW5nW10sXG4gIGNvbnRhaW5lcldpZHRoOiBudW1iZXIsXG4gIHJvb21Ub0ZpbGw6IG51bWJlclxuKToge1xuICBjZWxsU2l6ZUNhY2hlOiBDZWxsU2l6ZUNhY2hlO1xuICBnaG9zdDogbnVtYmVyIHwgbnVsbDtcbn0ge1xuICBsZXQgcmVtYWluaW5nID0gcm9vbVRvRmlsbDtcblxuICBjb25zdCBleHBhbmRlZENlbGxTaXplID0gY29sdW1uT3JkZXIucmVkdWNlKChhY2N1LCBjb2wpID0+IHtcbiAgICBsZXQgc2l6ZSA9IGNlbGxTaXplQ2FjaGVbY29sXS5yb3c7XG4gICAgaWYgKGNlbGxTaXplQ2FjaGVbY29sXS5yb3cgPCBjZWxsU2l6ZUNhY2hlW2NvbF0uaGVhZGVyICYmIHJlbWFpbmluZyA+IDApIHtcbiAgICAgIC8vIGlmIHdlIGFyZSBjdXR0aW5nIG9mZiB0aGUgaGVhZGVyLCBleHBhbmQgdG8gZml0IGl0XG4gICAgICBzaXplID1cbiAgICAgICAgY2VsbFNpemVDYWNoZVtjb2xdLmhlYWRlciAtIGNlbGxTaXplQ2FjaGVbY29sXS5yb3cgPCByZW1haW5pbmdcbiAgICAgICAgICA/IGNlbGxTaXplQ2FjaGVbY29sXS5oZWFkZXJcbiAgICAgICAgICA6IGNlbGxTaXplQ2FjaGVbY29sXS5yb3cgKyByZW1haW5pbmc7XG4gICAgICByZW1haW5pbmcgLT0gc2l6ZSAtIGNlbGxTaXplQ2FjaGVbY29sXS5yb3c7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmFjY3UsXG4gICAgICBbY29sXTogc2l6ZVxuICAgIH07XG4gIH0sIHt9KTtcblxuICBsZXQgZ2hvc3Q6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBpZiAocmVtYWluaW5nID4gMCAmJiByZW1haW5pbmcgPCBNSU5fR0hPU1RfQ0VMTF9TSVpFKSB7XG4gICAgLy8gZXhwYW5kIGxhc3QgY2VsbFxuICAgIGNvbnN0IGxhc3RDZWxsID0gY29sdW1uT3JkZXJbY29sdW1uT3JkZXIubGVuZ3RoIC0gMV07XG4gICAgZXhwYW5kZWRDZWxsU2l6ZVtsYXN0Q2VsbF0gKz0gcmVtYWluaW5nO1xuICB9IGVsc2UgaWYgKHJlbWFpbmluZyA+PSBNSU5fR0hPU1RfQ0VMTF9TSVpFKSB7XG4gICAgLy8gaWYgdG9vIG11Y2ggbGVmdCBhZGQgYSBnaG9zdCBjZWxsXG4gICAgZ2hvc3QgPSByZW1haW5pbmc7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNlbGxTaXplQ2FjaGU6IGV4cGFuZGVkQ2VsbFNpemUsXG4gICAgZ2hvc3RcbiAgfTtcbn1cblxuZnVuY3Rpb24gYWRkUGFkZGluZ1RvRmlyc3RDb2x1bW4oXG4gIGNlbGxTaXplQ2FjaGU6IENlbGxTaXplQ2FjaGUsXG4gIGNvbHVtbk9yZGVyOiBzdHJpbmdbXSA9IFtdXG4pOiBDZWxsU2l6ZUNhY2hlIHtcbiAgY29uc3QgZmlyc3RDb2wgPSBjb2x1bW5PcmRlclswXTtcblxuICBpZiAoZmlyc3RDb2wgJiYgY2VsbFNpemVDYWNoZVtmaXJzdENvbF0pIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uY2VsbFNpemVDYWNoZSxcbiAgICAgIFtmaXJzdENvbF06IHtcbiAgICAgICAgaGVhZGVyOiBjZWxsU2l6ZUNhY2hlW2ZpcnN0Q29sXS5oZWFkZXIgKyBFREdFX0NPTFVNTl9QQURESU5HLFxuICAgICAgICByb3c6IGNlbGxTaXplQ2FjaGVbZmlyc3RDb2xdLnJvdyArIEVER0VfQ09MVU1OX1BBRERJTkdcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHJldHVybiBjZWxsU2l6ZUNhY2hlO1xufVxuXG4vKipcbiAqIEFkanVzdCBjZWxsIHNpemUgYmFzZWQgb24gY29udGFpbmVyIHdpZHRoXG4gKiBAcGFyYW0ge251bWJlcn0gY29udGFpbmVyV2lkdGhcbiAqIEBwYXJhbSB7Q2VsbFNpemVDYWNoZX0gY2VsbFNpemVDYWNoZVxuICogQHBhcmFtIHtzdHJpbmdbXX0gcGlubmVkQ29sdW1uc1xuICogQHBhcmFtIHtzdHJpbmdbXX0gdW5waW5uZWRDb2x1bW5zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGp1c3RDZWxsc1RvQ29udGFpbmVyKFxuICBjb250YWluZXJXaWR0aDogbnVtYmVyLFxuICBjZWxsU2l6ZUNhY2hlOiBDZWxsU2l6ZUNhY2hlLFxuICBwaW5uZWRDb2x1bW5zOiBzdHJpbmdbXSxcbiAgdW5waW5uZWRDb2x1bW5zOiBzdHJpbmdbXVxuKToge1xuICBjZWxsU2l6ZUNhY2hlOiBDZWxsU2l6ZUNhY2hlO1xuICBnaG9zdD86IG51bWJlciB8IG51bGw7XG59IHtcbiAgY29uc3QgY29sdW1uT3JkZXIgPSBnZXRDb2x1bW5PcmRlcihwaW5uZWRDb2x1bW5zLCB1bnBpbm5lZENvbHVtbnMpO1xuICBjb25zdCBwYWRkZWRDZWxsU2l6ZSA9IGFkZFBhZGRpbmdUb0ZpcnN0Q29sdW1uKGNlbGxTaXplQ2FjaGUsIGNvbHVtbk9yZGVyKTtcbiAgY29uc3QgbWluUm93U3VtID0gZ2V0U2l6ZVN1bShwYWRkZWRDZWxsU2l6ZSwgJ3JvdycpO1xuXG4gIGlmIChtaW5Sb3dTdW0gPj0gY29udGFpbmVyV2lkdGgpIHtcbiAgICAvLyB3ZSBhcHBseSB0aGUgbWluIFdpZHRoIHRvIGFsbCBjZWxsc1xuICAgIHJldHVybiB7Y2VsbFNpemVDYWNoZTogZ2V0TWluQ2VsbFNpemUocGFkZGVkQ2VsbFNpemUpfTtcbiAgfVxuICAvLyBpZiB3ZSBoYXZlIHNvbWUgcm9vbSB0byBleHBhbmRcbiAgcmV0dXJuIGV4cGFuZENlbGxTaXplKHBhZGRlZENlbGxTaXplLCBjb2x1bW5PcmRlciwgY29udGFpbmVyV2lkdGgsIGNvbnRhaW5lcldpZHRoIC0gbWluUm93U3VtKTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUdBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLE1BQUEsR0FBQUQsT0FBQTtBQUF5RSxTQUFBRSxRQUFBQyxDQUFBLEVBQUFDLENBQUE7RUFBQSxJQUFBQyxDQUFBLEdBQUFDLE1BQUEsQ0FBQUMsSUFBQSxDQUFBSixDQUFBO0VBQUEsSUFBQUcsTUFBQSxDQUFBRSxxQkFBQTtJQUFBLElBQUFDLENBQUEsR0FBQUgsTUFBQSxDQUFBRSxxQkFBQSxDQUFBTCxDQUFBO0lBQUFDLENBQUEsS0FBQUssQ0FBQSxHQUFBQSxDQUFBLENBQUFDLE1BQUEsV0FBQU4sQ0FBQTtNQUFBLE9BQUFFLE1BQUEsQ0FBQUssd0JBQUEsQ0FBQVIsQ0FBQSxFQUFBQyxDQUFBLEVBQUFRLFVBQUE7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