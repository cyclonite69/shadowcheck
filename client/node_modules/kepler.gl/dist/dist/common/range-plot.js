"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = RangePlotFactory;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react"));
var _styledComponents = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/styled-components"));
var _rangeBrush = _interopRequireDefault(require("./range-brush"));
var _histogramPlot = _interopRequireDefault(require("./histogram-plot"));
var _lineChart = _interopRequireDefault(require("./line-chart"));
var _utils = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/utils/src");
var _constants = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/constants/src");
var _loadingSpinner = _interopRequireDefault(require("./loading-spinner"));
var _styles = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/styles/src");
var _excluded = ["bins", "onBrush", "range", "value", "width", "plotType", "lineChart", "isEnlarged", "isRanged", "theme"],
  _excluded2 = ["lineChart", "plotType", "bins", "setFilterPlot", "isEnlarged", "theme"];
var _templateObject; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap(),
    t = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {
    return e ? t : r;
  })(e);
}
function _interopRequireWildcard(e, r) {
  if (!r && e && e.__esModule) return e;
  if (null === e || "object" != _typeof(e) && "function" != typeof e) return {
    "default": e
  };
  var t = _getRequireWildcardCache(r);
  if (t && t.has(e)) return t.get(e);
  var n = {
      __proto__: null
    },
    a = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) {
    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
  }
  return n["default"] = e, t && t.set(e, n), n;
}
function ownKeys(e, r) {
  var t = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    r && (o = o.filter(function (r) {
      return Object.getOwnPropertyDescriptor(e, r).enumerable;
    })), t.push.apply(t, o);
  }
  return t;
}
function _objectSpread(e) {
  for (var r = 1; r < arguments.length; r++) {
    var t = null != arguments[r] ? arguments[r] : {};
    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {
      (0, _defineProperty2["default"])(e, r, t[r]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {
      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));
    });
  }
  return e;
}
var StyledRangePlot = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  margin-bottom: ", "px;\n  display: flex;\n  position: relative;\n"])), function (props) {
  return props.theme.sliderBarHeight;
});
RangePlotFactory.deps = [_rangeBrush["default"], _histogramPlot["default"], _lineChart["default"]];
var isHistogramPlot = function isHistogramPlot(plotType) {
  return (plotType === null || plotType === void 0 ? void 0 : plotType.type) === _constants.PLOT_TYPES.histogram;
};
var isLineChart = function isLineChart(plotType) {
  return (plotType === null || plotType === void 0 ? void 0 : plotType.type) === _constants.PLOT_TYPES.lineChart;
};
var hasHistogram = function hasHistogram(plotType, bins) {
  return isHistogramPlot(plotType) && bins;
};
var hasLineChart = function hasLineChart(plotType, lineChart) {
  return isLineChart(plotType) && lineChart;
};
var LOADING_SPINNER_CONTAINER_STYLE = {
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  width: '100%'
};
function RangePlotFactory(RangeBrush, HistogramPlot, LineChartPlot) {
  var RangePlot = function RangePlot(_ref) {
    var bins = _ref.bins,
      onBrush = _ref.onBrush,
      range = _ref.range,
      value = _ref.value,
      width = _ref.width,
      plotType = _ref.plotType,
      lineChart = _ref.lineChart,
      isEnlarged = _ref.isEnlarged,
      isRanged = _ref.isRanged,
      theme = _ref.theme,
      chartProps = (0, _objectWithoutProperties2["default"])(_ref, _excluded);
    var groupColors = (0, _react.useMemo)(function () {
      var dataIds = bins ? Object.keys(bins) : [];
      return plotType.colorsByDataId ? dataIds.reduce(function (acc, dataId) {
        acc[dataId] = plotType.colorsByDataId[dataId];
        return acc;
      }, {}) : null;
    }, [bins, plotType.colorsByDataId]);
    var _useState = (0, _react.useState)(false),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      brushing = _useState2[0],
      setBrushing = _useState2[1];
    var _useState3 = (0, _react.useState)(null),
      _useState4 = (0, _slicedToArray2["default"])(_useState3, 2),
      hoveredDP = _useState4[0],
      onMouseMove = _useState4[1];
    var _useState5 = (0, _react.useState)(false),
      _useState6 = (0, _slicedToArray2["default"])(_useState5, 2),
      enableChartHover = _useState6[0],
      setEnableChartHover = _useState6[1];
    var height = isEnlarged ? (0, _utils.hasMobileWidth)(_styles.breakPointValues) ? theme.rangePlotHLargePalm : theme.rangePlotHLarge : theme.rangePlotH;
    var onBrushStart = (0, _react.useCallback)(function () {
      setBrushing(true);
      onMouseMove(null);
      setEnableChartHover(false);
    }, [setBrushing, onMouseMove, setEnableChartHover]);
    var onBrushEnd = (0, _react.useCallback)(function () {
      setBrushing(false);
      setEnableChartHover(true);
    }, [setBrushing, setEnableChartHover]);
    var onMouseoverHandle = (0, _react.useCallback)(function () {
      onMouseMove(null);
      setEnableChartHover(false);
    }, [onMouseMove, setEnableChartHover]);
    var onMouseoutHandle = (0, _react.useCallback)(function () {
      setEnableChartHover(true);
    }, [setEnableChartHover]);

    // JsDom have limited support for SVG, d3 will fail
    var brushComponent = (0, _utils.isTest)() ? null : /*#__PURE__*/_react["default"].createElement(RangeBrush, (0, _extends2["default"])({
      onBrush: onBrush,
      onBrushStart: onBrushStart,
      onBrushEnd: onBrushEnd,
      range: range,
      value: value,
      width: width,
      height: height,
      isRanged: isRanged,
      onMouseoverHandle: onMouseoverHandle,
      onMouseoutHandle: onMouseoutHandle
    }, chartProps));
    var commonProps = _objectSpread({
      width: width,
      value: value,
      height: height,
      margin: isEnlarged ? theme.rangePlotMarginLarge : theme.rangePlotMargin,
      brushComponent: brushComponent,
      brushing: brushing,
      isEnlarged: isEnlarged,
      enableChartHover: enableChartHover,
      onMouseMove: onMouseMove,
      hoveredDP: hoveredDP,
      isRanged: isRanged,
      onBrush: onBrush
    }, chartProps);
    return isLineChart(plotType) && lineChart ? /*#__PURE__*/_react["default"].createElement(LineChartPlot, (0, _extends2["default"])({
      lineChart: lineChart
    }, commonProps)) : /*#__PURE__*/_react["default"].createElement(HistogramPlot, (0, _extends2["default"])({
      histogramsByGroup: bins,
      colorsByGroup: groupColors,
      range: range
    }, commonProps));
  };
  var RangePlotWithTheme = (0, _styledComponents.withTheme)(RangePlot);

  // a container to render spinner or message when the data is too big
  // to generate a plot
  var WithPlotLoading = function WithPlotLoading(_ref2) {
    var lineChart = _ref2.lineChart,
      plotType = _ref2.plotType,
      bins = _ref2.bins,
      setFilterPlot = _ref2.setFilterPlot,
      isEnlarged = _ref2.isEnlarged,
      theme = _ref2.theme,
      otherProps = (0, _objectWithoutProperties2["default"])(_ref2, _excluded2);
    var _useState7 = (0, _react.useState)(false),
      _useState8 = (0, _slicedToArray2["default"])(_useState7, 2),
      isLoading = _useState8[0],
      setIsLoading = _useState8[1];
    var isChangingRef = (0, _react.useRef)(false);
    (0, _react.useEffect)(function () {
      if (isChangingRef.current) {
        if (hasHistogram(plotType, bins)) {
          // Bins are loaded
          isChangingRef.current = false;
        }
      } else {
        if (!plotType || isHistogramPlot(plotType) && !bins) {
          // load histogram
          setIsLoading(true);
          setFilterPlot({
            plotType: {
              type: _constants.PLOT_TYPES.histogram
            }
          });
          isChangingRef.current = true;
        }
      }
    }, [bins, plotType, setFilterPlot]);
    (0, _react.useEffect)(function () {
      if (isChangingRef.current) {
        if (hasLineChart(plotType, lineChart)) {
          // Line chart is loaded
          isChangingRef.current = false;
        }
      } else {
        if (isLineChart(plotType) && !lineChart) {
          // load line chart
          setIsLoading(true);
          setFilterPlot({
            plotType: {
              type: _constants.PLOT_TYPES.lineChart
            }
          });
          isChangingRef.current = true;
        }
      }
    }, [lineChart, plotType, setFilterPlot]);
    var rangePlotStyle = (0, _react.useMemo)(function () {
      return {
        height: "".concat(isEnlarged ? (0, _utils.hasMobileWidth)(_styles.breakPointValues) ? theme.rangePlotContainerHLargePalm : theme.rangePlotContainerHLarge : theme.rangePlotContainerH, "px")
      };
    }, [isEnlarged, theme]);
    return /*#__PURE__*/_react["default"].createElement(StyledRangePlot, {
      style: rangePlotStyle,
      className: "kg-range-slider__plot"
    }, isLoading ? /*#__PURE__*/_react["default"].createElement("div", {
      style: LOADING_SPINNER_CONTAINER_STYLE
    }, /*#__PURE__*/_react["default"].createElement(_loadingSpinner["default"], {
      borderColor: "transparent",
      size: 40
    })) : /*#__PURE__*/_react["default"].createElement(RangePlotWithTheme, (0, _extends2["default"])({
      lineChart: lineChart,
      bins: bins,
      plotType: plotType,
      isEnlarged: isEnlarged,
      theme: theme
    }, otherProps)));
  };
  return (0, _styledComponents.withTheme)(WithPlotLoading);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfc3R5bGVkQ29tcG9uZW50cyIsIl9yYW5nZUJydXNoIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9oaXN0b2dyYW1QbG90IiwiX2xpbmVDaGFydCIsIl91dGlscyIsIl9jb25zdGFudHMiLCJfbG9hZGluZ1NwaW5uZXIiLCJfc3R5bGVzIiwiX2V4Y2x1ZGVkIiwiX2V4Y2x1ZGVkMiIsIl90ZW1wbGF0ZU9iamVjdCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiX3R5cGVvZiIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIm93bktleXMiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsIlN0eWxlZFJhbmdlUGxvdCIsImRpdiIsIl90YWdnZWRUZW1wbGF0ZUxpdGVyYWwyIiwicHJvcHMiLCJ0aGVtZSIsInNsaWRlckJhckhlaWdodCIsIlJhbmdlUGxvdEZhY3RvcnkiLCJkZXBzIiwiaXNIaXN0b2dyYW1QbG90IiwicGxvdFR5cGUiLCJ0eXBlIiwiUExPVF9UWVBFUyIsImhpc3RvZ3JhbSIsImlzTGluZUNoYXJ0IiwibGluZUNoYXJ0IiwiaGFzSGlzdG9ncmFtIiwiYmlucyIsImhhc0xpbmVDaGFydCIsIkxPQURJTkdfU1BJTk5FUl9DT05UQUlORVJfU1RZTEUiLCJkaXNwbGF5IiwiYWxpZ25JdGVtcyIsImp1c3RpZnlDb250ZW50Iiwid2lkdGgiLCJSYW5nZUJydXNoIiwiSGlzdG9ncmFtUGxvdCIsIkxpbmVDaGFydFBsb3QiLCJSYW5nZVBsb3QiLCJfcmVmIiwib25CcnVzaCIsInJhbmdlIiwidmFsdWUiLCJpc0VubGFyZ2VkIiwiaXNSYW5nZWQiLCJjaGFydFByb3BzIiwiX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzMiIsImdyb3VwQ29sb3JzIiwidXNlTWVtbyIsImRhdGFJZHMiLCJjb2xvcnNCeURhdGFJZCIsInJlZHVjZSIsImFjYyIsImRhdGFJZCIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsImJydXNoaW5nIiwic2V0QnJ1c2hpbmciLCJfdXNlU3RhdGUzIiwiX3VzZVN0YXRlNCIsImhvdmVyZWREUCIsIm9uTW91c2VNb3ZlIiwiX3VzZVN0YXRlNSIsIl91c2VTdGF0ZTYiLCJlbmFibGVDaGFydEhvdmVyIiwic2V0RW5hYmxlQ2hhcnRIb3ZlciIsImhlaWdodCIsImhhc01vYmlsZVdpZHRoIiwiYnJlYWtQb2ludFZhbHVlcyIsInJhbmdlUGxvdEhMYXJnZVBhbG0iLCJyYW5nZVBsb3RITGFyZ2UiLCJyYW5nZVBsb3RIIiwib25CcnVzaFN0YXJ0IiwidXNlQ2FsbGJhY2siLCJvbkJydXNoRW5kIiwib25Nb3VzZW92ZXJIYW5kbGUiLCJvbk1vdXNlb3V0SGFuZGxlIiwiYnJ1c2hDb21wb25lbnQiLCJpc1Rlc3QiLCJjcmVhdGVFbGVtZW50IiwiX2V4dGVuZHMyIiwiY29tbW9uUHJvcHMiLCJtYXJnaW4iLCJyYW5nZVBsb3RNYXJnaW5MYXJnZSIsInJhbmdlUGxvdE1hcmdpbiIsImhpc3RvZ3JhbXNCeUdyb3VwIiwiY29sb3JzQnlHcm91cCIsIlJhbmdlUGxvdFdpdGhUaGVtZSIsIndpdGhUaGVtZSIsIldpdGhQbG90TG9hZGluZyIsIl9yZWYyIiwic2V0RmlsdGVyUGxvdCIsIm90aGVyUHJvcHMiLCJfdXNlU3RhdGU3IiwiX3VzZVN0YXRlOCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsImlzQ2hhbmdpbmdSZWYiLCJ1c2VSZWYiLCJ1c2VFZmZlY3QiLCJjdXJyZW50IiwicmFuZ2VQbG90U3R5bGUiLCJjb25jYXQiLCJyYW5nZVBsb3RDb250YWluZXJITGFyZ2VQYWxtIiwicmFuZ2VQbG90Q29udGFpbmVySExhcmdlIiwicmFuZ2VQbG90Q29udGFpbmVySCIsInN0eWxlIiwiY2xhc3NOYW1lIiwiYm9yZGVyQ29sb3IiLCJzaXplIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbW1vbi9yYW5nZS1wbG90LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgUmVhY3QsIHt1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYsIHVzZVN0YXRlLCBDU1NQcm9wZXJ0aWVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkLCB7d2l0aFRoZW1lfSBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgUmFuZ2VCcnVzaEZhY3RvcnksIHtPbkJydXNoLCBSYW5nZUJydXNoUHJvcHN9IGZyb20gJy4vcmFuZ2UtYnJ1c2gnO1xuaW1wb3J0IEhpc3RvZ3JhbVBsb3RGYWN0b3J5IGZyb20gJy4vaGlzdG9ncmFtLXBsb3QnO1xuaW1wb3J0IExpbmVDaGFydEZhY3RvcnksIHtIb3ZlckRQfSBmcm9tICcuL2xpbmUtY2hhcnQnO1xuaW1wb3J0IHtoYXNNb2JpbGVXaWR0aCwgaXNUZXN0fSBmcm9tICdAa2VwbGVyLmdsL3V0aWxzJztcbmltcG9ydCB7UExPVF9UWVBFU30gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuaW1wb3J0IExvYWRpbmdTcGlubmVyIGZyb20gJy4vbG9hZGluZy1zcGlubmVyJztcbmltcG9ydCB7YnJlYWtQb2ludFZhbHVlc30gZnJvbSAnQGtlcGxlci5nbC9zdHlsZXMnO1xuaW1wb3J0IHtMaW5lQ2hhcnQgYXMgTGluZUNoYXJ0VHlwZSwgRmlsdGVyLCBCaW5zfSBmcm9tICdAa2VwbGVyLmdsL3R5cGVzJztcbmltcG9ydCB7RGF0YXNldHN9IGZyb20gJ0BrZXBsZXIuZ2wvdGFibGUnO1xuXG5jb25zdCBTdHlsZWRSYW5nZVBsb3QgPSBzdHlsZWQuZGl2YFxuICBtYXJnaW4tYm90dG9tOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnNsaWRlckJhckhlaWdodH1weDtcbiAgZGlzcGxheTogZmxleDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuYDtcblxuaW50ZXJmYWNlIFJhbmdlUGxvdFByb3BzIHtcbiAgb25CcnVzaDogT25CcnVzaDtcbiAgcmFuZ2U6IG51bWJlcltdO1xuICB2YWx1ZTogbnVtYmVyW107XG4gIHdpZHRoOiBudW1iZXI7XG4gIHBsb3RUeXBlOiB7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xuICBsaW5lQ2hhcnQ/OiBMaW5lQ2hhcnRUeXBlO1xuICBiaW5zPzogQmlucztcblxuICBpc0VubGFyZ2VkPzogYm9vbGVhbjtcbiAgaXNSYW5nZWQ/OiBib29sZWFuO1xuICB0aGVtZTogYW55O1xuICB0aW1lRm9ybWF0Pzogc3RyaW5nO1xuICB0aW1lem9uZT86IHN0cmluZyB8IG51bGw7XG4gIHBsYXliYWNrQ29udHJvbFdpZHRoPzogbnVtYmVyO1xuXG4gIGFuaW1hdGlvbldpbmRvdz86IHN0cmluZztcbiAgZmlsdGVyPzogRmlsdGVyO1xuICBkYXRhc2V0cz86IERhdGFzZXRzO1xuXG4gIGludmVydFRyZW5kQ29sb3I/OiBib29sZWFuO1xuXG4gIHN0eWxlOiBDU1NQcm9wZXJ0aWVzO1xufVxuXG50eXBlIFdpdGhQbG90TG9hZGluZ1Byb3BzID0gUmFuZ2VQbG90UHJvcHMgJlxuICBQYXJ0aWFsPFJhbmdlQnJ1c2hQcm9wcz4gJiB7XG4gICAgc2V0RmlsdGVyUGxvdDogYW55O1xuICB9O1xuXG5SYW5nZVBsb3RGYWN0b3J5LmRlcHMgPSBbUmFuZ2VCcnVzaEZhY3RvcnksIEhpc3RvZ3JhbVBsb3RGYWN0b3J5LCBMaW5lQ2hhcnRGYWN0b3J5XTtcblxuY29uc3QgaXNIaXN0b2dyYW1QbG90ID0gcGxvdFR5cGUgPT4gcGxvdFR5cGU/LnR5cGUgPT09IFBMT1RfVFlQRVMuaGlzdG9ncmFtO1xuY29uc3QgaXNMaW5lQ2hhcnQgPSBwbG90VHlwZSA9PiBwbG90VHlwZT8udHlwZSA9PT0gUExPVF9UWVBFUy5saW5lQ2hhcnQ7XG5jb25zdCBoYXNIaXN0b2dyYW0gPSAocGxvdFR5cGUsIGJpbnMpID0+IGlzSGlzdG9ncmFtUGxvdChwbG90VHlwZSkgJiYgYmlucztcbmNvbnN0IGhhc0xpbmVDaGFydCA9IChwbG90VHlwZSwgbGluZUNoYXJ0KSA9PiBpc0xpbmVDaGFydChwbG90VHlwZSkgJiYgbGluZUNoYXJ0O1xuXG5jb25zdCBMT0FESU5HX1NQSU5ORVJfQ09OVEFJTkVSX1NUWUxFID0ge1xuICBkaXNwbGF5OiAnZmxleCcsXG4gIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gIHdpZHRoOiAnMTAwJSdcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFJhbmdlUGxvdEZhY3RvcnkoXG4gIFJhbmdlQnJ1c2g6IFJldHVyblR5cGU8dHlwZW9mIFJhbmdlQnJ1c2hGYWN0b3J5PixcbiAgSGlzdG9ncmFtUGxvdDogUmV0dXJuVHlwZTx0eXBlb2YgSGlzdG9ncmFtUGxvdEZhY3Rvcnk+LFxuICBMaW5lQ2hhcnRQbG90OiBSZXR1cm5UeXBlPHR5cGVvZiBMaW5lQ2hhcnRGYWN0b3J5PlxuKSB7XG4gIGNvbnN0IFJhbmdlUGxvdCA9ICh7XG4gICAgYmlucyxcbiAgICBvbkJydXNoLFxuICAgIHJhbmdlLFxuICAgIHZhbHVlLFxuICAgIHdpZHRoLFxuICAgIHBsb3RUeXBlLFxuICAgIGxpbmVDaGFydCxcbiAgICBpc0VubGFyZ2VkLFxuICAgIGlzUmFuZ2VkLFxuICAgIHRoZW1lLFxuICAgIC4uLmNoYXJ0UHJvcHNcbiAgfTogUmFuZ2VQbG90UHJvcHMgJiBQYXJ0aWFsPFJhbmdlQnJ1c2hQcm9wcz4pID0+IHtcbiAgICBjb25zdCBncm91cENvbG9ycyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YUlkcyA9IGJpbnMgPyBPYmplY3Qua2V5cyhiaW5zKSA6IFtdO1xuICAgICAgcmV0dXJuIHBsb3RUeXBlLmNvbG9yc0J5RGF0YUlkXG4gICAgICAgID8gZGF0YUlkcy5yZWR1Y2UoKGFjYywgZGF0YUlkKSA9PiB7XG4gICAgICAgICAgICBhY2NbZGF0YUlkXSA9IHBsb3RUeXBlLmNvbG9yc0J5RGF0YUlkW2RhdGFJZF07XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgIH0sIHt9KVxuICAgICAgICA6IG51bGw7XG4gICAgfSwgW2JpbnMsIHBsb3RUeXBlLmNvbG9yc0J5RGF0YUlkXSk7XG5cbiAgICBjb25zdCBbYnJ1c2hpbmcsIHNldEJydXNoaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbaG92ZXJlZERQLCBvbk1vdXNlTW92ZV0gPSB1c2VTdGF0ZTxIb3ZlckRQIHwgbnVsbD4obnVsbCk7XG4gICAgY29uc3QgW2VuYWJsZUNoYXJ0SG92ZXIsIHNldEVuYWJsZUNoYXJ0SG92ZXJdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IGhlaWdodCA9IGlzRW5sYXJnZWRcbiAgICAgID8gaGFzTW9iaWxlV2lkdGgoYnJlYWtQb2ludFZhbHVlcylcbiAgICAgICAgPyB0aGVtZS5yYW5nZVBsb3RITGFyZ2VQYWxtXG4gICAgICAgIDogdGhlbWUucmFuZ2VQbG90SExhcmdlXG4gICAgICA6IHRoZW1lLnJhbmdlUGxvdEg7XG5cbiAgICBjb25zdCBvbkJydXNoU3RhcnQgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICBzZXRCcnVzaGluZyh0cnVlKTtcbiAgICAgIG9uTW91c2VNb3ZlKG51bGwpO1xuICAgICAgc2V0RW5hYmxlQ2hhcnRIb3ZlcihmYWxzZSk7XG4gICAgfSwgW3NldEJydXNoaW5nLCBvbk1vdXNlTW92ZSwgc2V0RW5hYmxlQ2hhcnRIb3Zlcl0pO1xuXG4gICAgY29uc3Qgb25CcnVzaEVuZCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIHNldEJydXNoaW5nKGZhbHNlKTtcbiAgICAgIHNldEVuYWJsZUNoYXJ0SG92ZXIodHJ1ZSk7XG4gICAgfSwgW3NldEJydXNoaW5nLCBzZXRFbmFibGVDaGFydEhvdmVyXSk7XG5cbiAgICBjb25zdCBvbk1vdXNlb3ZlckhhbmRsZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIG9uTW91c2VNb3ZlKG51bGwpO1xuICAgICAgc2V0RW5hYmxlQ2hhcnRIb3ZlcihmYWxzZSk7XG4gICAgfSwgW29uTW91c2VNb3ZlLCBzZXRFbmFibGVDaGFydEhvdmVyXSk7XG5cbiAgICBjb25zdCBvbk1vdXNlb3V0SGFuZGxlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgc2V0RW5hYmxlQ2hhcnRIb3Zlcih0cnVlKTtcbiAgICB9LCBbc2V0RW5hYmxlQ2hhcnRIb3Zlcl0pO1xuXG4gICAgLy8gSnNEb20gaGF2ZSBsaW1pdGVkIHN1cHBvcnQgZm9yIFNWRywgZDMgd2lsbCBmYWlsXG4gICAgY29uc3QgYnJ1c2hDb21wb25lbnQgPSBpc1Rlc3QoKSA/IG51bGwgOiAoXG4gICAgICA8UmFuZ2VCcnVzaFxuICAgICAgICBvbkJydXNoPXtvbkJydXNofVxuICAgICAgICBvbkJydXNoU3RhcnQ9e29uQnJ1c2hTdGFydH1cbiAgICAgICAgb25CcnVzaEVuZD17b25CcnVzaEVuZH1cbiAgICAgICAgcmFuZ2U9e3JhbmdlfVxuICAgICAgICB2YWx1ZT17dmFsdWV9XG4gICAgICAgIHdpZHRoPXt3aWR0aH1cbiAgICAgICAgaGVpZ2h0PXtoZWlnaHR9XG4gICAgICAgIGlzUmFuZ2VkPXtpc1JhbmdlZH1cbiAgICAgICAgb25Nb3VzZW92ZXJIYW5kbGU9e29uTW91c2VvdmVySGFuZGxlfVxuICAgICAgICBvbk1vdXNlb3V0SGFuZGxlPXtvbk1vdXNlb3V0SGFuZGxlfVxuICAgICAgICB7Li4uY2hhcnRQcm9wc31cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIGNvbnN0IGNvbW1vblByb3BzID0ge1xuICAgICAgd2lkdGgsXG4gICAgICB2YWx1ZSxcbiAgICAgIGhlaWdodCxcbiAgICAgIG1hcmdpbjogaXNFbmxhcmdlZCA/IHRoZW1lLnJhbmdlUGxvdE1hcmdpbkxhcmdlIDogdGhlbWUucmFuZ2VQbG90TWFyZ2luLFxuICAgICAgYnJ1c2hDb21wb25lbnQsXG4gICAgICBicnVzaGluZyxcbiAgICAgIGlzRW5sYXJnZWQsXG4gICAgICBlbmFibGVDaGFydEhvdmVyLFxuICAgICAgb25Nb3VzZU1vdmUsXG4gICAgICBob3ZlcmVkRFAsXG4gICAgICBpc1JhbmdlZCxcbiAgICAgIG9uQnJ1c2gsXG4gICAgICAuLi5jaGFydFByb3BzXG4gICAgfTtcblxuICAgIHJldHVybiBpc0xpbmVDaGFydChwbG90VHlwZSkgJiYgbGluZUNoYXJ0ID8gKFxuICAgICAgPExpbmVDaGFydFBsb3QgbGluZUNoYXJ0PXtsaW5lQ2hhcnR9IHsuLi5jb21tb25Qcm9wc30gLz5cbiAgICApIDogKFxuICAgICAgPEhpc3RvZ3JhbVBsb3RcbiAgICAgICAgaGlzdG9ncmFtc0J5R3JvdXA9e2JpbnN9XG4gICAgICAgIGNvbG9yc0J5R3JvdXA9e2dyb3VwQ29sb3JzfVxuICAgICAgICByYW5nZT17cmFuZ2V9XG4gICAgICAgIHsuLi5jb21tb25Qcm9wc31cbiAgICAgIC8+XG4gICAgKTtcbiAgfTtcblxuICBjb25zdCBSYW5nZVBsb3RXaXRoVGhlbWUgPSB3aXRoVGhlbWUoUmFuZ2VQbG90KSBhcyBSZWFjdC5GQzxcbiAgICBSYW5nZVBsb3RQcm9wcyAmIFBhcnRpYWw8UmFuZ2VCcnVzaFByb3BzPlxuICA+O1xuXG4gIC8vIGEgY29udGFpbmVyIHRvIHJlbmRlciBzcGlubmVyIG9yIG1lc3NhZ2Ugd2hlbiB0aGUgZGF0YSBpcyB0b28gYmlnXG4gIC8vIHRvIGdlbmVyYXRlIGEgcGxvdFxuICBjb25zdCBXaXRoUGxvdExvYWRpbmcgPSAoe1xuICAgIGxpbmVDaGFydCxcbiAgICBwbG90VHlwZSxcbiAgICBiaW5zLFxuICAgIHNldEZpbHRlclBsb3QsXG4gICAgaXNFbmxhcmdlZCxcbiAgICB0aGVtZSxcbiAgICAuLi5vdGhlclByb3BzXG4gIH06IFdpdGhQbG90TG9hZGluZ1Byb3BzKSA9PiB7XG4gICAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBpc0NoYW5naW5nUmVmID0gdXNlUmVmKGZhbHNlKTtcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICBpZiAoaXNDaGFuZ2luZ1JlZi5jdXJyZW50KSB7XG4gICAgICAgIGlmIChoYXNIaXN0b2dyYW0ocGxvdFR5cGUsIGJpbnMpKSB7XG4gICAgICAgICAgLy8gQmlucyBhcmUgbG9hZGVkXG4gICAgICAgICAgaXNDaGFuZ2luZ1JlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghcGxvdFR5cGUgfHwgKGlzSGlzdG9ncmFtUGxvdChwbG90VHlwZSkgJiYgIWJpbnMpKSB7XG4gICAgICAgICAgLy8gbG9hZCBoaXN0b2dyYW1cbiAgICAgICAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgICAgICAgc2V0RmlsdGVyUGxvdCh7cGxvdFR5cGU6IHt0eXBlOiBQTE9UX1RZUEVTLmhpc3RvZ3JhbX19KTtcbiAgICAgICAgICBpc0NoYW5naW5nUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgW2JpbnMsIHBsb3RUeXBlLCBzZXRGaWx0ZXJQbG90XSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgaWYgKGlzQ2hhbmdpbmdSZWYuY3VycmVudCkge1xuICAgICAgICBpZiAoaGFzTGluZUNoYXJ0KHBsb3RUeXBlLCBsaW5lQ2hhcnQpKSB7XG4gICAgICAgICAgLy8gTGluZSBjaGFydCBpcyBsb2FkZWRcbiAgICAgICAgICBpc0NoYW5naW5nUmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGlzTGluZUNoYXJ0KHBsb3RUeXBlKSAmJiAhbGluZUNoYXJ0KSB7XG4gICAgICAgICAgLy8gbG9hZCBsaW5lIGNoYXJ0XG4gICAgICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgICAgIHNldEZpbHRlclBsb3Qoe3Bsb3RUeXBlOiB7dHlwZTogUExPVF9UWVBFUy5saW5lQ2hhcnR9fSk7XG4gICAgICAgICAgaXNDaGFuZ2luZ1JlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIFtsaW5lQ2hhcnQsIHBsb3RUeXBlLCBzZXRGaWx0ZXJQbG90XSk7XG5cbiAgICBjb25zdCByYW5nZVBsb3RTdHlsZSA9IHVzZU1lbW8oXG4gICAgICAoKSA9PiAoe1xuICAgICAgICBoZWlnaHQ6IGAke1xuICAgICAgICAgIGlzRW5sYXJnZWRcbiAgICAgICAgICAgID8gaGFzTW9iaWxlV2lkdGgoYnJlYWtQb2ludFZhbHVlcylcbiAgICAgICAgICAgICAgPyB0aGVtZS5yYW5nZVBsb3RDb250YWluZXJITGFyZ2VQYWxtXG4gICAgICAgICAgICAgIDogdGhlbWUucmFuZ2VQbG90Q29udGFpbmVySExhcmdlXG4gICAgICAgICAgICA6IHRoZW1lLnJhbmdlUGxvdENvbnRhaW5lckhcbiAgICAgICAgfXB4YFxuICAgICAgfSksXG4gICAgICBbaXNFbmxhcmdlZCwgdGhlbWVdXG4gICAgKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3R5bGVkUmFuZ2VQbG90IHN0eWxlPXtyYW5nZVBsb3RTdHlsZX0gY2xhc3NOYW1lPVwia2ctcmFuZ2Utc2xpZGVyX19wbG90XCI+XG4gICAgICAgIHtpc0xvYWRpbmcgPyAoXG4gICAgICAgICAgPGRpdiBzdHlsZT17TE9BRElOR19TUElOTkVSX0NPTlRBSU5FUl9TVFlMRX0+XG4gICAgICAgICAgICA8TG9hZGluZ1NwaW5uZXIgYm9yZGVyQ29sb3I9XCJ0cmFuc3BhcmVudFwiIHNpemU9ezQwfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxSYW5nZVBsb3RXaXRoVGhlbWVcbiAgICAgICAgICAgIGxpbmVDaGFydD17bGluZUNoYXJ0fVxuICAgICAgICAgICAgYmlucz17Ymluc31cbiAgICAgICAgICAgIHBsb3RUeXBlPXtwbG90VHlwZX1cbiAgICAgICAgICAgIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9XG4gICAgICAgICAgICB0aGVtZT17dGhlbWV9XG4gICAgICAgICAgICB7Li4ub3RoZXJQcm9wc31cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgPC9TdHlsZWRSYW5nZVBsb3Q+XG4gICAgKTtcbiAgfTtcblxuICByZXR1cm4gd2l0aFRoZW1lKFdpdGhQbG90TG9hZGluZykgYXMgUmVhY3QuRkM8T21pdDxXaXRoUGxvdExvYWRpbmdQcm9wcywgJ3RoZW1lJz4+O1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBR0EsSUFBQUEsTUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsaUJBQUEsR0FBQUYsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFdBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLGNBQUEsR0FBQUQsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFLLFVBQUEsR0FBQUYsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFNLE1BQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFVBQUEsR0FBQVAsT0FBQTtBQUNBLElBQUFRLGVBQUEsR0FBQUwsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFTLE9BQUEsR0FBQVQsT0FBQTtBQUFtRCxJ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