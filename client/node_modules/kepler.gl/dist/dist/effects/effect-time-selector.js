"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react"));
var _styledComponents = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/styled-components"));
var _classnames = _interopRequireDefault(require("classnames"));
var _momentTimezone = _interopRequireDefault(require("moment-timezone"));
var _itemSelector = _interopRequireDefault(require("../common/item-selector/item-selector"));
var _styledComponents2 = require("../common/styled-components");
var _dropdownList = require("../common/item-selector/dropdown-list");
var _templateObject, _templateObject2, _templateObject3, _templateObject4; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap(),
    t = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {
    return e ? t : r;
  })(e);
}
function _interopRequireWildcard(e, r) {
  if (!r && e && e.__esModule) return e;
  if (null === e || "object" != _typeof(e) && "function" != typeof e) return {
    "default": e
  };
  var t = _getRequireWildcardCache(r);
  if (t && t.has(e)) return t.get(e);
  var n = {
      __proto__: null
    },
    a = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) {
    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
  }
  return n["default"] = e, t && t.set(e, n), n;
}
var HEADER_ITEM_ID = 'HEADER_ITEM_ID';
var StyledEffectTimeSelector = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  .item-selector {\n    background-color: transparent;\n  }\n  .item-selector .item-selector__dropdown {\n    padding: 0px;\n    width: 110px;\n    height: 30px;\n  }\n  border: 1px solid ", ";\n  border-radius: 4px;\n  &:hover {\n    border: 1px solid ", ";\n  }\n  .active {\n    border: 1px solid ", ";\n    border-radius: 4px 4px 0px 0px;\n  }\n"])), function (props) {
  return props.theme.inputBgd;
}, function (props) {
  return props.theme.inputBgdHover;
}, function (props) {
  return props.theme.activeColor;
});
var StyledLabel = _styledComponents["default"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  color: ", ";\n  font-size: ", ";\n  height: 13px;\n  display: flex;\n  align-items: center;\n"])), function (props) {
  return props.theme.effectPanelTextMain;
}, function (props) {
  return props.theme.inputFontSize;
});
var DropdownListWrapper = _styledComponents["default"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  ", ";\n  background-color: ", ";\n  display: flex;\n  flex-wrap: wrap;\n  padding: 0px;\n  max-height: 160px;\n  border-radius: 0px 0px 4px 4px;\n"])), function (props) {
  return props.theme.dropdownList;
}, function (props) {
  return props.theme.inputBgdHover;
});
var StyledDropdownListItem = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  padding: 10px 5px 9px 10px;\n  width: 100%;\n  &:hover {\n    background-color: ", ";\n    cursor: pointer;\n  }\n"])), function (props) {
  return props.theme.effectPanelElementColorSelected;
});

// Generate time options for the dropdown with 30 min intervals.
var timeOptions = function () {
  var m = (0, _momentTimezone["default"])().utcOffset(0);
  m.set({
    hour: 12,
    minute: 0,
    second: 0,
    millisecond: 0
  });
  var out = [];
  for (var i = 0; i < 48; i++) {
    out.push({
      name: m.format('hh:mm A'),
      id: m.format('HH:mm')
    });
    m.add(30, 'minutes');
  }
  return out;
}();
var getDisplayOption = function getDisplayOption(op) {
  return op.name;
};
var getOptionValue = function getOptionValue(op) {
  return op.id;
};

/**
 * A component to render TimePicker as the header for the dropdown component.
 */
var EffectTimeListItem = function EffectTimeListItem(_ref) {
  var value = _ref.value;
  if ((value === null || value === void 0 ? void 0 : value.id) === HEADER_ITEM_ID) {
    return /*#__PURE__*/_react["default"].createElement(_styledComponents2.StyledTimePicker, {
      value: value.value,
      onChange: value.onChange,
      onClick: value.onClick,
      disableClock: true,
      format: 'hh:mm a'
    });
  }
  return /*#__PURE__*/_react["default"].createElement(StyledLabel, null, value.name);
};
var EffectTimeDropdownList = function EffectTimeDropdownList(_ref2) {
  var onOptionSelected = _ref2.onOptionSelected,
    options = _ref2.options,
    selectionIndex = _ref2.selectionIndex,
    customListItemComponent = _ref2.customListItemComponent;
  var onSelectOption = (0, _react.useCallback)(function (e, value) {
    e.preventDefault();
    onOptionSelected(value);
  }, [onOptionSelected]);
  var ListItemComponent = customListItemComponent;
  return /*#__PURE__*/_react["default"].createElement(DropdownListWrapper, {
    className: _dropdownList.classList.list
  }, options.map(function (value, i) {
    return /*#__PURE__*/_react["default"].createElement(StyledDropdownListItem, {
      className: (0, _classnames["default"])('effect-type-selector__item', {
        hover: selectionIndex === i
      }),
      key: "".concat(value.id, "_").concat(i),
      onMouseDown: function onMouseDown(e) {
        return onSelectOption(e, value);
      },
      onClick: function onClick(e) {
        return onSelectOption(e, value);
      }
    }, /*#__PURE__*/_react["default"].createElement(ListItemComponent, {
      value: value
    }));
  }));
};
EffectTimeSelectorFactory.deps = [];
function EffectTimeSelectorFactory() {
  var EffectTimeSelector = function EffectTimeSelector(_ref3) {
    var value = _ref3.value,
      onChange = _ref3.onChange;
    // Selected item is rendered as TimePicker in EffectTimeListItem
    var selectedItems = (0, _react.useMemo)(function () {
      return [{
        id: HEADER_ITEM_ID,
        value: value,
        onChange: onChange,
        onClick: function onClick(e) {
          var _e$target;
          // DatePicker is used as custom header.
          // Don't open the dropdown when the user is editing time values directly.
          var name = e === null || e === void 0 || (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.name;
          if (name === 'hour12' || name === 'minute' || name === 'amPm') {
            e.stopPropagation();
          }
        }
      }];
    }, [value, onChange]);
    return /*#__PURE__*/_react["default"].createElement(StyledEffectTimeSelector, null, /*#__PURE__*/_react["default"].createElement(_itemSelector["default"], {
      selectedItems: selectedItems,
      options: timeOptions,
      multiSelect: false,
      searchable: false,
      placeholder: "",
      filterOption: "name",
      onChange: onChange,
      getOptionValue: getOptionValue,
      displayOption: getDisplayOption,
      DropDownLineItemRenderComponent: EffectTimeListItem,
      DropDownRenderComponent: EffectTimeDropdownList
    }));
  };
  return (0, _styledComponents.withTheme)(EffectTimeSelector);
}
var _default = exports["default"] = EffectTimeSelectorFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfc3R5bGVkQ29tcG9uZW50cyIsIl9jbGFzc25hbWVzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9tb21lbnRUaW1lem9uZSIsIl9pdGVtU2VsZWN0b3IiLCJfc3R5bGVkQ29tcG9uZW50czIiLCJfZHJvcGRvd25MaXN0IiwiX3RlbXBsYXRlT2JqZWN0IiwiX3RlbXBsYXRlT2JqZWN0MiIsIl90ZW1wbGF0ZU9iamVjdDMiLCJfdGVtcGxhdGVPYmplY3Q0IiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJfdHlwZW9mIiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiSEVBREVSX0lURU1fSUQiLCJTdHlsZWRFZmZlY3RUaW1lU2VsZWN0b3IiLCJkaXYiLCJfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsMiIsInByb3BzIiwidGhlbWUiLCJpbnB1dEJnZCIsImlucHV0QmdkSG92ZXIiLCJhY3RpdmVDb2xvciIsIlN0eWxlZExhYmVsIiwiZWZmZWN0UGFuZWxUZXh0TWFpbiIsImlucHV0Rm9udFNpemUiLCJEcm9wZG93bkxpc3RXcmFwcGVyIiwiZHJvcGRvd25MaXN0IiwiU3R5bGVkRHJvcGRvd25MaXN0SXRlbSIsImVmZmVjdFBhbmVsRWxlbWVudENvbG9yU2VsZWN0ZWQiLCJ0aW1lT3B0aW9ucyIsIm0iLCJ1dGNPZmZzZXQiLCJob3VyIiwibWludXRlIiwic2Vjb25kIiwibWlsbGlzZWNvbmQiLCJvdXQiLCJwdXNoIiwibmFtZSIsImZvcm1hdCIsImlkIiwiYWRkIiwiZ2V0RGlzcGxheU9wdGlvbiIsIm9wIiwiZ2V0T3B0aW9uVmFsdWUiLCJFZmZlY3RUaW1lTGlzdEl0ZW0iLCJfcmVmIiwidmFsdWUiLCJjcmVhdGVFbGVtZW50IiwiU3R5bGVkVGltZVBpY2tlciIsIm9uQ2hhbmdlIiwib25DbGljayIsImRpc2FibGVDbG9jayIsIkVmZmVjdFRpbWVEcm9wZG93bkxpc3QiLCJfcmVmMiIsIm9uT3B0aW9uU2VsZWN0ZWQiLCJvcHRpb25zIiwic2VsZWN0aW9uSW5kZXgiLCJjdXN0b21MaXN0SXRlbUNvbXBvbmVudCIsIm9uU2VsZWN0T3B0aW9uIiwidXNlQ2FsbGJhY2siLCJwcmV2ZW50RGVmYXVsdCIsIkxpc3RJdGVtQ29tcG9uZW50IiwiY2xhc3NOYW1lIiwiY2xhc3NMaXN0IiwibGlzdCIsIm1hcCIsImhvdmVyIiwia2V5IiwiY29uY2F0Iiwib25Nb3VzZURvd24iLCJFZmZlY3RUaW1lU2VsZWN0b3JGYWN0b3J5IiwiZGVwcyIsIkVmZmVjdFRpbWVTZWxlY3RvciIsIl9yZWYzIiwic2VsZWN0ZWRJdGVtcyIsInVzZU1lbW8iLCJfZSR0YXJnZXQiLCJ0YXJnZXQiLCJzdG9wUHJvcGFnYXRpb24iLCJtdWx0aVNlbGVjdCIsInNlYXJjaGFibGUiLCJwbGFjZWhvbGRlciIsImZpbHRlck9wdGlvbiIsImRpc3BsYXlPcHRpb24iLCJEcm9wRG93bkxpbmVJdGVtUmVuZGVyQ29tcG9uZW50IiwiRHJvcERvd25SZW5kZXJDb21wb25lbnQiLCJ3aXRoVGhlbWUiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvZWZmZWN0cy9lZmZlY3QtdGltZS1zZWxlY3Rvci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IFJlYWN0LCB7dXNlTWVtbywgdXNlQ2FsbGJhY2t9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQsIHt3aXRoVGhlbWV9IGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQtdGltZXpvbmUnO1xuXG5pbXBvcnQgSXRlbVNlbGVjdG9yIGZyb20gJy4uL2NvbW1vbi9pdGVtLXNlbGVjdG9yL2l0ZW0tc2VsZWN0b3InO1xuaW1wb3J0IHtTdHlsZWRUaW1lUGlja2VyfSBmcm9tICcuLi9jb21tb24vc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IHtjbGFzc0xpc3R9IGZyb20gJy4uL2NvbW1vbi9pdGVtLXNlbGVjdG9yL2Ryb3Bkb3duLWxpc3QnO1xuXG5jb25zdCBIRUFERVJfSVRFTV9JRCA9ICdIRUFERVJfSVRFTV9JRCc7XG5cbmV4cG9ydCB0eXBlIEVmZmVjdFRpbWVTZWxlY3RvclByb3BzID0ge1xuICB2YWx1ZTogc3RyaW5nO1xuICBvbkNoYW5nZTogKHN0cmluZykgPT4gdm9pZDtcbiAgdGhlbWU/OiBhbnk7XG59O1xuXG5jb25zdCBTdHlsZWRFZmZlY3RUaW1lU2VsZWN0b3IgPSBzdHlsZWQuZGl2YFxuICAuaXRlbS1zZWxlY3RvciB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gIH1cbiAgLml0ZW0tc2VsZWN0b3IgLml0ZW0tc2VsZWN0b3JfX2Ryb3Bkb3duIHtcbiAgICBwYWRkaW5nOiAwcHg7XG4gICAgd2lkdGg6IDExMHB4O1xuICAgIGhlaWdodDogMzBweDtcbiAgfVxuICBib3JkZXI6IDFweCBzb2xpZCAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0QmdkfTtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAmOmhvdmVyIHtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0QmdkSG92ZXJ9O1xuICB9XG4gIC5hY3RpdmUge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuYWN0aXZlQ29sb3J9O1xuICAgIGJvcmRlci1yYWRpdXM6IDRweCA0cHggMHB4IDBweDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkTGFiZWwgPSBzdHlsZWQuZGl2YFxuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5lZmZlY3RQYW5lbFRleHRNYWlufTtcbiAgZm9udC1zaXplOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0Rm9udFNpemV9O1xuICBoZWlnaHQ6IDEzcHg7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5gO1xuXG5jb25zdCBEcm9wZG93bkxpc3RXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5kcm9wZG93bkxpc3R9O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0QmdkSG92ZXJ9O1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LXdyYXA6IHdyYXA7XG4gIHBhZGRpbmc6IDBweDtcbiAgbWF4LWhlaWdodDogMTYwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDBweCAwcHggNHB4IDRweDtcbmA7XG5cbmNvbnN0IFN0eWxlZERyb3Bkb3duTGlzdEl0ZW0gPSBzdHlsZWQuZGl2YFxuICBwYWRkaW5nOiAxMHB4IDVweCA5cHggMTBweDtcbiAgd2lkdGg6IDEwMCU7XG4gICY6aG92ZXIge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuZWZmZWN0UGFuZWxFbGVtZW50Q29sb3JTZWxlY3RlZH07XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICB9XG5gO1xuXG4vLyBHZW5lcmF0ZSB0aW1lIG9wdGlvbnMgZm9yIHRoZSBkcm9wZG93biB3aXRoIDMwIG1pbiBpbnRlcnZhbHMuXG5jb25zdCB0aW1lT3B0aW9ucyA9ICgoKSA9PiB7XG4gIGNvbnN0IG0gPSBtb21lbnQoKS51dGNPZmZzZXQoMCk7XG4gIG0uc2V0KHtob3VyOiAxMiwgbWludXRlOiAwLCBzZWNvbmQ6IDAsIG1pbGxpc2Vjb25kOiAwfSk7XG5cbiAgY29uc3Qgb3V0OiB7bmFtZTogc3RyaW5nOyBpZDogc3RyaW5nfVtdID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgNDg7IGkrKykge1xuICAgIG91dC5wdXNoKHtuYW1lOiBtLmZvcm1hdCgnaGg6bW0gQScpLCBpZDogbS5mb3JtYXQoJ0hIOm1tJyl9KTtcbiAgICBtLmFkZCgzMCwgJ21pbnV0ZXMnKTtcbiAgfVxuICByZXR1cm4gb3V0O1xufSkoKTtcblxuY29uc3QgZ2V0RGlzcGxheU9wdGlvbiA9IG9wID0+IG9wLm5hbWU7XG5jb25zdCBnZXRPcHRpb25WYWx1ZSA9IG9wID0+IG9wLmlkO1xuXG4vKipcbiAqIEEgY29tcG9uZW50IHRvIHJlbmRlciBUaW1lUGlja2VyIGFzIHRoZSBoZWFkZXIgZm9yIHRoZSBkcm9wZG93biBjb21wb25lbnQuXG4gKi9cbmNvbnN0IEVmZmVjdFRpbWVMaXN0SXRlbSA9ICh7dmFsdWV9KSA9PiB7XG4gIGlmICh2YWx1ZT8uaWQgPT09IEhFQURFUl9JVEVNX0lEKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxTdHlsZWRUaW1lUGlja2VyXG4gICAgICAgIHZhbHVlPXt2YWx1ZS52YWx1ZX1cbiAgICAgICAgb25DaGFuZ2U9e3ZhbHVlLm9uQ2hhbmdlfVxuICAgICAgICBvbkNsaWNrPXt2YWx1ZS5vbkNsaWNrfVxuICAgICAgICBkaXNhYmxlQ2xvY2s9e3RydWV9XG4gICAgICAgIGZvcm1hdD17J2hoOm1tIGEnfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIDxTdHlsZWRMYWJlbD57dmFsdWUubmFtZX08L1N0eWxlZExhYmVsPjtcbn07XG5cbmNvbnN0IEVmZmVjdFRpbWVEcm9wZG93bkxpc3QgPSAoe1xuICBvbk9wdGlvblNlbGVjdGVkLFxuICBvcHRpb25zLFxuICBzZWxlY3Rpb25JbmRleCxcbiAgY3VzdG9tTGlzdEl0ZW1Db21wb25lbnRcbn0pID0+IHtcbiAgY29uc3Qgb25TZWxlY3RPcHRpb24gPSB1c2VDYWxsYmFjayhcbiAgICAoZSwgdmFsdWUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIG9uT3B0aW9uU2VsZWN0ZWQodmFsdWUpO1xuICAgIH0sXG4gICAgW29uT3B0aW9uU2VsZWN0ZWRdXG4gICk7XG5cbiAgY29uc3QgTGlzdEl0ZW1Db21wb25lbnQgPSBjdXN0b21MaXN0SXRlbUNvbXBvbmVudDtcblxuICByZXR1cm4gKFxuICAgIDxEcm9wZG93bkxpc3RXcmFwcGVyIGNsYXNzTmFtZT17Y2xhc3NMaXN0Lmxpc3R9PlxuICAgICAge29wdGlvbnMubWFwKCh2YWx1ZSwgaSkgPT4gKFxuICAgICAgICA8U3R5bGVkRHJvcGRvd25MaXN0SXRlbVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcygnZWZmZWN0LXR5cGUtc2VsZWN0b3JfX2l0ZW0nLCB7XG4gICAgICAgICAgICBob3Zlcjogc2VsZWN0aW9uSW5kZXggPT09IGlcbiAgICAgICAgICB9KX1cbiAgICAgICAgICBrZXk9e2Ake3ZhbHVlLmlkfV8ke2l9YH1cbiAgICAgICAgICBvbk1vdXNlRG93bj17ZSA9PiBvblNlbGVjdE9wdGlvbihlLCB2YWx1ZSl9XG4gICAgICAgICAgb25DbGljaz17ZSA9PiBvblNlbGVjdE9wdGlvbihlLCB2YWx1ZSl9XG4gICAgICAgID5cbiAgICAgICAgICA8TGlzdEl0ZW1Db21wb25lbnQgdmFsdWU9e3ZhbHVlfSAvPlxuICAgICAgICA8L1N0eWxlZERyb3Bkb3duTGlzdEl0ZW0+XG4gICAgICApKX1cbiAgICA8L0Ryb3Bkb3duTGlzdFdyYXBwZXI+XG4gICk7XG59O1xuXG5FZmZlY3RUaW1lU2VsZWN0b3JGYWN0b3J5LmRlcHMgPSBbXTtcblxuZnVuY3Rpb24gRWZmZWN0VGltZVNlbGVjdG9yRmFjdG9yeSgpIHtcbiAgY29uc3QgRWZmZWN0VGltZVNlbGVjdG9yOiBSZWFjdC5GQzxFZmZlY3RUaW1lU2VsZWN0b3JQcm9wcz4gPSAoe1xuICAgIHZhbHVlLFxuICAgIG9uQ2hhbmdlXG4gIH06IEVmZmVjdFRpbWVTZWxlY3RvclByb3BzKSA9PiB7XG4gICAgLy8gU2VsZWN0ZWQgaXRlbSBpcyByZW5kZXJlZCBhcyBUaW1lUGlja2VyIGluIEVmZmVjdFRpbWVMaXN0SXRlbVxuICAgIGNvbnN0IHNlbGVjdGVkSXRlbXMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogSEVBREVSX0lURU1fSUQsXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgb25DaGFuZ2UsXG4gICAgICAgICAgb25DbGljazogZSA9PiB7XG4gICAgICAgICAgICAvLyBEYXRlUGlja2VyIGlzIHVzZWQgYXMgY3VzdG9tIGhlYWRlci5cbiAgICAgICAgICAgIC8vIERvbid0IG9wZW4gdGhlIGRyb3Bkb3duIHdoZW4gdGhlIHVzZXIgaXMgZWRpdGluZyB0aW1lIHZhbHVlcyBkaXJlY3RseS5cbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBlPy50YXJnZXQ/Lm5hbWU7XG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2hvdXIxMicgfHwgbmFtZSA9PT0gJ21pbnV0ZScgfHwgbmFtZSA9PT0gJ2FtUG0nKSB7XG4gICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdO1xuICAgIH0sIFt2YWx1ZSwgb25DaGFuZ2VdKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3R5bGVkRWZmZWN0VGltZVNlbGVjdG9yPlxuICAgICAgICA8SXRlbVNlbGVjdG9yXG4gICAgICAgICAgc2VsZWN0ZWRJdGVtcz17c2VsZWN0ZWRJdGVtc31cbiAgICAgICAgICBvcHRpb25zPXt0aW1lT3B0aW9uc31cbiAgICAgICAgICBtdWx0aVNlbGVjdD17ZmFsc2V9XG4gICAgICAgICAgc2VhcmNoYWJsZT17ZmFsc2V9XG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJcIlxuICAgICAgICAgIGZpbHRlck9wdGlvbj1cIm5hbWVcIlxuICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgICBnZXRPcHRpb25WYWx1ZT17Z2V0T3B0aW9uVmFsdWV9XG4gICAgICAgICAgZGlzcGxheU9wdGlvbj17Z2V0RGlzcGxheU9wdGlvbn1cbiAgICAgICAgICBEcm9wRG93bkxpbmVJdGVtUmVuZGVyQ29tcG9uZW50PXtFZmZlY3RUaW1lTGlzdEl0ZW19XG4gICAgICAgICAgRHJvcERvd25SZW5kZXJDb21wb25lbnQ9e0VmZmVjdFRpbWVEcm9wZG93bkxpc3R9XG4gICAgICAgIC8+XG4gICAgICA8L1N0eWxlZEVmZmVjdFRpbWVTZWxlY3Rvcj5cbiAgICApO1xuICB9O1xuXG4gIHJldHVybiB3aXRoVGhlbWUoRWZmZWN0VGltZVNlbGVjdG9yKSBhcyBSZWFjdC5GQzxPbWl0PEVmZmVjdFRpbWVTZWxlY3RvclByb3BzLCAndGhlbWUnPj47XG59XG5cbmV4cG9ydCBkZWZhdWx0IEVmZmVjdFRpbWVTZWxlY3RvckZhY3Rvcnk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUdBLElBQUFBLE1BQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGlCQUFBLEdBQUFGLHVCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxXQUFBLEdBQUFDLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBSSxlQUFBLEdBQUFELHNCQUFBLENBQUFILE9BQUE7QUFFQSxJQUFBSyxhQUFBLEdBQUFGLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBTSxrQkFBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sYUFBQSxHQUFBUCxPQUFBO0FBQWdFLElBQUFRLGVBQUEsRUFBQUMsZ0JBQUEsRUFBQUMsZ0JBQUEsRUFBQUMsZ0JBQUEsRUFWaEU7QUFDQTtBQUFBLFNBQUFDLHlCQUFBQyxDQUFBO0VBQUEseUJBQUFDLE9BQUE7RUFBQSxJQUFBQyxDQUFBLE9BQUFELE9BQUE7SUFBQUUsQ0FBQSxPQUFBRixPQUFBO0VBQUEs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