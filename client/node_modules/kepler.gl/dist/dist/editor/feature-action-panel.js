"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.PureFeatureActionPanelFactory = PureFeatureActionPanelFactory;
exports["default"] = FeatureActionPanelFactory;
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react"));
var _reactIntl = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react-intl");
var _copyToClipboard = _interopRequireDefault(require("copy-to-clipboard"));
var _react2 = require("@floating-ui/react");
var _classnames = _interopRequireDefault(require("classnames"));
var _styledComponents = _interopRequireDefault(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/styled-components"));
var _utils = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/utils/src");
var _actionPanel = _interopRequireWildcard(require("../common/action-panel"));
var _icons = require("../common/icons");
var _templateObject; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap(),
    t = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {
    return e ? t : r;
  })(e);
}
function _interopRequireWildcard(e, r) {
  if (!r && e && e.__esModule) return e;
  if (null === e || "object" != _typeof(e) && "function" != typeof e) return {
    "default": e
  };
  var t = _getRequireWildcardCache(r);
  if (t && t.has(e)) return t.get(e);
  var n = {
      __proto__: null
    },
    a = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) {
    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
  }
  return n["default"] = e, t && t.set(e, n), n;
}
var LAYOVER_OFFSET = 4;
var StyledActionsLayer = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  position: absolute;\n  .layer-panel-item-disabled {\n    color: ", ";\n  }\n"])), function (props) {
  return props.theme.textColor;
});
var defaultActionIcons = {
  remove: _icons.Trash,
  layer: _icons.Layers,
  copy: _icons.Copy,
  copied: _icons.Checkmark
};
PureFeatureActionPanelFactory.deps = [];
function PureFeatureActionPanelFactory() {
  var FeatureActionPanel = function FeatureActionPanel(_ref) {
    var className = _ref.className,
      datasets = _ref.datasets,
      selectedFeature = _ref.selectedFeature,
      _ref$position = _ref.position,
      position = _ref$position === void 0 ? null : _ref$position,
      layers = _ref.layers,
      currentFilter = _ref.currentFilter,
      onToggleLayer = _ref.onToggleLayer,
      onDeleteFeature = _ref.onDeleteFeature,
      _ref$actionIcons = _ref.actionIcons,
      actionIcons = _ref$actionIcons === void 0 ? defaultActionIcons : _ref$actionIcons,
      children = _ref.children,
      onClose = _ref.onClose;
    var _useState = (0, _react.useState)(false),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      copied = _useState2[0],
      setCopied = _useState2[1];
    var _ref2 = currentFilter || {},
      _ref2$layerId = _ref2.layerId,
      layerId = _ref2$layerId === void 0 ? [] : _ref2$layerId;
    var intl = (0, _reactIntl.useIntl)();
    var _useFloating = (0, _react2.useFloating)({
        open: true,
        onOpenChange: function onOpenChange(v) {
          if (!v && onClose) {
            onClose();
          }
        }
      }),
      refs = _useFloating.refs,
      context = _useFloating.context;
    var dismiss = (0, _react2.useDismiss)(context);
    var _useInteractions = (0, _react2.useInteractions)([dismiss]),
      getFloatingProps = _useInteractions.getFloatingProps;
    var copyGeometry = (0, _react.useCallback)(function () {
      if (selectedFeature !== null && selectedFeature !== void 0 && selectedFeature.geometry) (0, _copyToClipboard["default"])(JSON.stringify(selectedFeature.geometry));
      setCopied(true);
    }, [selectedFeature === null || selectedFeature === void 0 ? void 0 : selectedFeature.geometry]);
    if (!position) {
      return null;
    }
    var isFilterLayerDisabled = !(0, _utils.canApplyFeatureFilter)(selectedFeature);
    return /*#__PURE__*/_react["default"].createElement(StyledActionsLayer, (0, _extends2["default"])({
      ref: refs.setFloating
    }, getFloatingProps(), {
      className: (0, _classnames["default"])('feature-action-panel', className),
      style: {
        top: "".concat(position.y + LAYOVER_OFFSET, "px"),
        left: "".concat(position.x + LAYOVER_OFFSET, "px")
      }
    }), /*#__PURE__*/_react["default"].createElement(_actionPanel["default"], null, /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      className: "editor-layers-list",
      label: intl.formatMessage({
        id: 'editor.filterLayer',
        defaultMessage: 'Filter layers'
      }),
      Icon: actionIcons.layer,
      isDisabled: isFilterLayerDisabled,
      tooltipText: isFilterLayerDisabled ? intl.formatMessage({
        id: 'editor.filterLayerDisabled'
      }) : null
    }, layers.length ? layers.map(function (layer, index) {
      return /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
        key: index,
        label: layer.config.label
        // @ts-ignore
        ,

        color: datasets[layer.config.dataId].color,
        isSelection: true,
        isActive: layerId.includes(layer.id),
        onClick: function onClick() {
          return onToggleLayer(layer);
        },
        className: "layer-panel-item"
      });
    }) : /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      key: 'no-layers',
      label: intl.formatMessage({
        id: 'editor.noLayersToFilter',
        defaultMessage: 'No layers to filter'
      }),
      isSelection: false,
      isActive: false,
      className: "layer-panel-item-disabled"
    })), /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      label: intl.formatMessage({
        id: 'editor.copyGeometry',
        defaultMessage: 'Copy Geometry'
      }),
      className: "delete-panel-item",
      Icon: copied ? actionIcons.copied : actionIcons.copy,
      onClick: copyGeometry
    }), children, /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      label: intl.formatMessage({
        id: 'tooltip.delete',
        defaultMessage: 'Delete'
      }),
      className: "delete-panel-item",
      Icon: actionIcons.remove,
      onClick: onDeleteFeature
    })));
  };
  FeatureActionPanel.displayName = 'FeatureActionPanel';
  return FeatureActionPanel;
}
FeatureActionPanelFactory.deps = PureFeatureActionPanelFactory.deps;
function FeatureActionPanelFactory() {
  return PureFeatureActionPanelFactory();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfcmVhY3RJbnRsIiwiX2NvcHlUb0NsaXBib2FyZCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfcmVhY3QyIiwiX2NsYXNzbmFtZXMiLCJfc3R5bGVkQ29tcG9uZW50cyIsIl91dGlscyIsIl9hY3Rpb25QYW5lbCIsIl9pY29ucyIsIl90ZW1wbGF0ZU9iamVjdCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiX3R5cGVvZiIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIkxBWU9WRVJfT0ZGU0VUIiwiU3R5bGVkQWN0aW9uc0xheWVyIiwiZGl2IiwiX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbDIiLCJwcm9wcyIsInRoZW1lIiwidGV4dENvbG9yIiwiZGVmYXVsdEFjdGlvbkljb25zIiwicmVtb3ZlIiwiVHJhc2giLCJsYXllciIsIkxheWVycyIsImNvcHkiLCJDb3B5IiwiY29waWVkIiwiQ2hlY2ttYXJrIiwiUHVyZUZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkiLCJkZXBzIiwiRmVhdHVyZUFjdGlvblBhbmVsIiwiX3JlZiIsImNsYXNzTmFtZSIsImRhdGFzZXRzIiwic2VsZWN0ZWRGZWF0dXJlIiwiX3JlZiRwb3NpdGlvbiIsInBvc2l0aW9uIiwibGF5ZXJzIiwiY3VycmVudEZpbHRlciIsIm9uVG9nZ2xlTGF5ZXIiLCJvbkRlbGV0ZUZlYXR1cmUiLCJfcmVmJGFjdGlvbkljb25zIiwiYWN0aW9uSWNvbnMiLCJjaGlsZHJlbiIsIm9uQ2xvc2UiLCJfdXNlU3RhdGUiLCJ1c2VTdGF0ZSIsIl91c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJzZXRDb3BpZWQiLCJfcmVmMiIsIl9yZWYyJGxheWVySWQiLCJsYXllcklkIiwiaW50bCIsInVzZUludGwiLCJfdXNlRmxvYXRpbmciLCJ1c2VGbG9hdGluZyIsIm9wZW4iLCJvbk9wZW5DaGFuZ2UiLCJ2IiwicmVmcyIsImNvbnRleHQiLCJkaXNtaXNzIiwidXNlRGlzbWlzcyIsIl91c2VJbnRlcmFjdGlvbnMiLCJ1c2VJbnRlcmFjdGlvbnMiLCJnZXRGbG9hdGluZ1Byb3BzIiwiY29weUdlb21ldHJ5IiwidXNlQ2FsbGJhY2siLCJnZW9tZXRyeSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpc0ZpbHRlckxheWVyRGlzYWJsZWQiLCJjYW5BcHBseUZlYXR1cmVGaWx0ZXIiLCJjcmVhdGVFbGVtZW50IiwiX2V4dGVuZHMyIiwicmVmIiwic2V0RmxvYXRpbmciLCJzdHlsZSIsInRvcCIsImNvbmNhdCIsInkiLCJsZWZ0IiwieCIsIkFjdGlvblBhbmVsSXRlbSIsImxhYmVsIiwiZm9ybWF0TWVzc2FnZSIsImlkIiwiZGVmYXVsdE1lc3NhZ2UiLCJJY29uIiwiaXNEaXNhYmxlZCIsInRvb2x0aXBUZXh0IiwibGVuZ3RoIiwibWFwIiwiaW5kZXgiLCJrZXkiLCJjb25maWciLCJjb2xvciIsImRhdGFJZCIsImlzU2VsZWN0aW9uIiwiaXNBY3RpdmUiLCJpbmNsdWRlcyIsIm9uQ2xpY2siLCJkaXNwbGF5TmFtZSIsIkZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvZWRpdG9yL2ZlYXR1cmUtYWN0aW9uLXBhbmVsLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgUmVhY3QsIHt1c2VDYWxsYmFjaywgdXNlU3RhdGUsIENvbXBvbmVudFR5cGV9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7dXNlSW50bH0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQgY29weSBmcm9tICdjb3B5LXRvLWNsaXBib2FyZCc7XG5pbXBvcnQge3VzZURpc21pc3MsIHVzZUZsb2F0aW5nLCB1c2VJbnRlcmFjdGlvbnN9IGZyb20gJ0BmbG9hdGluZy11aS9yZWFjdCc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBzdHlsZWQgZnJvbSAnc3R5bGVkLWNvbXBvbmVudHMnO1xuXG5pbXBvcnQge0xheWVyfSBmcm9tICdAa2VwbGVyLmdsL2xheWVycyc7XG5pbXBvcnQge0ZpbHRlcn0gZnJvbSAnQGtlcGxlci5nbC90eXBlcyc7XG5pbXBvcnQge0ZlYXR1cmV9IGZyb20gJ0BuZWJ1bGEuZ2wvZWRpdC1tb2Rlcyc7XG5pbXBvcnQge0RhdGFzZXRzfSBmcm9tICdAa2VwbGVyLmdsL3RhYmxlJztcbmltcG9ydCB7Y2FuQXBwbHlGZWF0dXJlRmlsdGVyfSBmcm9tICdAa2VwbGVyLmdsL3V0aWxzJztcblxuaW1wb3J0IEFjdGlvblBhbmVsLCB7QWN0aW9uUGFuZWxJdGVtfSBmcm9tICcuLi9jb21tb24vYWN0aW9uLXBhbmVsJztcbmltcG9ydCB7VHJhc2gsIExheWVycywgQ29weSwgQ2hlY2ttYXJrfSBmcm9tICcuLi9jb21tb24vaWNvbnMnO1xuXG5jb25zdCBMQVlPVkVSX09GRlNFVCA9IDQ7XG5cbmNvbnN0IFN0eWxlZEFjdGlvbnNMYXllciA9IHN0eWxlZC5kaXZgXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgLmxheWVyLXBhbmVsLWl0ZW0tZGlzYWJsZWQge1xuICAgIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnRleHRDb2xvcn07XG4gIH1cbmA7XG5jb25zdCBkZWZhdWx0QWN0aW9uSWNvbnMgPSB7XG4gIHJlbW92ZTogVHJhc2gsXG4gIGxheWVyOiBMYXllcnMsXG4gIGNvcHk6IENvcHksXG4gIGNvcGllZDogQ2hlY2ttYXJrXG59O1xuUHVyZUZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkuZGVwcyA9IFtdO1xuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVBY3Rpb25QYW5lbFByb3BzIHtcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICBkYXRhc2V0czogRGF0YXNldHM7XG4gIHNlbGVjdGVkRmVhdHVyZTogRmVhdHVyZSB8IG51bGw7XG4gIHBvc2l0aW9uOiB7XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbiAgfSB8IG51bGw7XG4gIGxheWVyczogTGF5ZXJbXTtcbiAgY3VycmVudEZpbHRlcj86IEZpbHRlcjtcbiAgb25Ub2dnbGVMYXllcjogKGxheWVyOiBMYXllcikgPT4gdm9pZDtcbiAgb25EZWxldGVGZWF0dXJlOiAoKSA9PiB2b2lkO1xuICBvbkNsb3NlPzogKCkgPT4gdm9pZDtcbiAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG4gIGFjdGlvbkljb25zPzoge1xuICAgIFtpZDogc3RyaW5nXTogUmVhY3QuRWxlbWVudFR5cGU7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQdXJlRmVhdHVyZUFjdGlvblBhbmVsRmFjdG9yeSgpOiBSZWFjdC5GQzxGZWF0dXJlQWN0aW9uUGFuZWxQcm9wcz4ge1xuICBjb25zdCBGZWF0dXJlQWN0aW9uUGFuZWwgPSAoe1xuICAgIGNsYXNzTmFtZSxcbiAgICBkYXRhc2V0cyxcbiAgICBzZWxlY3RlZEZlYXR1cmUsXG4gICAgcG9zaXRpb24gPSBudWxsLFxuICAgIGxheWVycyxcbiAgICBjdXJyZW50RmlsdGVyLFxuICAgIG9uVG9nZ2xlTGF5ZXIsXG4gICAgb25EZWxldGVGZWF0dXJlLFxuICAgIGFjdGlvbkljb25zID0gZGVmYXVsdEFjdGlvbkljb25zLFxuICAgIGNoaWxkcmVuLFxuICAgIG9uQ2xvc2VcbiAgfTogRmVhdHVyZUFjdGlvblBhbmVsUHJvcHMpID0+IHtcbiAgICBjb25zdCBbY29waWVkLCBzZXRDb3BpZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IHtsYXllcklkID0gW119ID0gY3VycmVudEZpbHRlciB8fCB7fTtcbiAgICBjb25zdCBpbnRsID0gdXNlSW50bCgpO1xuXG4gICAgY29uc3Qge3JlZnMsIGNvbnRleHR9ID0gdXNlRmxvYXRpbmcoe1xuICAgICAgb3BlbjogdHJ1ZSxcbiAgICAgIG9uT3BlbkNoYW5nZTogdiA9PiB7XG4gICAgICAgIGlmICghdiAmJiBvbkNsb3NlKSB7XG4gICAgICAgICAgb25DbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgZGlzbWlzcyA9IHVzZURpc21pc3MoY29udGV4dCk7XG5cbiAgICBjb25zdCB7Z2V0RmxvYXRpbmdQcm9wc30gPSB1c2VJbnRlcmFjdGlvbnMoW2Rpc21pc3NdKTtcblxuICAgIGNvbnN0IGNvcHlHZW9tZXRyeSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZEZlYXR1cmU/Lmdlb21ldHJ5KSBjb3B5KEpTT04uc3RyaW5naWZ5KHNlbGVjdGVkRmVhdHVyZS5nZW9tZXRyeSkpO1xuICAgICAgc2V0Q29waWVkKHRydWUpO1xuICAgIH0sIFtzZWxlY3RlZEZlYXR1cmU/Lmdlb21ldHJ5XSk7XG5cbiAgICBpZiAoIXBvc2l0aW9uKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBpc0ZpbHRlckxheWVyRGlzYWJsZWQgPSAhY2FuQXBwbHlGZWF0dXJlRmlsdGVyKHNlbGVjdGVkRmVhdHVyZSBhcyBhbnkpO1xuICAgIHJldHVybiAoXG4gICAgICA8U3R5bGVkQWN0aW9uc0xheWVyXG4gICAgICAgIHJlZj17cmVmcy5zZXRGbG9hdGluZ31cbiAgICAgICAgey4uLmdldEZsb2F0aW5nUHJvcHMoKX1cbiAgICAgICAgY2xhc3NOYW1lPXtjbGFzc25hbWVzKCdmZWF0dXJlLWFjdGlvbi1wYW5lbCcsIGNsYXNzTmFtZSl9XG4gICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgdG9wOiBgJHtwb3NpdGlvbi55ICsgTEFZT1ZFUl9PRkZTRVR9cHhgLFxuICAgICAgICAgIGxlZnQ6IGAke3Bvc2l0aW9uLnggKyBMQVlPVkVSX09GRlNFVH1weGBcbiAgICAgICAgfX1cbiAgICAgID5cbiAgICAgICAgPEFjdGlvblBhbmVsPlxuICAgICAgICAgIDxBY3Rpb25QYW5lbEl0ZW1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImVkaXRvci1sYXllcnMtbGlzdFwiXG4gICAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ2VkaXRvci5maWx0ZXJMYXllcicsIGRlZmF1bHRNZXNzYWdlOiAnRmlsdGVyIGxheWVycyd9KX1cbiAgICAgICAgICAgIEljb249e2FjdGlvbkljb25zLmxheWVyfVxuICAgICAgICAgICAgaXNEaXNhYmxlZD17aXNGaWx0ZXJMYXllckRpc2FibGVkfVxuICAgICAgICAgICAgdG9vbHRpcFRleHQ9e1xuICAgICAgICAgICAgICBpc0ZpbHRlckxheWVyRGlzYWJsZWQgPyBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAnZWRpdG9yLmZpbHRlckxheWVyRGlzYWJsZWQnfSkgOiBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge2xheWVycy5sZW5ndGggPyAoXG4gICAgICAgICAgICAgIGxheWVycy5tYXAoKGxheWVyLCBpbmRleCkgPT4gKFxuICAgICAgICAgICAgICAgIDxBY3Rpb25QYW5lbEl0ZW1cbiAgICAgICAgICAgICAgICAgIGtleT17aW5kZXh9XG4gICAgICAgICAgICAgICAgICBsYWJlbD17bGF5ZXIuY29uZmlnLmxhYmVsfVxuICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgY29sb3I9e2RhdGFzZXRzW2xheWVyLmNvbmZpZy5kYXRhSWRdLmNvbG9yfVxuICAgICAgICAgICAgICAgICAgaXNTZWxlY3Rpb249e3RydWV9XG4gICAgICAgICAgICAgICAgICBpc0FjdGl2ZT17bGF5ZXJJZC5pbmNsdWRlcyhsYXllci5pZCl9XG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBvblRvZ2dsZUxheWVyKGxheWVyKX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImxheWVyLXBhbmVsLWl0ZW1cIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICkpXG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8QWN0aW9uUGFuZWxJdGVtXG4gICAgICAgICAgICAgICAga2V5PXsnbm8tbGF5ZXJzJ31cbiAgICAgICAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICAgIGlkOiAnZWRpdG9yLm5vTGF5ZXJzVG9GaWx0ZXInLFxuICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdObyBsYXllcnMgdG8gZmlsdGVyJ1xuICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgIGlzU2VsZWN0aW9uPXtmYWxzZX1cbiAgICAgICAgICAgICAgICBpc0FjdGl2ZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibGF5ZXItcGFuZWwtaXRlbS1kaXNhYmxlZFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvQWN0aW9uUGFuZWxJdGVtPlxuICAgICAgICAgIDxBY3Rpb25QYW5lbEl0ZW1cbiAgICAgICAgICAgIGxhYmVsPXtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAnZWRpdG9yLmNvcHlHZW9tZXRyeScsIGRlZmF1bHRNZXNzYWdlOiAnQ29weSBHZW9tZXRyeSd9KX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImRlbGV0ZS1wYW5lbC1pdGVtXCJcbiAgICAgICAgICAgIEljb249e2NvcGllZCA/IGFjdGlvbkljb25zLmNvcGllZCA6IGFjdGlvbkljb25zLmNvcHl9XG4gICAgICAgICAgICBvbkNsaWNrPXtjb3B5R2VvbWV0cnl9XG4gICAgICAgICAgLz5cbiAgICAgICAgICB7Y2hpbGRyZW59XG4gICAgICAgICAgPEFjdGlvblBhbmVsSXRlbVxuICAgICAgICAgICAgbGFiZWw9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0b29sdGlwLmRlbGV0ZScsIGRlZmF1bHRNZXNzYWdlOiAnRGVsZXRlJ30pfVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiZGVsZXRlLXBhbmVsLWl0ZW1cIlxuICAgICAgICAgICAgSWNvbj17YWN0aW9uSWNvbnMucmVtb3ZlfVxuICAgICAgICAgICAgb25DbGljaz17b25EZWxldGVGZWF0dXJlfVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvQWN0aW9uUGFuZWw+XG4gICAgICA8L1N0eWxlZEFjdGlvbnNMYXllcj5cbiAgICApO1xuICB9O1xuXG4gIEZlYXR1cmVBY3Rpb25QYW5lbC5kaXNwbGF5TmFtZSA9ICdGZWF0dXJlQWN0aW9uUGFuZWwnO1xuXG4gIHJldHVybiBGZWF0dXJlQWN0aW9uUGFuZWw7XG59XG5cbkZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkuZGVwcyA9IFB1cmVGZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5LmRlcHM7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkoKTogQ29tcG9uZW50VHlwZTxGZWF0dXJlQWN0aW9uUGFuZWxQcm9wcz4ge1xuICByZXR1cm4gUHVyZUZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkoKTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBR0EsSUFBQUEsTUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsZ0JBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLFdBQUEsR0FBQUYsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFNLGlCQUFBLEdBQUFILHNCQUFBLENBQUFILE9BQUE7QUFNQSxJQUFBTyxNQUFBLEdBQUFQLE9B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