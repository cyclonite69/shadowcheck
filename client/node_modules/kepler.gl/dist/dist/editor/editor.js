"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = EditorFactory;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react"));
var _reactDom = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/react-dom");
var _styledComponents = _interopRequireDefault(require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/node_modules/styled-components"));
var _window = _interopRequireDefault(require("global/window"));
var _classnames = _interopRequireDefault(require("classnames"));
var _get = _interopRequireDefault(require("lodash/get"));
var _reselect = require("reselect");
var _featureActionPanel = _interopRequireDefault(require("./feature-action-panel"));
var _constants = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/constants/src");
var _layers = require("/Users/ihordykhta/Desktop/unfolded/kepler.gl/src/layers/src");
var _context = require("../context");
var _templateObject; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap(),
    t = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {
    return e ? t : r;
  })(e);
}
function _interopRequireWildcard(e, r) {
  if (!r && e && e.__esModule) return e;
  if (null === e || "object" != _typeof(e) && "function" != typeof e) return {
    "default": e
  };
  var t = _getRequireWildcardCache(r);
  if (t && t.has(e)) return t.get(e);
  var n = {
      __proto__: null
    },
    a = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) {
    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
  }
  return n["default"] = e, t && t.set(e, n), n;
}
function _callSuper(t, o, e) {
  return o = (0, _getPrototypeOf2["default"])(o), (0, _possibleConstructorReturn2["default"])(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0, _getPrototypeOf2["default"])(t).constructor) : o.apply(t, e));
}
function _isNativeReflectConstruct() {
  try {
    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
  } catch (t) {}
  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {
    return !!t;
  })();
}
var DECKGL_RENDER_LAYER = 'default-deckgl-overlay-wrapper';
var StyledWrapper = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  position: relative;\n"])));
var editorLayerFilter = function editorLayerFilter(layer) {
  return _constants.EDITOR_AVAILABLE_LAYERS.includes(layer.type || '');
};
EditorFactory.deps = [_featureActionPanel["default"]];
function EditorFactory(FeatureActionPanel) {
  var PortalEditor = function PortalEditor(_ref) {
    var visiblePanel = _ref.visiblePanel,
      className = _ref.className,
      style = _ref.style,
      selectedFeature = _ref.selectedFeature,
      datasets = _ref.datasets,
      layers = _ref.layers,
      currentFilter = _ref.currentFilter,
      onClose = _ref.onClose,
      onDeleteFeature = _ref.onDeleteFeature,
      onToggleLayer = _ref.onToggleLayer,
      position = _ref.position;
    return /*#__PURE__*/_react["default"].createElement(_context.RootContext.Consumer, null, function (context) {
      var _context$current;
      return /*#__PURE__*/_react["default"].createElement(_react["default"].Fragment, null, /*#__PURE__*/(0, _reactDom.createPortal)( /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        className: (0, _classnames["default"])('editor', className),
        style: style
      }, visiblePanel ? /*#__PURE__*/_react["default"].createElement(FeatureActionPanel, {
        selectedFeature: selectedFeature,
        datasets: datasets,
        layers: layers,
        currentFilter: currentFilter,
        onClose: onClose,
        onDeleteFeature: onDeleteFeature,
        onToggleLayer: onToggleLayer,
        position: position || null
      }) : null), (_context$current = context === null || context === void 0 ? void 0 : context.current) !== null && _context$current !== void 0 ? _context$current : document.body));
    });
  };
  var EditorUnmemoized = /*#__PURE__*/function (_Component) {
    function EditorUnmemoized() {
      var _this;
      (0, _classCallCheck2["default"])(this, EditorUnmemoized);
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _callSuper(this, EditorUnmemoized, [].concat(args));
      (0, _defineProperty2["default"])(_this, "state", {});
      (0, _defineProperty2["default"])(_this, "layerSelector", function (props) {
        return props.layers;
      });
      (0, _defineProperty2["default"])(_this, "filterSelector", function (props) {
        return props.filters;
      });
      (0, _defineProperty2["default"])(_this, "selectedFeatureIdSelector", function (props) {
        return (0, _get["default"])(props, ['editor', 'selectedFeature', 'id']);
      });
      (0, _defineProperty2["default"])(_this, "editorFeatureSelector", function (props) {
        return (0, _get["default"])(props, ['editor', 'features']);
      });
      (0, _defineProperty2["default"])(_this, "currentFilterSelector", (0, _reselect.createSelector)(_this.filterSelector, _this.selectedFeatureIdSelector, function (filters, selectedFeatureId) {
        return filters.find(function (f) {
          return f.value && f.value.id === selectedFeatureId;
        });
      }));
      (0, _defineProperty2["default"])(_this, "availableLayersSelector", (0, _reselect.createSelector)(_this.layerSelector, function (layers) {
        return layers.filter(editorLayerFilter).filter(function (layer) {
          var _layer$config;
          return ((_layer$config = layer.config) === null || _layer$config === void 0 ? void 0 : _layer$config.isVisible) && layer.id !== _constants.GEOCODER_LAYER_ID;
        });
      }));
      (0, _defineProperty2["default"])(_this, "allFeaturesSelector", (0, _reselect.createSelector)(_this.filterSelector, _this.editorFeatureSelector, function (filters, editorFeatures) {
        return filters.filter(function (f) {
          return f.type === _constants.FILTER_TYPES.polygon;
        }).map(function (f) {
          return f.value;
        }).concat(editorFeatures);
      }));
      (0, _defineProperty2["default"])(_this, "isInFocus", function () {
        var _document$activeEleme;
        return ((_document$activeEleme = document.activeElement) === null || _document$activeEleme === void 0 ? void 0 : _document$activeEleme.id) === DECKGL_RENDER_LAYER;
      });
      (0, _defineProperty2["default"])(_this, "_onKeyPressed", function (event) {
        if (_this.isInFocus()) {
          switch (event.keyCode) {
            case _constants.KeyEvent.DOM_VK_DELETE:
            case _constants.KeyEvent.DOM_VK_BACK_SPACE:
              _this._onDeleteSelectedFeature();
              break;
            case _constants.KeyEvent.DOM_VK_ESCAPE:
              // reset active drawing
              if (_layers.EditorLayerUtils.isDrawingActive(true, _this.props.editor.mode)) {
                _this.props.onSetEditorMode(_constants.EDITOR_MODES.EDIT);
              }
              _this.props.onSelect(null);
              break;
            default:
              break;
          }
        }
      });
      (0, _defineProperty2["default"])(_this, "_onDeleteSelectedFeature", function () {
        var editor = _this.props.editor;
        var selectedFeature = editor.selectedFeature;
        if (selectedFeature) {
          _this.props.onDeleteFeature(selectedFeature);
        }
      });
      (0, _defineProperty2["default"])(_this, "_closeFeatureAction", function () {
        // reset selection context
        var selectedFeature = _this.props.editor.selectedFeature;
        _this.props.onSelect(selectedFeature);
      });
      (0, _defineProperty2["default"])(_this, "_togglePolygonFilter", function (layer) {
        var selectedFeature = _this.props.editor.selectedFeature;
        if (selectedFeature) {
          _this.props.onTogglePolygonFilter(layer, selectedFeature);
        }
      });
      return _this;
    }
    (0, _inherits2["default"])(EditorUnmemoized, _Component);
    return (0, _createClass2["default"])(EditorUnmemoized, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        _window["default"].addEventListener('keydown', this._onKeyPressed);
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        _window["default"].removeEventListener('keydown', this._onKeyPressed);
      }
    }, {
      key: "render",
      value: function render() {
        var _this$props = this.props,
          className = _this$props.className,
          datasets = _this$props.datasets,
          editor = _this$props.editor,
          style = _this$props.style,
          index = _this$props.index;
        var selectedFeature = editor.selectedFeature,
          selectionContext = editor.selectionContext;
        var currentFilter = this.currentFilterSelector(this.props);
        var availableLayers = this.availableLayersSelector(this.props);
        var _ref2 = selectionContext || {},
          rightClick = _ref2.rightClick,
          position = _ref2.position,
          mapIndex = _ref2.mapIndex;
        return /*#__PURE__*/_react["default"].createElement(PortalEditor, {
          selectedFeature: selectedFeature,
          visiblePanel: Boolean(rightClick) && selectedFeature && index === mapIndex,
          datasets: datasets,
          layers: availableLayers,
          currentFilter: currentFilter,
          onClose: this._closeFeatureAction,
          onDeleteFeature: this._onDeleteSelectedFeature,
          onToggleLayer: this._togglePolygonFilter,
          position: position || null,
          className: className,
          style: style
        });
      }
    }]);
  }(_react.Component);
  (0, _defineProperty2["default"])(EditorUnmemoized, "defaultProps", {});
  (0, _defineProperty2["default"])(EditorUnmemoized, "displayName", 'Editor');
  var Editor = /*#__PURE__*/_react["default"].memo(EditorUnmemoized);
  Editor.displayName = 'Editor';
  return Editor;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfcmVhY3REb20iLCJfc3R5bGVkQ29tcG9uZW50cyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfd2luZG93IiwiX2NsYXNzbmFtZXMiLCJfZ2V0IiwiX3Jlc2VsZWN0IiwiX2ZlYXR1cmVBY3Rpb25QYW5lbCIsIl9jb25zdGFudHMiLCJfbGF5ZXJzIiwiX2NvbnRleHQiLCJfdGVtcGxhdGVPYmplY3QiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsIl90eXBlb2YiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJfY2FsbFN1cGVyIiwibyIsIl9nZXRQcm90b3R5cGVPZjIiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIiLCJfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImNvbnN0cnVjdG9yIiwiYXBwbHkiLCJCb29sZWFuIiwicHJvdG90eXBlIiwidmFsdWVPZiIsIkRFQ0tHTF9SRU5ERVJfTEFZRVIiLCJTdHlsZWRXcmFwcGVyIiwiZGl2IiwiX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbDIiLCJlZGl0b3JMYXllckZpbHRlciIsImxheWVyIiwiRURJVE9SX0FWQUlMQUJMRV9MQVlFUlMiLCJpbmNsdWRlcyIsInR5cGUiLCJFZGl0b3JGYWN0b3J5IiwiZGVwcyIsIkZlYXR1cmVBY3Rpb25QYW5lbCIsIlBvcnRhbEVkaXRvciIsIl9yZWYiLCJ2aXNpYmxlUGFuZWwiLCJjbGFzc05hbWUiLCJzdHlsZSIsInNlbGVjdGVkRmVhdHVyZSIsImRhdGFzZXRzIiwibGF5ZXJzIiwiY3VycmVudEZpbHRlciIsIm9uQ2xvc2UiLCJvbkRlbGV0ZUZlYXR1cmUiLCJvblRvZ2dsZUxheWVyIiwicG9zaXRpb24iLCJjcmVhdGVFbGVtZW50IiwiUm9vdENvbnRleHQiLCJDb25zdW1lciIsImNvbnRleHQiLCJfY29udGV4dCRjdXJyZW50IiwiRnJhZ21lbnQiLCJjcmVhdGVQb3J0YWwiLCJjdXJyZW50IiwiZG9jdW1lbnQiLCJib2R5IiwiRWRpdG9yVW5tZW1vaXplZCIsIl9Db21wb25lbnQiLCJfdGhpcyIsIl9jbGFzc0NhbGxDaGVjazIiLCJfbGVuIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYXJncyIsIkFycmF5IiwiX2tleSIsImNvbmNhdCIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJwcm9wcyIsImZpbHRlcnMiLCJjcmVhdGVTZWxlY3RvciIsImZpbHRlclNlbGVjdG9yIiwic2VsZWN0ZWRGZWF0dXJlSWRTZWxlY3RvciIsInNlbGVjdGVkRmVhdHVyZUlkIiwiZmluZCIsImYiLCJ2YWx1ZSIsImlkIiwibGF5ZXJTZWxlY3RvciIsImZpbHRlciIsIl9sYXllciRjb25maWciLCJjb25maWciLCJpc1Zpc2libGUiLCJHRU9DT0RFUl9MQVlFUl9JRCIsImVkaXRvckZlYXR1cmVTZWxlY3RvciIsImVkaXRvckZlYXR1cmVzIiwiRklMVEVSX1RZUEVTIiwicG9seWdvbiIsIm1hcCIsIl9kb2N1bWVudCRhY3RpdmVFbGVtZSIsImFjdGl2ZUVsZW1lbnQiLCJldmVudCIsImlzSW5Gb2N1cyIsImtleUNvZGUiLCJLZXlFdmVudCIsIkRPTV9WS19ERUxFVEUiLCJET01fVktfQkFDS19TUEFDRSIsIl9vbkRlbGV0ZVNlbGVjdGVkRmVhdHVyZSIsIkRPTV9WS19FU0NBUEUiLCJFZGl0b3JMYXllclV0aWxzIiwiaXNEcmF3aW5nQWN0aXZlIiwiZWRpdG9yIiwibW9kZSIsIm9uU2V0RWRpdG9yTW9kZSIsIkVESVRPUl9NT0RFUyIsIkVESVQiLCJvblNlbGVjdCIsIm9uVG9nZ2xlUG9seWdvbkZpbHRlciIsIl9pbmhlcml0czIiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwiY29tcG9uZW50RGlkTW91bnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX29uS2V5UHJlc3NlZCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlbmRlciIsIl90aGlzJHByb3BzIiwiaW5kZXgiLCJzZWxlY3Rpb25Db250ZXh0IiwiY3VycmVudEZpbHRlclNlbGVjdG9yIiwiYXZhaWxhYmxlTGF5ZXJzIiwiYXZhaWxhYmxlTGF5ZXJzU2VsZWN0b3IiLCJfcmVmMiIsInJpZ2h0Q2xpY2siLCJtYXBJbmRleCIsIl9jbG9zZUZlYXR1cmVBY3Rpb24iLCJfdG9nZ2xlUG9seWdvbkZpbHRlciIsIkNvbXBvbmVudCIsIkVkaXRvciIsIm1lbW8iLCJkaXNwbGF5TmFtZSJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lZGl0b3IvZWRpdG9yLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIENTU1Byb3BlcnRpZXMsIEtleWJvYXJkRXZlbnR9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7Y3JlYXRlUG9ydGFsfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgV2luZG93IGZyb20gJ2dsb2JhbC93aW5kb3cnO1xuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC9nZXQnO1xuaW1wb3J0IHtjcmVhdGVTZWxlY3Rvcn0gZnJvbSAncmVzZWxlY3QnO1xuaW1wb3J0IEZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnksIHtGZWF0dXJlQWN0aW9uUGFuZWxQcm9wc30gZnJvbSAnLi9mZWF0dXJlLWFjdGlvbi1wYW5lbCc7XG5pbXBvcnQge1xuICBFRElUT1JfQVZBSUxBQkxFX0xBWUVSUyxcbiAgRklMVEVSX1RZUEVTLFxuICBFRElUT1JfTU9ERVMsXG4gIEdFT0NPREVSX0xBWUVSX0lELFxuICBLZXlFdmVudFxufSBmcm9tICdAa2VwbGVyLmdsL2NvbnN0YW50cyc7XG5pbXBvcnQge0xheWVyLCBFZGl0b3JMYXllclV0aWxzfSBmcm9tICdAa2VwbGVyLmdsL2xheWVycyc7XG5pbXBvcnQge0ZpbHRlciwgRmVhdHVyZVNlbGVjdGlvbkNvbnRleHQsIEZlYXR1cmV9IGZyb20gJ0BrZXBsZXIuZ2wvdHlwZXMnO1xuaW1wb3J0IHtGZWF0dXJlT2YsIFBvbHlnb259IGZyb20gJ0BuZWJ1bGEuZ2wvZWRpdC1tb2Rlcyc7XG5pbXBvcnQge0RhdGFzZXRzfSBmcm9tICdAa2VwbGVyLmdsL3RhYmxlJztcblxuaW1wb3J0IHtSb290Q29udGV4dH0gZnJvbSAnLi4vY29udGV4dCc7XG5cbmNvbnN0IERFQ0tHTF9SRU5ERVJfTEFZRVIgPSAnZGVmYXVsdC1kZWNrZ2wtb3ZlcmxheS13cmFwcGVyJztcblxuY29uc3QgU3R5bGVkV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbmA7XG5cbmNvbnN0IGVkaXRvckxheWVyRmlsdGVyID0gKGxheWVyOiBMYXllcikgPT4gRURJVE9SX0FWQUlMQUJMRV9MQVlFUlMuaW5jbHVkZXMobGF5ZXIudHlwZSB8fCAnJyk7XG5cbkVkaXRvckZhY3RvcnkuZGVwcyA9IFtGZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5XTtcblxuaW50ZXJmYWNlIEVkaXRvclByb3BzIHtcbiAgZmlsdGVyczogRmlsdGVyW107XG4gIGxheWVyczogTGF5ZXJbXTtcbiAgZGF0YXNldHM6IERhdGFzZXRzO1xuICBlZGl0b3I6IHtzZWxlY3RlZEZlYXR1cmU6IEZlYXR1cmU7IG1vZGU6IHN0cmluZzsgc2VsZWN0aW9uQ29udGV4dD86IEZlYXR1cmVTZWxlY3Rpb25Db250ZXh0fTtcbiAgaW5kZXg6IG51bWJlcjtcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICBzdHlsZTogQ1NTUHJvcGVydGllcztcbiAgb25TZWxlY3Q6IChmOiBGZWF0dXJlIHwgbnVsbCkgPT4gYW55O1xuICBvblNldEVkaXRvck1vZGU6IChtOiBhbnkpID0+IHZvaWQ7XG4gIG9uRGVsZXRlRmVhdHVyZTogKGY6IEZlYXR1cmUpID0+IGFueTtcbiAgb25Ub2dnbGVQb2x5Z29uRmlsdGVyOiAobDogTGF5ZXIsIGY6IEZlYXR1cmUpID0+IGFueTtcbn1cblxuZXhwb3J0IHR5cGUgUG9ydGFsRWRpdG9yUHJvcHMgPSBGZWF0dXJlQWN0aW9uUGFuZWxQcm9wcyAmIHtcbiAgdmlzaWJsZVBhbmVsOiBib29sZWFuO1xuICBzdHlsZT86IFJlYWN0LkNTU1Byb3BlcnRpZXM7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBFZGl0b3JGYWN0b3J5KFxuICBGZWF0dXJlQWN0aW9uUGFuZWw6IFJlYWN0LkZDPEZlYXR1cmVBY3Rpb25QYW5lbFByb3BzPlxuKTogUmVhY3QuQ29tcG9uZW50Q2xhc3M8RWRpdG9yUHJvcHM+IHtcbiAgY29uc3QgUG9ydGFsRWRpdG9yOiBSZWFjdC5GQzxQb3J0YWxFZGl0b3JQcm9wcz4gPSAoe1xuICAgIHZpc2libGVQYW5lbCxcbiAgICBjbGFzc05hbWUsXG4gICAgc3R5bGUsXG4gICAgc2VsZWN0ZWRGZWF0dXJlLFxuICAgIGRhdGFzZXRzLFxuICAgIGxheWVycyxcbiAgICBjdXJyZW50RmlsdGVyLFxuICAgIG9uQ2xvc2UsXG4gICAgb25EZWxldGVGZWF0dXJlLFxuICAgIG9uVG9nZ2xlTGF5ZXIsXG4gICAgcG9zaXRpb25cbiAgfSkgPT4ge1xuICAgIHJldHVybiAoXG4gICAgICA8Um9vdENvbnRleHQuQ29uc3VtZXI+XG4gICAgICAgIHtjb250ZXh0ID0+IChcbiAgICAgICAgICA8PlxuICAgICAgICAgICAge2NyZWF0ZVBvcnRhbChcbiAgICAgICAgICAgICAgPFN0eWxlZFdyYXBwZXIgY2xhc3NOYW1lPXtjbGFzc25hbWVzKCdlZGl0b3InLCBjbGFzc05hbWUpfSBzdHlsZT17c3R5bGV9PlxuICAgICAgICAgICAgICAgIHt2aXNpYmxlUGFuZWwgPyAoXG4gICAgICAgICAgICAgICAgICA8RmVhdHVyZUFjdGlvblBhbmVsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmVhdHVyZT17c2VsZWN0ZWRGZWF0dXJlIGFzIEZlYXR1cmVPZjxQb2x5Z29uPn1cbiAgICAgICAgICAgICAgICAgICAgZGF0YXNldHM9e2RhdGFzZXRzfVxuICAgICAgICAgICAgICAgICAgICBsYXllcnM9e2xheWVyc31cbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpbHRlcj17Y3VycmVudEZpbHRlcn1cbiAgICAgICAgICAgICAgICAgICAgb25DbG9zZT17b25DbG9zZX1cbiAgICAgICAgICAgICAgICAgICAgb25EZWxldGVGZWF0dXJlPXtvbkRlbGV0ZUZlYXR1cmV9XG4gICAgICAgICAgICAgICAgICAgIG9uVG9nZ2xlTGF5ZXI9e29uVG9nZ2xlTGF5ZXJ9XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPXtwb3NpdGlvbiB8fCBudWxsfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgPC9TdHlsZWRXcmFwcGVyPixcbiAgICAgICAgICAgICAgY29udGV4dD8uY3VycmVudCA/PyBkb2N1bWVudC5ib2R5XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvPlxuICAgICAgICApfVxuICAgICAgPC9Sb290Q29udGV4dC5Db25zdW1lcj5cbiAgICApO1xuICB9O1xuICBjbGFzcyBFZGl0b3JVbm1lbW9pemVkIGV4dGVuZHMgQ29tcG9uZW50PEVkaXRvclByb3BzPiB7XG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHt9O1xuXG4gICAgc3RhdGljIGRpc3BsYXlOYW1lID0gJ0VkaXRvcic7XG5cbiAgICBzdGF0ZSA9IHt9O1xuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICBXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX29uS2V5UHJlc3NlZCk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICBXaW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX29uS2V5UHJlc3NlZCk7XG4gICAgfVxuXG4gICAgbGF5ZXJTZWxlY3RvciA9IChwcm9wczogRWRpdG9yUHJvcHMpID0+IHByb3BzLmxheWVycztcbiAgICBmaWx0ZXJTZWxlY3RvciA9IChwcm9wczogRWRpdG9yUHJvcHMpID0+IHByb3BzLmZpbHRlcnM7XG4gICAgc2VsZWN0ZWRGZWF0dXJlSWRTZWxlY3RvciA9IChwcm9wczogRWRpdG9yUHJvcHMpID0+XG4gICAgICBnZXQocHJvcHMsIFsnZWRpdG9yJywgJ3NlbGVjdGVkRmVhdHVyZScsICdpZCddKTtcbiAgICBlZGl0b3JGZWF0dXJlU2VsZWN0b3IgPSAocHJvcHM6IEVkaXRvclByb3BzKSA9PiBnZXQocHJvcHMsIFsnZWRpdG9yJywgJ2ZlYXR1cmVzJ10pO1xuXG4gICAgY3VycmVudEZpbHRlclNlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3IoXG4gICAgICB0aGlzLmZpbHRlclNlbGVjdG9yLFxuICAgICAgdGhpcy5zZWxlY3RlZEZlYXR1cmVJZFNlbGVjdG9yLFxuICAgICAgKGZpbHRlcnMsIHNlbGVjdGVkRmVhdHVyZUlkKSA9PiBmaWx0ZXJzLmZpbmQoZiA9PiBmLnZhbHVlICYmIGYudmFsdWUuaWQgPT09IHNlbGVjdGVkRmVhdHVyZUlkKVxuICAgICk7XG5cbiAgICBhdmFpbGFibGVMYXllcnNTZWxlY3RvciA9IGNyZWF0ZVNlbGVjdG9yKHRoaXMubGF5ZXJTZWxlY3RvciwgbGF5ZXJzID0+XG4gICAgICBsYXllcnNcbiAgICAgICAgLmZpbHRlcihlZGl0b3JMYXllckZpbHRlcilcbiAgICAgICAgLmZpbHRlcihsYXllciA9PiBsYXllci5jb25maWc/LmlzVmlzaWJsZSAmJiBsYXllci5pZCAhPT0gR0VPQ09ERVJfTEFZRVJfSUQpXG4gICAgKTtcblxuICAgIGFsbEZlYXR1cmVzU2VsZWN0b3IgPSBjcmVhdGVTZWxlY3RvcihcbiAgICAgIHRoaXMuZmlsdGVyU2VsZWN0b3IsXG4gICAgICB0aGlzLmVkaXRvckZlYXR1cmVTZWxlY3RvcixcbiAgICAgIChmaWx0ZXJzLCBlZGl0b3JGZWF0dXJlcykgPT5cbiAgICAgICAgZmlsdGVyc1xuICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLnR5cGUgPT09IEZJTFRFUl9UWVBFUy5wb2x5Z29uKVxuICAgICAgICAgIC5tYXAoZiA9PiBmLnZhbHVlKVxuICAgICAgICAgIC5jb25jYXQoZWRpdG9yRmVhdHVyZXMpXG4gICAgKTtcblxuICAgIGlzSW5Gb2N1cyA9ICgpID0+IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ/LmlkID09PSBERUNLR0xfUkVOREVSX0xBWUVSO1xuXG4gICAgX29uS2V5UHJlc3NlZCA9IChldmVudDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNJbkZvY3VzKCkpIHtcbiAgICAgICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG4gICAgICAgICAgY2FzZSBLZXlFdmVudC5ET01fVktfREVMRVRFOlxuICAgICAgICAgIGNhc2UgS2V5RXZlbnQuRE9NX1ZLX0JBQ0tfU1BBQ0U6XG4gICAgICAgICAgICB0aGlzLl9vbkRlbGV0ZVNlbGVjdGVkRmVhdHVyZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBLZXlFdmVudC5ET01fVktfRVNDQVBFOlxuICAgICAgICAgICAgLy8gcmVzZXQgYWN0aXZlIGRyYXdpbmdcbiAgICAgICAgICAgIGlmIChFZGl0b3JMYXllclV0aWxzLmlzRHJhd2luZ0FjdGl2ZSh0cnVlLCB0aGlzLnByb3BzLmVkaXRvci5tb2RlKSkge1xuICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uU2V0RWRpdG9yTW9kZShFRElUT1JfTU9ERVMuRURJVCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucHJvcHMub25TZWxlY3QobnVsbCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX29uRGVsZXRlU2VsZWN0ZWRGZWF0dXJlID0gKCkgPT4ge1xuICAgICAgY29uc3Qge2VkaXRvcn0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3Qge3NlbGVjdGVkRmVhdHVyZX0gPSBlZGl0b3I7XG4gICAgICBpZiAoc2VsZWN0ZWRGZWF0dXJlKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25EZWxldGVGZWF0dXJlKHNlbGVjdGVkRmVhdHVyZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9jbG9zZUZlYXR1cmVBY3Rpb24gPSAoKSA9PiB7XG4gICAgICAvLyByZXNldCBzZWxlY3Rpb24gY29udGV4dFxuICAgICAgY29uc3Qge3NlbGVjdGVkRmVhdHVyZX0gPSB0aGlzLnByb3BzLmVkaXRvcjtcbiAgICAgIHRoaXMucHJvcHMub25TZWxlY3Qoc2VsZWN0ZWRGZWF0dXJlKTtcbiAgICB9O1xuXG4gICAgX3RvZ2dsZVBvbHlnb25GaWx0ZXIgPSAobGF5ZXI6IExheWVyKSA9PiB7XG4gICAgICBjb25zdCB7c2VsZWN0ZWRGZWF0dXJlfSA9IHRoaXMucHJvcHMuZWRpdG9yO1xuICAgICAgaWYgKHNlbGVjdGVkRmVhdHVyZSkge1xuICAgICAgICB0aGlzLnByb3BzLm9uVG9nZ2xlUG9seWdvbkZpbHRlcihsYXllciwgc2VsZWN0ZWRGZWF0dXJlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgY29uc3Qge2NsYXNzTmFtZSwgZGF0YXNldHMsIGVkaXRvciwgc3R5bGUsIGluZGV4fSA9IHRoaXMucHJvcHM7XG4gICAgICBjb25zdCB7c2VsZWN0ZWRGZWF0dXJlLCBzZWxlY3Rpb25Db250ZXh0fSA9IGVkaXRvcjtcbiAgICAgIGNvbnN0IGN1cnJlbnRGaWx0ZXIgPSB0aGlzLmN1cnJlbnRGaWx0ZXJTZWxlY3Rvcih0aGlzLnByb3BzKTtcbiAgICAgIGNvbnN0IGF2YWlsYWJsZUxheWVycyA9IHRoaXMuYXZhaWxhYmxlTGF5ZXJzU2VsZWN0b3IodGhpcy5wcm9wcyk7XG5cbiAgICAgIGNvbnN0IHtyaWdodENsaWNrLCBwb3NpdGlvbiwgbWFwSW5kZXh9ID0gc2VsZWN0aW9uQ29udGV4dCB8fCB7fTtcblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPFBvcnRhbEVkaXRvclxuICAgICAgICAgIHNlbGVjdGVkRmVhdHVyZT17c2VsZWN0ZWRGZWF0dXJlIGFzIEZlYXR1cmVPZjxQb2x5Z29uPn1cbiAgICAgICAgICB2aXNpYmxlUGFuZWw9e0Jvb2xlYW4ocmlnaHRDbGljaykgJiYgc2VsZWN0ZWRGZWF0dXJlICYmIGluZGV4ID09PSBtYXBJbmRleH1cbiAgICAgICAgICBkYXRhc2V0cz17ZGF0YXNldHN9XG4gICAgICAgICAgbGF5ZXJzPXthdmFpbGFibGVMYXllcnN9XG4gICAgICAgICAgY3VycmVudEZpbHRlcj17Y3VycmVudEZpbHRlcn1cbiAgICAgICAgICBvbkNsb3NlPXt0aGlzLl9jbG9zZUZlYXR1cmVBY3Rpb259XG4gICAgICAgICAgb25EZWxldGVGZWF0dXJlPXt0aGlzLl9vbkRlbGV0ZVNlbGVjdGVkRmVhdHVyZX1cbiAgICAgICAgICBvblRvZ2dsZUxheWVyPXt0aGlzLl90b2dnbGVQb2x5Z29uRmlsdGVyfVxuICAgICAgICAgIHBvc2l0aW9uPXtwb3NpdGlvbiB8fCBudWxsfVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lfVxuICAgICAgICAgIHN0eWxlPXtzdHlsZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgRWRpdG9yID0gUmVhY3QubWVtbyhFZGl0b3JVbm1lbW9pemVkKSBhcyB1bmtub3duIGFzIHR5cGVvZiBFZGl0b3JVbm1lbW9pemVkO1xuICBFZGl0b3IuZGlzcGxheU5hbWUgPSAnRWRpdG9yJztcbiAgcmV0dXJuIEVkaXRvcjtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBR0EsSUFBQUEsTUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsaUJBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUQsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFLLFdBQUEsR0FBQUYsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFNLElBQUEsR0FBQUgsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFPLFNBQUEsR0FBQVAsT0FBQTtBQUNBLElBQUFRLG1CQUFBLEdBQUFMLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBUyxVQUFBLEdBQUFULE9BQUE7QUFPQSxJQUFBVSxPQUFBLEdBQUFWLE9BQUE7QUFLQSxJQUFBVyxRQUFBLEdBQUFYLE9BQUE7QUFBdUMsSUFBQVksZUFBQSxFQXZCdkM7QUFDQTtBQUFBLFNBQUFDLHlCQUFBQyxDQUFBO0VBQUEseUJBQUFDLE9BQUE7RUFBQSxJQUFBQyxDQUFBLE9BQUFELE9BQUE7SUFBQUUsQ0FBQSxPQUFBRixPQUFBO0VBQUEsUUFBQUYsd0JBQUEsWUFBQUEseUJBQUFDLENBQUE7SUFBQSxPQUFBQSxDQUFBLEdBQUFHLENBQUEsR0FBQUQsQ0FBQTtFQUFBLEdBQUFGLENBQUE7QUFBQTtBQUFBLFNBQUFmLHdCQUFBZSxDQUFBLEVBQUFFLENBQUE7RUFBQSxLQUFBQSxDQUFBLElBQUFGLENBQUEsSUFBQUEsQ0FBQSxDQUFBSSxVQUFBLFNBQUFKLENBQUE7RUFBQSxhQUFBQSxDQUFBLGdCQUFBSyxPQUFBLENBQUFMLENBQUEsMEJBQUFBLENBQUE7SUFBQSxXQUFBQTtFQUFBO0VBQUEsSUFBQUcsQ0FBQSxHQUFBSix3QkFBQSxDQUFBRyxDQUFBO0VBQUEsSUFBQUMs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