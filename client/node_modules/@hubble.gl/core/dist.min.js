(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else if (typeof exports === 'object') exports['hubble'] = factory();
  else root['hubble'] = factory();})(globalThis, function () {
var __exports__=(()=>{var Oo=Object.create;var dr=Object.defineProperty;var Lo=Object.getOwnPropertyDescriptor;var Po=Object.getOwnPropertyNames;var Ro=Object.getPrototypeOf,zo=Object.prototype.hasOwnProperty;var Ye=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var me=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),zn=(e,t)=>{for(var r in t)dr(e,r,{get:t[r],enumerable:!0})},Un=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Po(t))!zo.call(e,i)&&i!==r&&dr(e,i,{get:()=>t[i],enumerable:!(n=Lo(t,i))||n.enumerable});return e};var pr=(e,t,r)=>(r=e!=null?Oo(Ro(e)):{},Un(t||!e||!e.__esModule?dr(r,"default",{value:e,enumerable:!0}):r,e)),Uo=e=>Un(dr({},"__esModule",{value:!0}),e);var Oi=me((Mi,un)=>{(function(e){typeof Mi=="object"&&typeof un<"u"?un.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=e()})(function(){return function e(t,r,n){function i(d,k){if(!r[d]){if(!t[d]){var x=typeof Ye=="function"&&Ye;if(!k&&x)return x(d,!0);if(o)return o(d,!0);var b=new Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b}var u=r[d]={exports:{}};t[d][0].call(u.exports,function(g){var c=t[d][1][g];return i(c||g)},u,u.exports,e,t,r,n)}return r[d].exports}for(var o=typeof Ye=="function"&&Ye,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(s){for(var d,k,x,b,u,g,c,m=[],p=0,_=s.length,T=_,M=n.getTypeOf(s)!=="string";p<s.length;)T=_-p,x=M?(d=s[p++],k=p<_?s[p++]:0,p<_?s[p++]:0):(d=s.charCodeAt(p++),k=p<_?s.charCodeAt(p++):0,p<_?s.charCodeAt(p++):0),b=d>>2,u=(3&d)<<4|k>>4,g=1<T?(15&k)<<2|x>>6:64,c=2<T?63&x:64,m.push(o.charAt(b)+o.charAt(u)+o.charAt(g)+o.charAt(c));return m.join("")},r.decode=function(s){var d,k,x,b,u,g,c=0,m=0,p="data:";if(s.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var _,T=3*(s=s.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(s.charAt(s.length-1)===o.charAt(64)&&T--,s.charAt(s.length-2)===o.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=i.uint8array?new Uint8Array(0|T):new Array(0|T);c<s.length;)d=o.indexOf(s.charAt(c++))<<2|(b=o.indexOf(s.charAt(c++)))>>4,k=(15&b)<<4|(u=o.indexOf(s.charAt(c++)))>>2,x=(3&u)<<6|(g=o.indexOf(s.charAt(c++))),_[m++]=d,u!==64&&(_[m++]=k),g!==64&&(_[m++]=x);return _}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),s=e("./stream/DataLengthProbe");function d(k,x,b,u,g){this.compressedSize=k,this.uncompressedSize=x,this.crc32=b,this.compression=u,this.compressedContent=g}d.prototype={getContentWorker:function(){var k=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),x=this;return k.on("end",function(){if(this.streamInfo.data_length!==x.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),k},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(k,x,b){return k.pipe(new o).pipe(new s("uncompressedSize")).pipe(x.compressWorker(b)).pipe(new s("compressedSize")).withStreamInfo("compression",x)},t.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),i=function(){for(var o,s=[],d=0;d<256;d++){o=d;for(var k=0;k<8;k++)o=1&o?3988292384^o>>>1:o>>>1;s[d]=o}return s}();t.exports=function(o,s){return o!==void 0&&o.length?n.getTypeOf(o)!=="string"?function(d,k,x,b){var u=i,g=b+x;d^=-1;for(var c=b;c<g;c++)d=d>>>8^u[255&(d^k[c])];return-1^d}(0|s,o,o.length,0):function(d,k,x,b){var u=i,g=b+x;d^=-1;for(var c=b;c<g;c++)d=d>>>8^u[255&(d^k.charCodeAt(c))];return-1^d}(0|s,o,o.length,0):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var n=null;n=typeof Promise<"u"?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){"use strict";var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=e("pako"),o=e("./utils"),s=e("./stream/GenericWorker"),d=n?"uint8array":"array";function k(x,b){s.call(this,"FlateWorker/"+x),this._pako=null,this._pakoAction=x,this._pakoOptions=b,this.meta={}}r.magic="\b\0",o.inherits(k,s),k.prototype.processChunk=function(x){this.meta=x.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(d,x.data),!1)},k.prototype.flush=function(){s.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},k.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},k.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var x=this;this._pako.onData=function(b){x.push({data:b,meta:x.meta})}},r.compressWorker=function(x){return new k("Deflate",x)},r.uncompressWorker=function(){return new k("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function n(u,g){var c,m="";for(c=0;c<g;c++)m+=String.fromCharCode(255&u),u>>>=8;return m}function i(u,g,c,m,p,_){var T,M,C=u.file,W=u.compression,P=_!==d.utf8encode,V=o.transformTo("string",_(C.name)),U=o.transformTo("string",d.utf8encode(C.name)),K=C.comment,ot=o.transformTo("string",_(K)),A=o.transformTo("string",d.utf8encode(K)),N=U.length!==C.name.length,f=A.length!==K.length,G="",ut="",H="",E=C.dir,h=C.date,S={crc32:0,compressedSize:0,uncompressedSize:0};g&&!c||(S.crc32=u.crc32,S.compressedSize=u.compressedSize,S.uncompressedSize=u.uncompressedSize);var w=0;g&&(w|=8),P||!N&&!f||(w|=2048);var l=0,z=0;E&&(l|=16),p==="UNIX"?(z=798,l|=function(O,Y){var J=O;return O||(J=Y?16893:33204),(65535&J)<<16}(C.unixPermissions,E)):(z=20,l|=function(O){return 63&(O||0)}(C.dosPermissions)),T=h.getUTCHours(),T<<=6,T|=h.getUTCMinutes(),T<<=5,T|=h.getUTCSeconds()/2,M=h.getUTCFullYear()-1980,M<<=4,M|=h.getUTCMonth()+1,M<<=5,M|=h.getUTCDate(),N&&(ut=n(1,1)+n(k(V),4)+U,G+="up"+n(ut.length,2)+ut),f&&(H=n(1,1)+n(k(ot),4)+A,G+="uc"+n(H.length,2)+H);var R="";return R+=`
\0`,R+=n(w,2),R+=W.magic,R+=n(T,2),R+=n(M,2),R+=n(S.crc32,4),R+=n(S.compressedSize,4),R+=n(S.uncompressedSize,4),R+=n(V.length,2),R+=n(G.length,2),{fileRecord:x.LOCAL_FILE_HEADER+R+V+G,dirRecord:x.CENTRAL_FILE_HEADER+n(z,2)+R+n(ot.length,2)+"\0\0\0\0"+n(l,4)+n(m,4)+V+G+ot}}var o=e("../utils"),s=e("../stream/GenericWorker"),d=e("../utf8"),k=e("../crc32"),x=e("../signature");function b(u,g,c,m){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=c,this.encodeFileName=m,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(b,s),b.prototype.push=function(u){var g=u.meta.percent||0,c=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,s.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:c?(g+100*(c-m-1))/c:100}}))},b.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var g=this.streamFiles&&!u.file.dir;if(g){var c=i(u,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(u){this.accumulate=!1;var g=this.streamFiles&&!u.file.dir,c=i(u,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),g)this.push({data:function(m){return x.DATA_DESCRIPTOR+n(m.crc32,4)+n(m.compressedSize,4)+n(m.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var u=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var c=this.bytesWritten-u,m=function(p,_,T,M,C){var W=o.transformTo("string",C(M));return x.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(p,2)+n(p,2)+n(_,4)+n(T,4)+n(W.length,2)+W}(this.dirRecords.length,c,u,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(u){this._sources.push(u);var g=this;return u.on("data",function(c){g.processChunk(c)}),u.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),u.on("error",function(c){g.error(c)}),this},b.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(u){var g=this._sources;if(!s.prototype.error.call(this,u))return!1;for(var c=0;c<g.length;c++)try{g[c].error(u)}catch{}return!0},b.prototype.lock=function(){s.prototype.lock.call(this);for(var u=this._sources,g=0;g<u.length;g++)u[g].lock()},t.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var n=e("../compressions"),i=e("./ZipFileWorker");r.generateWorker=function(o,s,d){var k=new i(s.streamFiles,d,s.platform,s.encodeFileName),x=0;try{o.forEach(function(b,u){x++;var g=function(_,T){var M=_||T,C=n[M];if(!C)throw new Error(M+" is not a valid compression method !");return C}(u.options.compression,s.compression),c=u.options.compressionOptions||s.compressionOptions||{},m=u.dir,p=u.date;u._compressWorker(g,c).withStreamInfo("file",{name:b,dir:m,date:p,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(k)}),k.entriesCount=x}catch(b){k.error(b)}return k}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new n;for(var o in this)typeof this[o]!="function"&&(i[o]=this[o]);return i}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(i,o){return new n().loadAsync(i,o)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./external"),o=e("./utf8"),s=e("./zipEntries"),d=e("./stream/Crc32Probe"),k=e("./nodejsUtils");function x(b){return new i.Promise(function(u,g){var c=b.decompressed.getContentWorker().pipe(new d);c.on("error",function(m){g(m)}).on("end",function(){c.streamInfo.crc32!==b.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}t.exports=function(b,u){var g=this;return u=n.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),k.isNode&&k.isStream(b)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",b,!0,u.optimizedBinaryString,u.base64).then(function(c){var m=new s(u);return m.load(c),m}).then(function(c){var m=[i.Promise.resolve(c)],p=c.files;if(u.checkCRC32)for(var _=0;_<p.length;_++)m.push(x(p[_]));return i.Promise.all(m)}).then(function(c){for(var m=c.shift(),p=m.files,_=0;_<p.length;_++){var T=p[_],M=T.fileNameStr,C=n.resolve(T.fileNameStr);g.file(C,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:u.createFolders}),T.dir||(g.file(C).unsafeOriginalName=M)}return m.zipComment.length&&(g.comment=m.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../stream/GenericWorker");function o(s,d){i.call(this,"Nodejs stream input adapter for "+s),this._upstreamEnded=!1,this._bindStream(d)}n.inherits(o,i),o.prototype._bindStream=function(s){var d=this;(this._stream=s).pause(),s.on("data",function(k){d.push({data:k,meta:{percent:0}})}).on("error",function(k){d.isPaused?this.generatedError=k:d.error(k)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var n=e("readable-stream").Readable;function i(o,s,d){n.call(this,s),this._helper=o;var k=this;o.on("data",function(x,b){k.push(x)||k._helper.pause(),d&&d(b)}).on("error",function(x){k.emit("error",x)}).on("end",function(){k.push(null)})}e("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,i);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,i)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var i=new Buffer(n);return i.fill(0),i},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,t,r){"use strict";function n(C,W,P){var V,U=o.getTypeOf(W),K=o.extend(P||{},k);K.date=K.date||new Date,K.compression!==null&&(K.compression=K.compression.toUpperCase()),typeof K.unixPermissions=="string"&&(K.unixPermissions=parseInt(K.unixPermissions,8)),K.unixPermissions&&16384&K.unixPermissions&&(K.dir=!0),K.dosPermissions&&16&K.dosPermissions&&(K.dir=!0),K.dir&&(C=p(C)),K.createFolders&&(V=m(C))&&_.call(this,V,!0);var ot=U==="string"&&K.binary===!1&&K.base64===!1;P&&P.binary!==void 0||(K.binary=!ot),(W instanceof x&&W.uncompressedSize===0||K.dir||!W||W.length===0)&&(K.base64=!1,K.binary=!0,W="",K.compression="STORE",U="string");var A=null;A=W instanceof x||W instanceof s?W:g.isNode&&g.isStream(W)?new c(C,W):o.prepareContent(C,W,K.binary,K.optimizedBinaryString,K.base64);var N=new b(C,A,K);this.files[C]=N}var i=e("./utf8"),o=e("./utils"),s=e("./stream/GenericWorker"),d=e("./stream/StreamHelper"),k=e("./defaults"),x=e("./compressedObject"),b=e("./zipObject"),u=e("./generate"),g=e("./nodejsUtils"),c=e("./nodejs/NodejsStreamInputAdapter"),m=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var W=C.lastIndexOf("/");return 0<W?C.substring(0,W):""},p=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},_=function(C,W){return W=W!==void 0?W:k.createFolders,C=p(C),this.files[C]||n.call(this,C,null,{dir:!0,createFolders:W}),this.files[C]};function T(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var W,P,V;for(W in this.files)V=this.files[W],(P=W.slice(this.root.length,W.length))&&W.slice(0,this.root.length)===this.root&&C(P,V)},filter:function(C){var W=[];return this.forEach(function(P,V){C(P,V)&&W.push(V)}),W},file:function(C,W,P){if(arguments.length!==1)return C=this.root+C,n.call(this,C,W,P),this;if(T(C)){var V=C;return this.filter(function(K,ot){return!ot.dir&&V.test(K)})}var U=this.files[this.root+C];return U&&!U.dir?U:null},folder:function(C){if(!C)return this;if(T(C))return this.filter(function(U,K){return K.dir&&C.test(U)});var W=this.root+C,P=_.call(this,W),V=this.clone();return V.root=P.name,V},remove:function(C){C=this.root+C;var W=this.files[C];if(W||(C.slice(-1)!=="/"&&(C+="/"),W=this.files[C]),W&&!W.dir)delete this.files[C];else for(var P=this.filter(function(U,K){return K.name.slice(0,C.length)===C}),V=0;V<P.length;V++)delete this.files[P[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var W,P={};try{if((P=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");o.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var V=P.comment||this.comment||"";W=u.generateWorker(this,P,V)}catch(U){(W=new s("error")).error(U)}return new d(W,P.type||"string",P.mimeType)},generateAsync:function(C,W){return this.generateInternalStream(C).accumulate(W)},generateNodeStream:function(C,W){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(W)}};t.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function i(o){n.call(this,o);for(var s=0;s<this.data.length;s++)o[s]=255&o[s]}e("../utils").inherits(i,n),i.prototype.byteAt=function(o){return this.data[this.zero+o]},i.prototype.lastIndexOfSignature=function(o){for(var s=o.charCodeAt(0),d=o.charCodeAt(1),k=o.charCodeAt(2),x=o.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===s&&this.data[b+1]===d&&this.data[b+2]===k&&this.data[b+3]===x)return b-this.zero;return-1},i.prototype.readAndCheckSignature=function(o){var s=o.charCodeAt(0),d=o.charCodeAt(1),k=o.charCodeAt(2),x=o.charCodeAt(3),b=this.readData(4);return s===b[0]&&d===b[1]&&k===b[2]&&x===b[3]},i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var s=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,s},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function i(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var s,d=0;for(this.checkOffset(o),s=this.index+o-1;s>=this.index;s--)d=(d<<8)+this.byteAt(s);return this.index+=o,d},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function i(o){n.call(this,o)}e("../utils").inherits(i,n),i.prototype.readData=function(o){this.checkOffset(o);var s=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,s},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function i(o){n.call(this,o)}e("../utils").inherits(i,n),i.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},i.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},i.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},i.prototype.readData=function(o){this.checkOffset(o);var s=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,s},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function i(o){n.call(this,o)}e("../utils").inherits(i,n),i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var s=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,s},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../support"),o=e("./ArrayReader"),s=e("./StringReader"),d=e("./NodeBufferReader"),k=e("./Uint8ArrayReader");t.exports=function(x){var b=n.getTypeOf(x);return n.checkSupport(b),b!=="string"||i.uint8array?b==="nodebuffer"?new d(x):i.uint8array?new k(n.transformTo("uint8array",x)):new o(n.transformTo("array",x)):new s(x)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../utils");function o(s){n.call(this,"ConvertWorker to "+s),this.destType=s}i.inherits(o,n),o.prototype.processChunk=function(s){this.push({data:i.transformTo(this.destType,s.data),meta:s.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,n),o.prototype.processChunk=function(s){this.streamInfo.crc32=i(s.data,this.streamInfo.crc32||0),this.push(s)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function o(s){i.call(this,"DataLengthProbe for "+s),this.propName=s,this.withStreamInfo(s,0)}n.inherits(o,i),o.prototype.processChunk=function(s){if(s){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+s.data.length}i.prototype.processChunk.call(this,s)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function o(s){i.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,s.then(function(k){d.dataIsReady=!0,d.data=k,d.max=k&&k.length||0,d.type=n.getTypeOf(k),d.isPaused||d._tickAndRepeat()},function(k){d.error(k)})}n.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var s=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":s=this.data.substring(this.index,d);break;case"uint8array":s=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":s=this.data.slice(this.index,d)}return this.index=d,this.push({data:s,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,o){return this._listeners[i].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,o){if(this._listeners[i])for(var s=0;s<this._listeners[i].length;s++)this._listeners[i][s].call(this,o)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var o=this;return i.on("data",function(s){o.processChunk(s)}),i.on("end",function(){o.end()}),i.on("error",function(s){o.error(s)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,o){return this.extraStreamInfo[i]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},t.exports=n},{}],29:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./ConvertWorker"),o=e("./GenericWorker"),s=e("../base64"),d=e("../support"),k=e("../external"),x=null;if(d.nodestream)try{x=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(g,c){return new k.Promise(function(m,p){var _=[],T=g._internalType,M=g._outputType,C=g._mimeType;g.on("data",function(W,P){_.push(W),c&&c(P)}).on("error",function(W){_=[],p(W)}).on("end",function(){try{var W=function(P,V,U){switch(P){case"blob":return n.newBlob(n.transformTo("arraybuffer",V),U);case"base64":return s.encode(V);default:return n.transformTo(P,V)}}(M,function(P,V){var U,K=0,ot=null,A=0;for(U=0;U<V.length;U++)A+=V[U].length;switch(P){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(ot=new Uint8Array(A),U=0;U<V.length;U++)ot.set(V[U],K),K+=V[U].length;return ot;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+P+"'")}}(T,_),C);m(W)}catch(P){p(P)}_=[]}).resume()})}function u(g,c,m){var p=c;switch(c){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=c,this._mimeType=m,n.checkSupport(p),this._worker=g.pipe(new i(p)),g.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}u.prototype={accumulate:function(g){return b(this,g)},on:function(g,c){var m=this;return g==="data"?this._worker.on(g,function(p){c.call(m,p.data,p.meta)}):this._worker.on(g,function(){n.delay(c,arguments,m)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new x(this,{objectMode:this._outputType!=="nodebuffer"},g)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=i.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){"use strict";for(var n=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),s=e("./stream/GenericWorker"),d=new Array(256),k=0;k<256;k++)d[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;d[254]=d[254]=1;function x(){s.call(this,"utf-8 decode"),this.leftOver=null}function b(){s.call(this,"utf-8 encode")}r.utf8encode=function(u){return i.nodebuffer?o.newBufferFrom(u,"utf-8"):function(g){var c,m,p,_,T,M=g.length,C=0;for(_=0;_<M;_++)(64512&(m=g.charCodeAt(_)))==55296&&_+1<M&&(64512&(p=g.charCodeAt(_+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),_++),C+=m<128?1:m<2048?2:m<65536?3:4;for(c=i.uint8array?new Uint8Array(C):new Array(C),_=T=0;T<C;_++)(64512&(m=g.charCodeAt(_)))==55296&&_+1<M&&(64512&(p=g.charCodeAt(_+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),_++),m<128?c[T++]=m:(m<2048?c[T++]=192|m>>>6:(m<65536?c[T++]=224|m>>>12:(c[T++]=240|m>>>18,c[T++]=128|m>>>12&63),c[T++]=128|m>>>6&63),c[T++]=128|63&m);return c}(u)},r.utf8decode=function(u){return i.nodebuffer?n.transformTo("nodebuffer",u).toString("utf-8"):function(g){var c,m,p,_,T=g.length,M=new Array(2*T);for(c=m=0;c<T;)if((p=g[c++])<128)M[m++]=p;else if(4<(_=d[p]))M[m++]=65533,c+=_-1;else{for(p&=_===2?31:_===3?15:7;1<_&&c<T;)p=p<<6|63&g[c++],_--;1<_?M[m++]=65533:p<65536?M[m++]=p:(p-=65536,M[m++]=55296|p>>10&1023,M[m++]=56320|1023&p)}return M.length!==m&&(M.subarray?M=M.subarray(0,m):M.length=m),n.applyFromCharCode(M)}(u=n.transformTo(i.uint8array?"uint8array":"array",u))},n.inherits(x,s),x.prototype.processChunk=function(u){var g=n.transformTo(i.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var c=g;(g=new Uint8Array(c.length+this.leftOver.length)).set(this.leftOver,0),g.set(c,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var m=function(_,T){var M;for((T=T||_.length)>_.length&&(T=_.length),M=T-1;0<=M&&(192&_[M])==128;)M--;return M<0||M===0?T:M+d[_[M]]>T?M:T}(g),p=g;m!==g.length&&(i.uint8array?(p=g.subarray(0,m),this.leftOver=g.subarray(m,g.length)):(p=g.slice(0,m),this.leftOver=g.slice(m,g.length))),this.push({data:r.utf8decode(p),meta:u.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=x,n.inherits(b,s),b.prototype.processChunk=function(u){this.push({data:r.utf8encode(u.data),meta:u.meta})},r.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var n=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),s=e("./external");function d(c){return c}function k(c,m){for(var p=0;p<c.length;++p)m[p]=255&c.charCodeAt(p);return m}e("setimmediate"),r.newBlob=function(c,m){r.checkSupport("blob");try{return new Blob([c],{type:m})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(c),p.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var x={stringifyByChunk:function(c,m,p){var _=[],T=0,M=c.length;if(M<=p)return String.fromCharCode.apply(null,c);for(;T<M;)m==="array"||m==="nodebuffer"?_.push(String.fromCharCode.apply(null,c.slice(T,Math.min(T+p,M)))):_.push(String.fromCharCode.apply(null,c.subarray(T,Math.min(T+p,M)))),T+=p;return _.join("")},stringifyByChar:function(c){for(var m="",p=0;p<c.length;p++)m+=String.fromCharCode(c[p]);return m},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function b(c){var m=65536,p=r.getTypeOf(c),_=!0;if(p==="uint8array"?_=x.applyCanBeUsed.uint8array:p==="nodebuffer"&&(_=x.applyCanBeUsed.nodebuffer),_)for(;1<m;)try{return x.stringifyByChunk(c,p,m)}catch{m=Math.floor(m/2)}return x.stringifyByChar(c)}function u(c,m){for(var p=0;p<c.length;p++)m[p]=c[p];return m}r.applyFromCharCode=b;var g={};g.string={string:d,array:function(c){return k(c,new Array(c.length))},arraybuffer:function(c){return g.string.uint8array(c).buffer},uint8array:function(c){return k(c,new Uint8Array(c.length))},nodebuffer:function(c){return k(c,o.allocBuffer(c.length))}},g.array={string:b,array:d,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return o.newBufferFrom(c)}},g.arraybuffer={string:function(c){return b(new Uint8Array(c))},array:function(c){return u(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:d,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return o.newBufferFrom(new Uint8Array(c))}},g.uint8array={string:b,array:function(c){return u(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:d,nodebuffer:function(c){return o.newBufferFrom(c)}},g.nodebuffer={string:b,array:function(c){return u(c,new Array(c.length))},arraybuffer:function(c){return g.nodebuffer.uint8array(c).buffer},uint8array:function(c){return u(c,new Uint8Array(c.length))},nodebuffer:d},r.transformTo=function(c,m){if(m=m||"",!c)return m;r.checkSupport(c);var p=r.getTypeOf(m);return g[p][c](m)},r.resolve=function(c){for(var m=c.split("/"),p=[],_=0;_<m.length;_++){var T=m[_];T==="."||T===""&&_!==0&&_!==m.length-1||(T===".."?p.pop():p.push(T))}return p.join("/")},r.getTypeOf=function(c){return typeof c=="string"?"string":Object.prototype.toString.call(c)==="[object Array]"?"array":n.nodebuffer&&o.isBuffer(c)?"nodebuffer":n.uint8array&&c instanceof Uint8Array?"uint8array":n.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(c){if(!n[c.toLowerCase()])throw new Error(c+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(c){var m,p,_="";for(p=0;p<(c||"").length;p++)_+="\\x"+((m=c.charCodeAt(p))<16?"0":"")+m.toString(16).toUpperCase();return _},r.delay=function(c,m,p){setImmediate(function(){c.apply(p||null,m||[])})},r.inherits=function(c,m){function p(){}p.prototype=m.prototype,c.prototype=new p},r.extend=function(){var c,m,p={};for(c=0;c<arguments.length;c++)for(m in arguments[c])Object.prototype.hasOwnProperty.call(arguments[c],m)&&p[m]===void 0&&(p[m]=arguments[c][m]);return p},r.prepareContent=function(c,m,p,_,T){return s.Promise.resolve(m).then(function(M){return n.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new s.Promise(function(C,W){var P=new FileReader;P.onload=function(V){C(V.target.result)},P.onerror=function(V){W(V.target.error)},P.readAsArrayBuffer(M)}):M}).then(function(M){var C=r.getTypeOf(M);return C?(C==="arraybuffer"?M=r.transformTo("uint8array",M):C==="string"&&(T?M=i.decode(M):p&&_!==!0&&(M=function(W){return k(W,n.uint8array?new Uint8Array(W.length):new Array(W.length))}(M))),M):s.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),s=e("./zipEntry"),d=e("./support");function k(x){this.files=[],this.loadOptions=x}k.prototype={checkSignature:function(x){if(!this.reader.readAndCheckSignature(x)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(b)+", expected "+i.pretty(x)+")")}},isSignature:function(x,b){var u=this.reader.index;this.reader.setIndex(x);var g=this.reader.readString(4)===b;return this.reader.setIndex(u),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var x=this.reader.readData(this.zipCommentLength),b=d.uint8array?"uint8array":"array",u=i.transformTo(b,x);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var x,b,u,g=this.zip64EndOfCentralSize-44;0<g;)x=this.reader.readInt(2),b=this.reader.readInt(4),u=this.reader.readData(b),this.zip64ExtensibleData[x]={id:x,length:b,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var x,b;for(x=0;x<this.files.length;x++)b=this.files[x],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var x;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(x=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(x);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var x=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(x<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(x);var b=x;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(x=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(x),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var g=b-u;if(0<g)this.isSignature(b,o.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(x){this.reader=n(x)},load:function(x){this.prepareReader(x),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=k},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),s=e("./crc32"),d=e("./utf8"),k=e("./compressions"),x=e("./support");function b(u,g){this.options=u,this.loadOptions=g}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var g,c;if(u.skip(22),this.fileNameLength=u.readInt(2),c=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(m){for(var p in k)if(Object.prototype.hasOwnProperty.call(k,p)&&k[p].magic===m)return k[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,g,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var g=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(g),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var g,c,m,p=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<p;)g=u.readInt(2),c=u.readInt(2),m=u.readData(c),this.extraFields[g]={id:g,length:c,value:m};u.setIndex(p)},handleUTF8:function(){var u=x.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var c=i.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var p=i.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var g=n(u.value);return g.readInt(1)!==1||s(this.fileName)!==g.readInt(4)?null:d.utf8decode(g.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var g=n(u.value);return g.readInt(1)!==1||s(this.fileComment)!==g.readInt(4)?null:d.utf8decode(g.readData(u.length-5))}return null}},t.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function n(g,c,m){this.name=g,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=c,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var i=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),s=e("./utf8"),d=e("./compressedObject"),k=e("./stream/GenericWorker");n.prototype={internalStream:function(g){var c=null,m="string";try{if(!g)throw new Error("No output type specified.");var p=(m=g.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),c=this._decompressWorker();var _=!this._dataBinary;_&&!p&&(c=c.pipe(new s.Utf8EncodeWorker)),!_&&p&&(c=c.pipe(new s.Utf8DecodeWorker))}catch(T){(c=new k("error")).error(T)}return new i(c,m,"")},async:function(g,c){return this.internalStream(g).accumulate(c)},nodeStream:function(g,c){return this.internalStream(g||"nodebuffer").toNodejsStream(c)},_compressWorker:function(g,c){if(this._data instanceof d&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new s.Utf8EncodeWorker)),d.createWorkerFrom(m,g,c)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof k?this._data:new o(this._data)}};for(var x=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<x.length;u++)n.prototype[x[u]]=b;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(n){"use strict";var i,o,s=n.MutationObserver||n.WebKitMutationObserver;if(s){var d=0,k=new s(g),x=n.document.createTextNode("");k.observe(x,{characterData:!0}),i=function(){x.data=d=++d%2}}else if(n.setImmediate||n.MessageChannel===void 0)i="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var c=n.document.createElement("script");c.onreadystatechange=function(){g(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},n.document.documentElement.appendChild(c)}:function(){setTimeout(g,0)};else{var b=new n.MessageChannel;b.port1.onmessage=g,i=function(){b.port2.postMessage(0)}}var u=[];function g(){var c,m;o=!0;for(var p=u.length;p;){for(m=u,u=[],c=-1;++c<p;)m[c]();p=u.length}o=!1}t.exports=function(c){u.push(c)!==1||o||i()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,t,r){"use strict";var n=e("immediate");function i(){}var o={},s=["REJECTED"],d=["FULFILLED"],k=["PENDING"];function x(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=k,this.queue=[],this.outcome=void 0,p!==i&&c(this,p)}function b(p,_,T){this.promise=p,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function u(p,_,T){n(function(){var M;try{M=_(T)}catch(C){return o.reject(p,C)}M===p?o.reject(p,new TypeError("Cannot resolve promise with itself")):o.resolve(p,M)})}function g(p){var _=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof _=="function")return function(){_.apply(p,arguments)}}function c(p,_){var T=!1;function M(P){T||(T=!0,o.reject(p,P))}function C(P){T||(T=!0,o.resolve(p,P))}var W=m(function(){_(C,M)});W.status==="error"&&M(W.value)}function m(p,_){var T={};try{T.value=p(_),T.status="success"}catch(M){T.status="error",T.value=M}return T}(t.exports=x).prototype.finally=function(p){if(typeof p!="function")return this;var _=this.constructor;return this.then(function(T){return _.resolve(p()).then(function(){return T})},function(T){return _.resolve(p()).then(function(){throw T})})},x.prototype.catch=function(p){return this.then(null,p)},x.prototype.then=function(p,_){if(typeof p!="function"&&this.state===d||typeof _!="function"&&this.state===s)return this;var T=new this.constructor(i);return this.state!==k?u(T,this.state===d?p:_,this.outcome):this.queue.push(new b(T,p,_)),T},b.prototype.callFulfilled=function(p){o.resolve(this.promise,p)},b.prototype.otherCallFulfilled=function(p){u(this.promise,this.onFulfilled,p)},b.prototype.callRejected=function(p){o.reject(this.promise,p)},b.prototype.otherCallRejected=function(p){u(this.promise,this.onRejected,p)},o.resolve=function(p,_){var T=m(g,_);if(T.status==="error")return o.reject(p,T.value);var M=T.value;if(M)c(p,M);else{p.state=d,p.outcome=_;for(var C=-1,W=p.queue.length;++C<W;)p.queue[C].callFulfilled(_)}return p},o.reject=function(p,_){p.state=s,p.outcome=_;for(var T=-1,M=p.queue.length;++T<M;)p.queue[T].callRejected(_);return p},x.resolve=function(p){return p instanceof this?p:o.resolve(new this(i),p)},x.reject=function(p){var _=new this(i);return o.reject(_,p)},x.all=function(p){var _=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=p.length,M=!1;if(!T)return this.resolve([]);for(var C=new Array(T),W=0,P=-1,V=new this(i);++P<T;)U(p[P],P);return V;function U(K,ot){_.resolve(K).then(function(A){C[ot]=A,++W!==T||M||(M=!0,o.resolve(V,C))},function(A){M||(M=!0,o.reject(V,A))})}},x.race=function(p){var _=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=p.length,M=!1;if(!T)return this.resolve([]);for(var C=-1,W=new this(i);++C<T;)P=p[C],_.resolve(P).then(function(V){M||(M=!0,o.resolve(W,V))},function(V){M||(M=!0,o.reject(W,V))});var P;return W}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var n=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/messages"),d=e("./zlib/zstream"),k=Object.prototype.toString,x=0,b=-1,u=0,g=8;function c(p){if(!(this instanceof c))return new c(p);this.options=i.assign({level:b,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},p||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var T=n.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(T!==x)throw new Error(s[T]);if(_.header&&n.deflateSetHeader(this.strm,_.header),_.dictionary){var M;if(M=typeof _.dictionary=="string"?o.string2buf(_.dictionary):k.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(T=n.deflateSetDictionary(this.strm,M))!==x)throw new Error(s[T]);this._dict_set=!0}}function m(p,_){var T=new c(_);if(T.push(p,!0),T.err)throw T.msg||s[T.err];return T.result}c.prototype.push=function(p,_){var T,M,C=this.strm,W=this.options.chunkSize;if(this.ended)return!1;M=_===~~_?_:_===!0?4:0,typeof p=="string"?C.input=o.string2buf(p):k.call(p)==="[object ArrayBuffer]"?C.input=new Uint8Array(p):C.input=p,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new i.Buf8(W),C.next_out=0,C.avail_out=W),(T=n.deflate(C,M))!==1&&T!==x)return this.onEnd(T),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(i.shrinkBuf(C.output,C.next_out))):this.onData(i.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&T!==1);return M===4?(T=n.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===x):M!==2||(this.onEnd(x),!(C.avail_out=0))},c.prototype.onData=function(p){this.chunks.push(p)},c.prototype.onEnd=function(p){p===x&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},r.Deflate=c,r.deflate=m,r.deflateRaw=function(p,_){return(_=_||{}).raw=!0,m(p,_)},r.gzip=function(p,_){return(_=_||{}).gzip=!0,m(p,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var n=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/constants"),d=e("./zlib/messages"),k=e("./zlib/zstream"),x=e("./zlib/gzheader"),b=Object.prototype.toString;function u(c){if(!(this instanceof u))return new u(c);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},c||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||c&&c.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var p=n.inflateInit2(this.strm,m.windowBits);if(p!==s.Z_OK)throw new Error(d[p]);this.header=new x,n.inflateGetHeader(this.strm,this.header)}function g(c,m){var p=new u(m);if(p.push(c,!0),p.err)throw p.msg||d[p.err];return p.result}u.prototype.push=function(c,m){var p,_,T,M,C,W,P=this.strm,V=this.options.chunkSize,U=this.options.dictionary,K=!1;if(this.ended)return!1;_=m===~~m?m:m===!0?s.Z_FINISH:s.Z_NO_FLUSH,typeof c=="string"?P.input=o.binstring2buf(c):b.call(c)==="[object ArrayBuffer]"?P.input=new Uint8Array(c):P.input=c,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new i.Buf8(V),P.next_out=0,P.avail_out=V),(p=n.inflate(P,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&U&&(W=typeof U=="string"?o.string2buf(U):b.call(U)==="[object ArrayBuffer]"?new Uint8Array(U):U,p=n.inflateSetDictionary(this.strm,W)),p===s.Z_BUF_ERROR&&K===!0&&(p=s.Z_OK,K=!1),p!==s.Z_STREAM_END&&p!==s.Z_OK)return this.onEnd(p),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&p!==s.Z_STREAM_END&&(P.avail_in!==0||_!==s.Z_FINISH&&_!==s.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=o.utf8border(P.output,P.next_out),M=P.next_out-T,C=o.buf2string(P.output,T),P.next_out=M,P.avail_out=V-M,M&&i.arraySet(P.output,P.output,T,M,0),this.onData(C)):this.onData(i.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(K=!0)}while((0<P.avail_in||P.avail_out===0)&&p!==s.Z_STREAM_END);return p===s.Z_STREAM_END&&(_=s.Z_FINISH),_===s.Z_FINISH?(p=n.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===s.Z_OK):_!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(P.avail_out=0))},u.prototype.onData=function(c){this.chunks.push(c)},u.prototype.onEnd=function(c){c===s.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},r.Inflate=u,r.inflate=g,r.inflateRaw=function(c,m){return(m=m||{}).raw=!0,g(c,m)},r.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(s){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var k=d.shift();if(k){if(typeof k!="object")throw new TypeError(k+"must be non-object");for(var x in k)k.hasOwnProperty(x)&&(s[x]=k[x])}}return s},r.shrinkBuf=function(s,d){return s.length===d?s:s.subarray?s.subarray(0,d):(s.length=d,s)};var i={arraySet:function(s,d,k,x,b){if(d.subarray&&s.subarray)s.set(d.subarray(k,k+x),b);else for(var u=0;u<x;u++)s[b+u]=d[k+u]},flattenChunks:function(s){var d,k,x,b,u,g;for(d=x=0,k=s.length;d<k;d++)x+=s[d].length;for(g=new Uint8Array(x),d=b=0,k=s.length;d<k;d++)u=s[d],g.set(u,b),b+=u.length;return g}},o={arraySet:function(s,d,k,x,b){for(var u=0;u<x;u++)s[b+u]=d[k+u]},flattenChunks:function(s){return[].concat.apply([],s)}};r.setTyped=function(s){s?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(e,t,r){"use strict";var n=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var s=new n.Buf8(256),d=0;d<256;d++)s[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function k(x,b){if(b<65537&&(x.subarray&&o||!x.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(x,b));for(var u="",g=0;g<b;g++)u+=String.fromCharCode(x[g]);return u}s[254]=s[254]=1,r.string2buf=function(x){var b,u,g,c,m,p=x.length,_=0;for(c=0;c<p;c++)(64512&(u=x.charCodeAt(c)))==55296&&c+1<p&&(64512&(g=x.charCodeAt(c+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),c++),_+=u<128?1:u<2048?2:u<65536?3:4;for(b=new n.Buf8(_),c=m=0;m<_;c++)(64512&(u=x.charCodeAt(c)))==55296&&c+1<p&&(64512&(g=x.charCodeAt(c+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),c++),u<128?b[m++]=u:(u<2048?b[m++]=192|u>>>6:(u<65536?b[m++]=224|u>>>12:(b[m++]=240|u>>>18,b[m++]=128|u>>>12&63),b[m++]=128|u>>>6&63),b[m++]=128|63&u);return b},r.buf2binstring=function(x){return k(x,x.length)},r.binstring2buf=function(x){for(var b=new n.Buf8(x.length),u=0,g=b.length;u<g;u++)b[u]=x.charCodeAt(u);return b},r.buf2string=function(x,b){var u,g,c,m,p=b||x.length,_=new Array(2*p);for(u=g=0;u<p;)if((c=x[u++])<128)_[g++]=c;else if(4<(m=s[c]))_[g++]=65533,u+=m-1;else{for(c&=m===2?31:m===3?15:7;1<m&&u<p;)c=c<<6|63&x[u++],m--;1<m?_[g++]=65533:c<65536?_[g++]=c:(c-=65536,_[g++]=55296|c>>10&1023,_[g++]=56320|1023&c)}return k(_,g)},r.utf8border=function(x,b){var u;for((b=b||x.length)>x.length&&(b=x.length),u=b-1;0<=u&&(192&x[u])==128;)u--;return u<0||u===0?b:u+s[x[u]]>b?u:b}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(n,i,o,s){for(var d=65535&n|0,k=n>>>16&65535|0,x=0;o!==0;){for(o-=x=2e3<o?2e3:o;k=k+(d=d+i[s++]|0)|0,--x;);d%=65521,k%=65521}return d|k<<16|0}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var n=function(){for(var i,o=[],s=0;s<256;s++){i=s;for(var d=0;d<8;d++)i=1&i?3988292384^i>>>1:i>>>1;o[s]=i}return o}();t.exports=function(i,o,s,d){var k=n,x=d+s;i^=-1;for(var b=d;b<x;b++)i=i>>>8^k[255&(i^o[b])];return-1^i}},{}],46:[function(e,t,r){"use strict";var n,i=e("../utils/common"),o=e("./trees"),s=e("./adler32"),d=e("./crc32"),k=e("./messages"),x=0,b=4,u=0,g=-2,c=-1,m=4,p=2,_=8,T=9,M=286,C=30,W=19,P=2*M+1,V=15,U=3,K=258,ot=K+U+1,A=42,N=113,f=1,G=2,ut=3,H=4;function E(a,B){return a.msg=k[B],B}function h(a){return(a<<1)-(4<a?9:0)}function S(a){for(var B=a.length;0<=--B;)a[B]=0}function w(a){var B=a.state,F=B.pending;F>a.avail_out&&(F=a.avail_out),F!==0&&(i.arraySet(a.output,B.pending_buf,B.pending_out,F,a.next_out),a.next_out+=F,B.pending_out+=F,a.total_out+=F,a.avail_out-=F,B.pending-=F,B.pending===0&&(B.pending_out=0))}function l(a,B){o._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,B),a.block_start=a.strstart,w(a.strm)}function z(a,B){a.pending_buf[a.pending++]=B}function R(a,B){a.pending_buf[a.pending++]=B>>>8&255,a.pending_buf[a.pending++]=255&B}function O(a,B){var F,y,v=a.max_chain_length,I=a.strstart,D=a.prev_length,j=a.nice_match,L=a.strstart>a.w_size-ot?a.strstart-(a.w_size-ot):0,Z=a.window,$=a.w_mask,q=a.prev,nt=a.strstart+K,mt=Z[I+D-1],dt=Z[I+D];a.prev_length>=a.good_match&&(v>>=2),j>a.lookahead&&(j=a.lookahead);do if(Z[(F=B)+D]===dt&&Z[F+D-1]===mt&&Z[F]===Z[I]&&Z[++F]===Z[I+1]){I+=2,F++;do;while(Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&Z[++I]===Z[++F]&&I<nt);if(y=K-(nt-I),I=nt-K,D<y){if(a.match_start=B,j<=(D=y))break;mt=Z[I+D-1],dt=Z[I+D]}}while((B=q[B&$])>L&&--v!=0);return D<=a.lookahead?D:a.lookahead}function Y(a){var B,F,y,v,I,D,j,L,Z,$,q=a.w_size;do{if(v=a.window_size-a.lookahead-a.strstart,a.strstart>=q+(q-ot)){for(i.arraySet(a.window,a.window,q,q,0),a.match_start-=q,a.strstart-=q,a.block_start-=q,B=F=a.hash_size;y=a.head[--B],a.head[B]=q<=y?y-q:0,--F;);for(B=F=q;y=a.prev[--B],a.prev[B]=q<=y?y-q:0,--F;);v+=q}if(a.strm.avail_in===0)break;if(D=a.strm,j=a.window,L=a.strstart+a.lookahead,Z=v,$=void 0,$=D.avail_in,Z<$&&($=Z),F=$===0?0:(D.avail_in-=$,i.arraySet(j,D.input,D.next_in,$,L),D.state.wrap===1?D.adler=s(D.adler,j,$,L):D.state.wrap===2&&(D.adler=d(D.adler,j,$,L)),D.next_in+=$,D.total_in+=$,$),a.lookahead+=F,a.lookahead+a.insert>=U)for(I=a.strstart-a.insert,a.ins_h=a.window[I],a.ins_h=(a.ins_h<<a.hash_shift^a.window[I+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[I+U-1])&a.hash_mask,a.prev[I&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=I,I++,a.insert--,!(a.lookahead+a.insert<U)););}while(a.lookahead<ot&&a.strm.avail_in!==0)}function J(a,B){for(var F,y;;){if(a.lookahead<ot){if(Y(a),a.lookahead<ot&&B===x)return f;if(a.lookahead===0)break}if(F=0,a.lookahead>=U&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+U-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),F!==0&&a.strstart-F<=a.w_size-ot&&(a.match_length=O(a,F)),a.match_length>=U)if(y=o._tr_tally(a,a.strstart-a.match_start,a.match_length-U),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=U){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+U-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else y=o._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(y&&(l(a,!1),a.strm.avail_out===0))return f}return a.insert=a.strstart<U-1?a.strstart:U-1,B===b?(l(a,!0),a.strm.avail_out===0?ut:H):a.last_lit&&(l(a,!1),a.strm.avail_out===0)?f:G}function X(a,B){for(var F,y,v;;){if(a.lookahead<ot){if(Y(a),a.lookahead<ot&&B===x)return f;if(a.lookahead===0)break}if(F=0,a.lookahead>=U&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+U-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=U-1,F!==0&&a.prev_length<a.max_lazy_match&&a.strstart-F<=a.w_size-ot&&(a.match_length=O(a,F),a.match_length<=5&&(a.strategy===1||a.match_length===U&&4096<a.strstart-a.match_start)&&(a.match_length=U-1)),a.prev_length>=U&&a.match_length<=a.prev_length){for(v=a.strstart+a.lookahead-U,y=o._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-U),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=v&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+U-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=U-1,a.strstart++,y&&(l(a,!1),a.strm.avail_out===0))return f}else if(a.match_available){if((y=o._tr_tally(a,0,a.window[a.strstart-1]))&&l(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return f}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(y=o._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<U-1?a.strstart:U-1,B===b?(l(a,!0),a.strm.avail_out===0?ut:H):a.last_lit&&(l(a,!1),a.strm.avail_out===0)?f:G}function et(a,B,F,y,v){this.good_length=a,this.max_lazy=B,this.nice_length=F,this.max_chain=y,this.func=v}function Q(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*P),this.dyn_dtree=new i.Buf16(2*(2*C+1)),this.bl_tree=new i.Buf16(2*(2*W+1)),S(this.dyn_ltree),S(this.dyn_dtree),S(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(V+1),this.heap=new i.Buf16(2*M+1),S(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*M+1),S(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tt(a){var B;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=p,(B=a.state).pending=0,B.pending_out=0,B.wrap<0&&(B.wrap=-B.wrap),B.status=B.wrap?A:N,a.adler=B.wrap===2?0:1,B.last_flush=x,o._tr_init(B),u):E(a,g)}function lt(a){var B=tt(a);return B===u&&function(F){F.window_size=2*F.w_size,S(F.head),F.max_lazy_match=n[F.level].max_lazy,F.good_match=n[F.level].good_length,F.nice_match=n[F.level].nice_length,F.max_chain_length=n[F.level].max_chain,F.strstart=0,F.block_start=0,F.lookahead=0,F.insert=0,F.match_length=F.prev_length=U-1,F.match_available=0,F.ins_h=0}(a.state),B}function gt(a,B,F,y,v,I){if(!a)return g;var D=1;if(B===c&&(B=6),y<0?(D=0,y=-y):15<y&&(D=2,y-=16),v<1||T<v||F!==_||y<8||15<y||B<0||9<B||I<0||m<I)return E(a,g);y===8&&(y=9);var j=new Q;return(a.state=j).strm=a,j.wrap=D,j.gzhead=null,j.w_bits=y,j.w_size=1<<j.w_bits,j.w_mask=j.w_size-1,j.hash_bits=v+7,j.hash_size=1<<j.hash_bits,j.hash_mask=j.hash_size-1,j.hash_shift=~~((j.hash_bits+U-1)/U),j.window=new i.Buf8(2*j.w_size),j.head=new i.Buf16(j.hash_size),j.prev=new i.Buf16(j.w_size),j.lit_bufsize=1<<v+6,j.pending_buf_size=4*j.lit_bufsize,j.pending_buf=new i.Buf8(j.pending_buf_size),j.d_buf=1*j.lit_bufsize,j.l_buf=3*j.lit_bufsize,j.level=B,j.strategy=I,j.method=F,lt(a)}n=[new et(0,0,0,0,function(a,B){var F=65535;for(F>a.pending_buf_size-5&&(F=a.pending_buf_size-5);;){if(a.lookahead<=1){if(Y(a),a.lookahead===0&&B===x)return f;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var y=a.block_start+F;if((a.strstart===0||a.strstart>=y)&&(a.lookahead=a.strstart-y,a.strstart=y,l(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-ot&&(l(a,!1),a.strm.avail_out===0))return f}return a.insert=0,B===b?(l(a,!0),a.strm.avail_out===0?ut:H):(a.strstart>a.block_start&&(l(a,!1),a.strm.avail_out),f)}),new et(4,4,8,4,J),new et(4,5,16,8,J),new et(4,6,32,32,J),new et(4,4,16,16,X),new et(8,16,32,32,X),new et(8,16,128,128,X),new et(8,32,128,256,X),new et(32,128,258,1024,X),new et(32,258,258,4096,X)],r.deflateInit=function(a,B){return gt(a,B,_,15,8,0)},r.deflateInit2=gt,r.deflateReset=lt,r.deflateResetKeep=tt,r.deflateSetHeader=function(a,B){return a&&a.state?a.state.wrap!==2?g:(a.state.gzhead=B,u):g},r.deflate=function(a,B){var F,y,v,I;if(!a||!a.state||5<B||B<0)return a?E(a,g):g;if(y=a.state,!a.output||!a.input&&a.avail_in!==0||y.status===666&&B!==b)return E(a,a.avail_out===0?-5:g);if(y.strm=a,F=y.last_flush,y.last_flush=B,y.status===A)if(y.wrap===2)a.adler=0,z(y,31),z(y,139),z(y,8),y.gzhead?(z(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),z(y,255&y.gzhead.time),z(y,y.gzhead.time>>8&255),z(y,y.gzhead.time>>16&255),z(y,y.gzhead.time>>24&255),z(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),z(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(z(y,255&y.gzhead.extra.length),z(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(a.adler=d(a.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69):(z(y,0),z(y,0),z(y,0),z(y,0),z(y,0),z(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),z(y,3),y.status=N);else{var D=_+(y.w_bits-8<<4)<<8;D|=(2<=y.strategy||y.level<2?0:y.level<6?1:y.level===6?2:3)<<6,y.strstart!==0&&(D|=32),D+=31-D%31,y.status=N,R(y,D),y.strstart!==0&&(R(y,a.adler>>>16),R(y,65535&a.adler)),a.adler=1}if(y.status===69)if(y.gzhead.extra){for(v=y.pending;y.gzindex<(65535&y.gzhead.extra.length)&&(y.pending!==y.pending_buf_size||(y.gzhead.hcrc&&y.pending>v&&(a.adler=d(a.adler,y.pending_buf,y.pending-v,v)),w(a),v=y.pending,y.pending!==y.pending_buf_size));)z(y,255&y.gzhead.extra[y.gzindex]),y.gzindex++;y.gzhead.hcrc&&y.pending>v&&(a.adler=d(a.adler,y.pending_buf,y.pending-v,v)),y.gzindex===y.gzhead.extra.length&&(y.gzindex=0,y.status=73)}else y.status=73;if(y.status===73)if(y.gzhead.name){v=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>v&&(a.adler=d(a.adler,y.pending_buf,y.pending-v,v)),w(a),v=y.pending,y.pending===y.pending_buf_size)){I=1;break}I=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,z(y,I)}while(I!==0);y.gzhead.hcrc&&y.pending>v&&(a.adler=d(a.adler,y.pending_buf,y.pending-v,v)),I===0&&(y.gzindex=0,y.status=91)}else y.status=91;if(y.status===91)if(y.gzhead.comment){v=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>v&&(a.adler=d(a.adler,y.pending_buf,y.pending-v,v)),w(a),v=y.pending,y.pending===y.pending_buf_size)){I=1;break}I=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,z(y,I)}while(I!==0);y.gzhead.hcrc&&y.pending>v&&(a.adler=d(a.adler,y.pending_buf,y.pending-v,v)),I===0&&(y.status=103)}else y.status=103;if(y.status===103&&(y.gzhead.hcrc?(y.pending+2>y.pending_buf_size&&w(a),y.pending+2<=y.pending_buf_size&&(z(y,255&a.adler),z(y,a.adler>>8&255),a.adler=0,y.status=N)):y.status=N),y.pending!==0){if(w(a),a.avail_out===0)return y.last_flush=-1,u}else if(a.avail_in===0&&h(B)<=h(F)&&B!==b)return E(a,-5);if(y.status===666&&a.avail_in!==0)return E(a,-5);if(a.avail_in!==0||y.lookahead!==0||B!==x&&y.status!==666){var j=y.strategy===2?function(L,Z){for(var $;;){if(L.lookahead===0&&(Y(L),L.lookahead===0)){if(Z===x)return f;break}if(L.match_length=0,$=o._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,$&&(l(L,!1),L.strm.avail_out===0))return f}return L.insert=0,Z===b?(l(L,!0),L.strm.avail_out===0?ut:H):L.last_lit&&(l(L,!1),L.strm.avail_out===0)?f:G}(y,B):y.strategy===3?function(L,Z){for(var $,q,nt,mt,dt=L.window;;){if(L.lookahead<=K){if(Y(L),L.lookahead<=K&&Z===x)return f;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=U&&0<L.strstart&&(q=dt[nt=L.strstart-1])===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]){mt=L.strstart+K;do;while(q===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]&&q===dt[++nt]&&nt<mt);L.match_length=K-(mt-nt),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=U?($=o._tr_tally(L,1,L.match_length-U),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):($=o._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),$&&(l(L,!1),L.strm.avail_out===0))return f}return L.insert=0,Z===b?(l(L,!0),L.strm.avail_out===0?ut:H):L.last_lit&&(l(L,!1),L.strm.avail_out===0)?f:G}(y,B):n[y.level].func(y,B);if(j!==ut&&j!==H||(y.status=666),j===f||j===ut)return a.avail_out===0&&(y.last_flush=-1),u;if(j===G&&(B===1?o._tr_align(y):B!==5&&(o._tr_stored_block(y,0,0,!1),B===3&&(S(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),w(a),a.avail_out===0))return y.last_flush=-1,u}return B!==b?u:y.wrap<=0?1:(y.wrap===2?(z(y,255&a.adler),z(y,a.adler>>8&255),z(y,a.adler>>16&255),z(y,a.adler>>24&255),z(y,255&a.total_in),z(y,a.total_in>>8&255),z(y,a.total_in>>16&255),z(y,a.total_in>>24&255)):(R(y,a.adler>>>16),R(y,65535&a.adler)),w(a),0<y.wrap&&(y.wrap=-y.wrap),y.pending!==0?u:1)},r.deflateEnd=function(a){var B;return a&&a.state?(B=a.state.status)!==A&&B!==69&&B!==73&&B!==91&&B!==103&&B!==N&&B!==666?E(a,g):(a.state=null,B===N?E(a,-3):u):g},r.deflateSetDictionary=function(a,B){var F,y,v,I,D,j,L,Z,$=B.length;if(!a||!a.state||(I=(F=a.state).wrap)===2||I===1&&F.status!==A||F.lookahead)return g;for(I===1&&(a.adler=s(a.adler,B,$,0)),F.wrap=0,$>=F.w_size&&(I===0&&(S(F.head),F.strstart=0,F.block_start=0,F.insert=0),Z=new i.Buf8(F.w_size),i.arraySet(Z,B,$-F.w_size,F.w_size,0),B=Z,$=F.w_size),D=a.avail_in,j=a.next_in,L=a.input,a.avail_in=$,a.next_in=0,a.input=B,Y(F);F.lookahead>=U;){for(y=F.strstart,v=F.lookahead-(U-1);F.ins_h=(F.ins_h<<F.hash_shift^F.window[y+U-1])&F.hash_mask,F.prev[y&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=y,y++,--v;);F.strstart=y,F.lookahead=U-1,Y(F)}return F.strstart+=F.lookahead,F.block_start=F.strstart,F.insert=F.lookahead,F.lookahead=0,F.match_length=F.prev_length=U-1,F.match_available=0,a.next_in=j,a.input=L,a.avail_in=D,F.wrap=I,u},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(n,i){var o,s,d,k,x,b,u,g,c,m,p,_,T,M,C,W,P,V,U,K,ot,A,N,f,G;o=n.state,s=n.next_in,f=n.input,d=s+(n.avail_in-5),k=n.next_out,G=n.output,x=k-(i-n.avail_out),b=k+(n.avail_out-257),u=o.dmax,g=o.wsize,c=o.whave,m=o.wnext,p=o.window,_=o.hold,T=o.bits,M=o.lencode,C=o.distcode,W=(1<<o.lenbits)-1,P=(1<<o.distbits)-1;t:do{T<15&&(_+=f[s++]<<T,T+=8,_+=f[s++]<<T,T+=8),V=M[_&W];e:for(;;){if(_>>>=U=V>>>24,T-=U,(U=V>>>16&255)===0)G[k++]=65535&V;else{if(!(16&U)){if(!(64&U)){V=M[(65535&V)+(_&(1<<U)-1)];continue e}if(32&U){o.mode=12;break t}n.msg="invalid literal/length code",o.mode=30;break t}K=65535&V,(U&=15)&&(T<U&&(_+=f[s++]<<T,T+=8),K+=_&(1<<U)-1,_>>>=U,T-=U),T<15&&(_+=f[s++]<<T,T+=8,_+=f[s++]<<T,T+=8),V=C[_&P];r:for(;;){if(_>>>=U=V>>>24,T-=U,!(16&(U=V>>>16&255))){if(!(64&U)){V=C[(65535&V)+(_&(1<<U)-1)];continue r}n.msg="invalid distance code",o.mode=30;break t}if(ot=65535&V,T<(U&=15)&&(_+=f[s++]<<T,(T+=8)<U&&(_+=f[s++]<<T,T+=8)),u<(ot+=_&(1<<U)-1)){n.msg="invalid distance too far back",o.mode=30;break t}if(_>>>=U,T-=U,(U=k-x)<ot){if(c<(U=ot-U)&&o.sane){n.msg="invalid distance too far back",o.mode=30;break t}if(N=p,(A=0)===m){if(A+=g-U,U<K){for(K-=U;G[k++]=p[A++],--U;);A=k-ot,N=G}}else if(m<U){if(A+=g+m-U,(U-=m)<K){for(K-=U;G[k++]=p[A++],--U;);if(A=0,m<K){for(K-=U=m;G[k++]=p[A++],--U;);A=k-ot,N=G}}}else if(A+=m-U,U<K){for(K-=U;G[k++]=p[A++],--U;);A=k-ot,N=G}for(;2<K;)G[k++]=N[A++],G[k++]=N[A++],G[k++]=N[A++],K-=3;K&&(G[k++]=N[A++],1<K&&(G[k++]=N[A++]))}else{for(A=k-ot;G[k++]=G[A++],G[k++]=G[A++],G[k++]=G[A++],2<(K-=3););K&&(G[k++]=G[A++],1<K&&(G[k++]=G[A++]))}break}}break}}while(s<d&&k<b);s-=K=T>>3,_&=(1<<(T-=K<<3))-1,n.next_in=s,n.next_out=k,n.avail_in=s<d?d-s+5:5-(s-d),n.avail_out=k<b?b-k+257:257-(k-b),o.hold=_,o.bits=T}},{}],49:[function(e,t,r){"use strict";var n=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),s=e("./inffast"),d=e("./inftrees"),k=1,x=2,b=0,u=-2,g=1,c=852,m=592;function p(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(A){var N;return A&&A.state?(N=A.state,A.total_in=A.total_out=N.total=0,A.msg="",N.wrap&&(A.adler=1&N.wrap),N.mode=g,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new n.Buf32(c),N.distcode=N.distdyn=new n.Buf32(m),N.sane=1,N.back=-1,b):u}function M(A){var N;return A&&A.state?((N=A.state).wsize=0,N.whave=0,N.wnext=0,T(A)):u}function C(A,N){var f,G;return A&&A.state?(G=A.state,N<0?(f=0,N=-N):(f=1+(N>>4),N<48&&(N&=15)),N&&(N<8||15<N)?u:(G.window!==null&&G.wbits!==N&&(G.window=null),G.wrap=f,G.wbits=N,M(A))):u}function W(A,N){var f,G;return A?(G=new _,(A.state=G).window=null,(f=C(A,N))!==b&&(A.state=null),f):u}var P,V,U=!0;function K(A){if(U){var N;for(P=new n.Buf32(512),V=new n.Buf32(32),N=0;N<144;)A.lens[N++]=8;for(;N<256;)A.lens[N++]=9;for(;N<280;)A.lens[N++]=7;for(;N<288;)A.lens[N++]=8;for(d(k,A.lens,0,288,P,0,A.work,{bits:9}),N=0;N<32;)A.lens[N++]=5;d(x,A.lens,0,32,V,0,A.work,{bits:5}),U=!1}A.lencode=P,A.lenbits=9,A.distcode=V,A.distbits=5}function ot(A,N,f,G){var ut,H=A.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new n.Buf8(H.wsize)),G>=H.wsize?(n.arraySet(H.window,N,f-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(G<(ut=H.wsize-H.wnext)&&(ut=G),n.arraySet(H.window,N,f-G,ut,H.wnext),(G-=ut)?(n.arraySet(H.window,N,f-G,G,0),H.wnext=G,H.whave=H.wsize):(H.wnext+=ut,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=ut))),0}r.inflateReset=M,r.inflateReset2=C,r.inflateResetKeep=T,r.inflateInit=function(A){return W(A,15)},r.inflateInit2=W,r.inflate=function(A,N){var f,G,ut,H,E,h,S,w,l,z,R,O,Y,J,X,et,Q,tt,lt,gt,a,B,F,y,v=0,I=new n.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return u;(f=A.state).mode===12&&(f.mode=13),E=A.next_out,ut=A.output,S=A.avail_out,H=A.next_in,G=A.input,h=A.avail_in,w=f.hold,l=f.bits,z=h,R=S,B=b;t:for(;;)switch(f.mode){case g:if(f.wrap===0){f.mode=13;break}for(;l<16;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(2&f.wrap&&w===35615){I[f.check=0]=255&w,I[1]=w>>>8&255,f.check=o(f.check,I,2,0),l=w=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&w)<<8)+(w>>8))%31){A.msg="incorrect header check",f.mode=30;break}if((15&w)!=8){A.msg="unknown compression method",f.mode=30;break}if(l-=4,a=8+(15&(w>>>=4)),f.wbits===0)f.wbits=a;else if(a>f.wbits){A.msg="invalid window size",f.mode=30;break}f.dmax=1<<a,A.adler=f.check=1,f.mode=512&w?10:12,l=w=0;break;case 2:for(;l<16;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(f.flags=w,(255&f.flags)!=8){A.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){A.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=w>>8&1),512&f.flags&&(I[0]=255&w,I[1]=w>>>8&255,f.check=o(f.check,I,2,0)),l=w=0,f.mode=3;case 3:for(;l<32;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}f.head&&(f.head.time=w),512&f.flags&&(I[0]=255&w,I[1]=w>>>8&255,I[2]=w>>>16&255,I[3]=w>>>24&255,f.check=o(f.check,I,4,0)),l=w=0,f.mode=4;case 4:for(;l<16;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}f.head&&(f.head.xflags=255&w,f.head.os=w>>8),512&f.flags&&(I[0]=255&w,I[1]=w>>>8&255,f.check=o(f.check,I,2,0)),l=w=0,f.mode=5;case 5:if(1024&f.flags){for(;l<16;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}f.length=w,f.head&&(f.head.extra_len=w),512&f.flags&&(I[0]=255&w,I[1]=w>>>8&255,f.check=o(f.check,I,2,0)),l=w=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(h<(O=f.length)&&(O=h),O&&(f.head&&(a=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),n.arraySet(f.head.extra,G,H,O,a)),512&f.flags&&(f.check=o(f.check,G,O,H)),h-=O,H+=O,f.length-=O),f.length))break t;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(h===0)break t;for(O=0;a=G[H+O++],f.head&&a&&f.length<65536&&(f.head.name+=String.fromCharCode(a)),a&&O<h;);if(512&f.flags&&(f.check=o(f.check,G,O,H)),h-=O,H+=O,a)break t}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(h===0)break t;for(O=0;a=G[H+O++],f.head&&a&&f.length<65536&&(f.head.comment+=String.fromCharCode(a)),a&&O<h;);if(512&f.flags&&(f.check=o(f.check,G,O,H)),h-=O,H+=O,a)break t}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;l<16;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(w!==(65535&f.check)){A.msg="header crc mismatch",f.mode=30;break}l=w=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),A.adler=f.check=0,f.mode=12;break;case 10:for(;l<32;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}A.adler=f.check=p(w),l=w=0,f.mode=11;case 11:if(f.havedict===0)return A.next_out=E,A.avail_out=S,A.next_in=H,A.avail_in=h,f.hold=w,f.bits=l,2;A.adler=f.check=1,f.mode=12;case 12:if(N===5||N===6)break t;case 13:if(f.last){w>>>=7&l,l-=7&l,f.mode=27;break}for(;l<3;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}switch(f.last=1&w,l-=1,3&(w>>>=1)){case 0:f.mode=14;break;case 1:if(K(f),f.mode=20,N!==6)break;w>>>=2,l-=2;break t;case 2:f.mode=17;break;case 3:A.msg="invalid block type",f.mode=30}w>>>=2,l-=2;break;case 14:for(w>>>=7&l,l-=7&l;l<32;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if((65535&w)!=(w>>>16^65535)){A.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&w,l=w=0,f.mode=15,N===6)break t;case 15:f.mode=16;case 16:if(O=f.length){if(h<O&&(O=h),S<O&&(O=S),O===0)break t;n.arraySet(ut,G,H,O,E),h-=O,H+=O,S-=O,E+=O,f.length-=O;break}f.mode=12;break;case 17:for(;l<14;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(f.nlen=257+(31&w),w>>>=5,l-=5,f.ndist=1+(31&w),w>>>=5,l-=5,f.ncode=4+(15&w),w>>>=4,l-=4,286<f.nlen||30<f.ndist){A.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;l<3;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}f.lens[D[f.have++]]=7&w,w>>>=3,l-=3}for(;f.have<19;)f.lens[D[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,F={bits:f.lenbits},B=d(0,f.lens,0,19,f.lencode,0,f.work,F),f.lenbits=F.bits,B){A.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;et=(v=f.lencode[w&(1<<f.lenbits)-1])>>>16&255,Q=65535&v,!((X=v>>>24)<=l);){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(Q<16)w>>>=X,l-=X,f.lens[f.have++]=Q;else{if(Q===16){for(y=X+2;l<y;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(w>>>=X,l-=X,f.have===0){A.msg="invalid bit length repeat",f.mode=30;break}a=f.lens[f.have-1],O=3+(3&w),w>>>=2,l-=2}else if(Q===17){for(y=X+3;l<y;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}l-=X,a=0,O=3+(7&(w>>>=X)),w>>>=3,l-=3}else{for(y=X+7;l<y;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}l-=X,a=0,O=11+(127&(w>>>=X)),w>>>=7,l-=7}if(f.have+O>f.nlen+f.ndist){A.msg="invalid bit length repeat",f.mode=30;break}for(;O--;)f.lens[f.have++]=a}}if(f.mode===30)break;if(f.lens[256]===0){A.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,F={bits:f.lenbits},B=d(k,f.lens,0,f.nlen,f.lencode,0,f.work,F),f.lenbits=F.bits,B){A.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,F={bits:f.distbits},B=d(x,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,F),f.distbits=F.bits,B){A.msg="invalid distances set",f.mode=30;break}if(f.mode=20,N===6)break t;case 20:f.mode=21;case 21:if(6<=h&&258<=S){A.next_out=E,A.avail_out=S,A.next_in=H,A.avail_in=h,f.hold=w,f.bits=l,s(A,R),E=A.next_out,ut=A.output,S=A.avail_out,H=A.next_in,G=A.input,h=A.avail_in,w=f.hold,l=f.bits,f.mode===12&&(f.back=-1);break}for(f.back=0;et=(v=f.lencode[w&(1<<f.lenbits)-1])>>>16&255,Q=65535&v,!((X=v>>>24)<=l);){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(et&&!(240&et)){for(tt=X,lt=et,gt=Q;et=(v=f.lencode[gt+((w&(1<<tt+lt)-1)>>tt)])>>>16&255,Q=65535&v,!(tt+(X=v>>>24)<=l);){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}w>>>=tt,l-=tt,f.back+=tt}if(w>>>=X,l-=X,f.back+=X,f.length=Q,et===0){f.mode=26;break}if(32&et){f.back=-1,f.mode=12;break}if(64&et){A.msg="invalid literal/length code",f.mode=30;break}f.extra=15&et,f.mode=22;case 22:if(f.extra){for(y=f.extra;l<y;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}f.length+=w&(1<<f.extra)-1,w>>>=f.extra,l-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;et=(v=f.distcode[w&(1<<f.distbits)-1])>>>16&255,Q=65535&v,!((X=v>>>24)<=l);){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(!(240&et)){for(tt=X,lt=et,gt=Q;et=(v=f.distcode[gt+((w&(1<<tt+lt)-1)>>tt)])>>>16&255,Q=65535&v,!(tt+(X=v>>>24)<=l);){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}w>>>=tt,l-=tt,f.back+=tt}if(w>>>=X,l-=X,f.back+=X,64&et){A.msg="invalid distance code",f.mode=30;break}f.offset=Q,f.extra=15&et,f.mode=24;case 24:if(f.extra){for(y=f.extra;l<y;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}f.offset+=w&(1<<f.extra)-1,w>>>=f.extra,l-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){A.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(S===0)break t;if(O=R-S,f.offset>O){if((O=f.offset-O)>f.whave&&f.sane){A.msg="invalid distance too far back",f.mode=30;break}Y=O>f.wnext?(O-=f.wnext,f.wsize-O):f.wnext-O,O>f.length&&(O=f.length),J=f.window}else J=ut,Y=E-f.offset,O=f.length;for(S<O&&(O=S),S-=O,f.length-=O;ut[E++]=J[Y++],--O;);f.length===0&&(f.mode=21);break;case 26:if(S===0)break t;ut[E++]=f.length,S--,f.mode=21;break;case 27:if(f.wrap){for(;l<32;){if(h===0)break t;h--,w|=G[H++]<<l,l+=8}if(R-=S,A.total_out+=R,f.total+=R,R&&(A.adler=f.check=f.flags?o(f.check,ut,R,E-R):i(f.check,ut,R,E-R)),R=S,(f.flags?w:p(w))!==f.check){A.msg="incorrect data check",f.mode=30;break}l=w=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;l<32;){if(h===0)break t;h--,w+=G[H++]<<l,l+=8}if(w!==(4294967295&f.total)){A.msg="incorrect length check",f.mode=30;break}l=w=0}f.mode=29;case 29:B=1;break t;case 30:B=-3;break t;case 31:return-4;case 32:default:return u}return A.next_out=E,A.avail_out=S,A.next_in=H,A.avail_in=h,f.hold=w,f.bits=l,(f.wsize||R!==A.avail_out&&f.mode<30&&(f.mode<27||N!==4))&&ot(A,A.output,A.next_out,R-A.avail_out)?(f.mode=31,-4):(z-=A.avail_in,R-=A.avail_out,A.total_in+=z,A.total_out+=R,f.total+=R,f.wrap&&R&&(A.adler=f.check=f.flags?o(f.check,ut,R,A.next_out-R):i(f.check,ut,R,A.next_out-R)),A.data_type=f.bits+(f.last?64:0)+(f.mode===12?128:0)+(f.mode===20||f.mode===15?256:0),(z==0&&R===0||N===4)&&B===b&&(B=-5),B)},r.inflateEnd=function(A){if(!A||!A.state)return u;var N=A.state;return N.window&&(N.window=null),A.state=null,b},r.inflateGetHeader=function(A,N){var f;return A&&A.state&&2&(f=A.state).wrap?((f.head=N).done=!1,b):u},r.inflateSetDictionary=function(A,N){var f,G=N.length;return A&&A.state?(f=A.state).wrap!==0&&f.mode!==11?u:f.mode===11&&i(1,N,G,0)!==f.check?-3:ot(A,N,G,G)?(f.mode=31,-4):(f.havedict=1,b):u},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var n=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(k,x,b,u,g,c,m,p){var _,T,M,C,W,P,V,U,K,ot=p.bits,A=0,N=0,f=0,G=0,ut=0,H=0,E=0,h=0,S=0,w=0,l=null,z=0,R=new n.Buf16(16),O=new n.Buf16(16),Y=null,J=0;for(A=0;A<=15;A++)R[A]=0;for(N=0;N<u;N++)R[x[b+N]]++;for(ut=ot,G=15;1<=G&&R[G]===0;G--);if(G<ut&&(ut=G),G===0)return g[c++]=20971520,g[c++]=20971520,p.bits=1,0;for(f=1;f<G&&R[f]===0;f++);for(ut<f&&(ut=f),A=h=1;A<=15;A++)if(h<<=1,(h-=R[A])<0)return-1;if(0<h&&(k===0||G!==1))return-1;for(O[1]=0,A=1;A<15;A++)O[A+1]=O[A]+R[A];for(N=0;N<u;N++)x[b+N]!==0&&(m[O[x[b+N]]++]=N);if(P=k===0?(l=Y=m,19):k===1?(l=i,z-=257,Y=o,J-=257,256):(l=s,Y=d,-1),A=f,W=c,E=N=w=0,M=-1,C=(S=1<<(H=ut))-1,k===1&&852<S||k===2&&592<S)return 1;for(;;){for(V=A-E,K=m[N]<P?(U=0,m[N]):m[N]>P?(U=Y[J+m[N]],l[z+m[N]]):(U=96,0),_=1<<A-E,f=T=1<<H;g[W+(w>>E)+(T-=_)]=V<<24|U<<16|K|0,T!==0;);for(_=1<<A-1;w&_;)_>>=1;if(_!==0?(w&=_-1,w+=_):w=0,N++,--R[A]==0){if(A===G)break;A=x[b+m[N]]}if(ut<A&&(w&C)!==M){for(E===0&&(E=ut),W+=f,h=1<<(H=A-E);H+E<G&&!((h-=R[H+E])<=0);)H++,h<<=1;if(S+=1<<H,k===1&&852<S||k===2&&592<S)return 1;g[M=w&C]=ut<<24|H<<16|W-c|0}}return w!==0&&(g[W+w]=A-E<<24|64<<16|0),p.bits=ut,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var n=e("../utils/common"),i=0,o=1;function s(v){for(var I=v.length;0<=--I;)v[I]=0}var d=0,k=29,x=256,b=x+1+k,u=30,g=19,c=2*b+1,m=15,p=16,_=7,T=256,M=16,C=17,W=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ot=new Array(2*(b+2));s(ot);var A=new Array(2*u);s(A);var N=new Array(512);s(N);var f=new Array(256);s(f);var G=new Array(k);s(G);var ut,H,E,h=new Array(u);function S(v,I,D,j,L){this.static_tree=v,this.extra_bits=I,this.extra_base=D,this.elems=j,this.max_length=L,this.has_stree=v&&v.length}function w(v,I){this.dyn_tree=v,this.max_code=0,this.stat_desc=I}function l(v){return v<256?N[v]:N[256+(v>>>7)]}function z(v,I){v.pending_buf[v.pending++]=255&I,v.pending_buf[v.pending++]=I>>>8&255}function R(v,I,D){v.bi_valid>p-D?(v.bi_buf|=I<<v.bi_valid&65535,z(v,v.bi_buf),v.bi_buf=I>>p-v.bi_valid,v.bi_valid+=D-p):(v.bi_buf|=I<<v.bi_valid&65535,v.bi_valid+=D)}function O(v,I,D){R(v,D[2*I],D[2*I+1])}function Y(v,I){for(var D=0;D|=1&v,v>>>=1,D<<=1,0<--I;);return D>>>1}function J(v,I,D){var j,L,Z=new Array(m+1),$=0;for(j=1;j<=m;j++)Z[j]=$=$+D[j-1]<<1;for(L=0;L<=I;L++){var q=v[2*L+1];q!==0&&(v[2*L]=Y(Z[q]++,q))}}function X(v){var I;for(I=0;I<b;I++)v.dyn_ltree[2*I]=0;for(I=0;I<u;I++)v.dyn_dtree[2*I]=0;for(I=0;I<g;I++)v.bl_tree[2*I]=0;v.dyn_ltree[2*T]=1,v.opt_len=v.static_len=0,v.last_lit=v.matches=0}function et(v){8<v.bi_valid?z(v,v.bi_buf):0<v.bi_valid&&(v.pending_buf[v.pending++]=v.bi_buf),v.bi_buf=0,v.bi_valid=0}function Q(v,I,D,j){var L=2*I,Z=2*D;return v[L]<v[Z]||v[L]===v[Z]&&j[I]<=j[D]}function tt(v,I,D){for(var j=v.heap[D],L=D<<1;L<=v.heap_len&&(L<v.heap_len&&Q(I,v.heap[L+1],v.heap[L],v.depth)&&L++,!Q(I,j,v.heap[L],v.depth));)v.heap[D]=v.heap[L],D=L,L<<=1;v.heap[D]=j}function lt(v,I,D){var j,L,Z,$,q=0;if(v.last_lit!==0)for(;j=v.pending_buf[v.d_buf+2*q]<<8|v.pending_buf[v.d_buf+2*q+1],L=v.pending_buf[v.l_buf+q],q++,j===0?O(v,L,I):(O(v,(Z=f[L])+x+1,I),($=P[Z])!==0&&R(v,L-=G[Z],$),O(v,Z=l(--j),D),($=V[Z])!==0&&R(v,j-=h[Z],$)),q<v.last_lit;);O(v,T,I)}function gt(v,I){var D,j,L,Z=I.dyn_tree,$=I.stat_desc.static_tree,q=I.stat_desc.has_stree,nt=I.stat_desc.elems,mt=-1;for(v.heap_len=0,v.heap_max=c,D=0;D<nt;D++)Z[2*D]!==0?(v.heap[++v.heap_len]=mt=D,v.depth[D]=0):Z[2*D+1]=0;for(;v.heap_len<2;)Z[2*(L=v.heap[++v.heap_len]=mt<2?++mt:0)]=1,v.depth[L]=0,v.opt_len--,q&&(v.static_len-=$[2*L+1]);for(I.max_code=mt,D=v.heap_len>>1;1<=D;D--)tt(v,Z,D);for(L=nt;D=v.heap[1],v.heap[1]=v.heap[v.heap_len--],tt(v,Z,1),j=v.heap[1],v.heap[--v.heap_max]=D,v.heap[--v.heap_max]=j,Z[2*L]=Z[2*D]+Z[2*j],v.depth[L]=(v.depth[D]>=v.depth[j]?v.depth[D]:v.depth[j])+1,Z[2*D+1]=Z[2*j+1]=L,v.heap[1]=L++,tt(v,Z,1),2<=v.heap_len;);v.heap[--v.heap_max]=v.heap[1],function(dt,pt){var Et,_t,Mt,wt,Qt,he,At=pt.dyn_tree,Jt=pt.max_code,de=pt.stat_desc.static_tree,pe=pt.stat_desc.has_stree,qe=pt.stat_desc.extra_bits,te=pt.stat_desc.extra_base,Ut=pt.stat_desc.max_length,Zt=0;for(wt=0;wt<=m;wt++)dt.bl_count[wt]=0;for(At[2*dt.heap[dt.heap_max]+1]=0,Et=dt.heap_max+1;Et<c;Et++)Ut<(wt=At[2*At[2*(_t=dt.heap[Et])+1]+1]+1)&&(wt=Ut,Zt++),At[2*_t+1]=wt,Jt<_t||(dt.bl_count[wt]++,Qt=0,te<=_t&&(Qt=qe[_t-te]),he=At[2*_t],dt.opt_len+=he*(wt+Qt),pe&&(dt.static_len+=he*(de[2*_t+1]+Qt)));if(Zt!==0){do{for(wt=Ut-1;dt.bl_count[wt]===0;)wt--;dt.bl_count[wt]--,dt.bl_count[wt+1]+=2,dt.bl_count[Ut]--,Zt-=2}while(0<Zt);for(wt=Ut;wt!==0;wt--)for(_t=dt.bl_count[wt];_t!==0;)Jt<(Mt=dt.heap[--Et])||(At[2*Mt+1]!==wt&&(dt.opt_len+=(wt-At[2*Mt+1])*At[2*Mt],At[2*Mt+1]=wt),_t--)}}(v,I),J(Z,mt,v.bl_count)}function a(v,I,D){var j,L,Z=-1,$=I[1],q=0,nt=7,mt=4;for($===0&&(nt=138,mt=3),I[2*(D+1)+1]=65535,j=0;j<=D;j++)L=$,$=I[2*(j+1)+1],++q<nt&&L===$||(q<mt?v.bl_tree[2*L]+=q:L!==0?(L!==Z&&v.bl_tree[2*L]++,v.bl_tree[2*M]++):q<=10?v.bl_tree[2*C]++:v.bl_tree[2*W]++,Z=L,mt=(q=0)===$?(nt=138,3):L===$?(nt=6,3):(nt=7,4))}function B(v,I,D){var j,L,Z=-1,$=I[1],q=0,nt=7,mt=4;for($===0&&(nt=138,mt=3),j=0;j<=D;j++)if(L=$,$=I[2*(j+1)+1],!(++q<nt&&L===$)){if(q<mt)for(;O(v,L,v.bl_tree),--q!=0;);else L!==0?(L!==Z&&(O(v,L,v.bl_tree),q--),O(v,M,v.bl_tree),R(v,q-3,2)):q<=10?(O(v,C,v.bl_tree),R(v,q-3,3)):(O(v,W,v.bl_tree),R(v,q-11,7));Z=L,mt=(q=0)===$?(nt=138,3):L===$?(nt=6,3):(nt=7,4)}}s(h);var F=!1;function y(v,I,D,j){R(v,(d<<1)+(j?1:0),3),function(L,Z,$,q){et(L),q&&(z(L,$),z(L,~$)),n.arraySet(L.pending_buf,L.window,Z,$,L.pending),L.pending+=$}(v,I,D,!0)}r._tr_init=function(v){F||(function(){var I,D,j,L,Z,$=new Array(m+1);for(L=j=0;L<k-1;L++)for(G[L]=j,I=0;I<1<<P[L];I++)f[j++]=L;for(f[j-1]=L,L=Z=0;L<16;L++)for(h[L]=Z,I=0;I<1<<V[L];I++)N[Z++]=L;for(Z>>=7;L<u;L++)for(h[L]=Z<<7,I=0;I<1<<V[L]-7;I++)N[256+Z++]=L;for(D=0;D<=m;D++)$[D]=0;for(I=0;I<=143;)ot[2*I+1]=8,I++,$[8]++;for(;I<=255;)ot[2*I+1]=9,I++,$[9]++;for(;I<=279;)ot[2*I+1]=7,I++,$[7]++;for(;I<=287;)ot[2*I+1]=8,I++,$[8]++;for(J(ot,b+1,$),I=0;I<u;I++)A[2*I+1]=5,A[2*I]=Y(I,5);ut=new S(ot,P,x+1,b,m),H=new S(A,V,0,u,m),E=new S(new Array(0),U,0,g,_)}(),F=!0),v.l_desc=new w(v.dyn_ltree,ut),v.d_desc=new w(v.dyn_dtree,H),v.bl_desc=new w(v.bl_tree,E),v.bi_buf=0,v.bi_valid=0,X(v)},r._tr_stored_block=y,r._tr_flush_block=function(v,I,D,j){var L,Z,$=0;0<v.level?(v.strm.data_type===2&&(v.strm.data_type=function(q){var nt,mt=4093624447;for(nt=0;nt<=31;nt++,mt>>>=1)if(1&mt&&q.dyn_ltree[2*nt]!==0)return i;if(q.dyn_ltree[18]!==0||q.dyn_ltree[20]!==0||q.dyn_ltree[26]!==0)return o;for(nt=32;nt<x;nt++)if(q.dyn_ltree[2*nt]!==0)return o;return i}(v)),gt(v,v.l_desc),gt(v,v.d_desc),$=function(q){var nt;for(a(q,q.dyn_ltree,q.l_desc.max_code),a(q,q.dyn_dtree,q.d_desc.max_code),gt(q,q.bl_desc),nt=g-1;3<=nt&&q.bl_tree[2*K[nt]+1]===0;nt--);return q.opt_len+=3*(nt+1)+5+5+4,nt}(v),L=v.opt_len+3+7>>>3,(Z=v.static_len+3+7>>>3)<=L&&(L=Z)):L=Z=D+5,D+4<=L&&I!==-1?y(v,I,D,j):v.strategy===4||Z===L?(R(v,2+(j?1:0),3),lt(v,ot,A)):(R(v,4+(j?1:0),3),function(q,nt,mt,dt){var pt;for(R(q,nt-257,5),R(q,mt-1,5),R(q,dt-4,4),pt=0;pt<dt;pt++)R(q,q.bl_tree[2*K[pt]+1],3);B(q,q.dyn_ltree,nt-1),B(q,q.dyn_dtree,mt-1)}(v,v.l_desc.max_code+1,v.d_desc.max_code+1,$+1),lt(v,v.dyn_ltree,v.dyn_dtree)),X(v),j&&et(v)},r._tr_tally=function(v,I,D){return v.pending_buf[v.d_buf+2*v.last_lit]=I>>>8&255,v.pending_buf[v.d_buf+2*v.last_lit+1]=255&I,v.pending_buf[v.l_buf+v.last_lit]=255&D,v.last_lit++,I===0?v.dyn_ltree[2*D]++:(v.matches++,I--,v.dyn_ltree[2*(f[D]+x+1)]++,v.dyn_dtree[2*l(I)]++),v.last_lit===v.lit_bufsize-1},r._tr_align=function(v){R(v,2,3),O(v,T,ot),function(I){I.bi_valid===16?(z(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):8<=I.bi_valid&&(I.pending_buf[I.pending++]=255&I.bi_buf,I.bi_buf>>=8,I.bi_valid-=8)}(v)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(n){(function(i,o){"use strict";if(!i.setImmediate){var s,d,k,x,b=1,u={},g=!1,c=i.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(i);m=m&&m.setTimeout?m:i,s={}.toString.call(i.process)==="[object process]"?function(M){process.nextTick(function(){_(M)})}:function(){if(i.postMessage&&!i.importScripts){var M=!0,C=i.onmessage;return i.onmessage=function(){M=!1},i.postMessage("","*"),i.onmessage=C,M}}()?(x="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",T,!1):i.attachEvent("onmessage",T),function(M){i.postMessage(x+M,"*")}):i.MessageChannel?((k=new MessageChannel).port1.onmessage=function(M){_(M.data)},function(M){k.port2.postMessage(M)}):c&&"onreadystatechange"in c.createElement("script")?(d=c.documentElement,function(M){var C=c.createElement("script");C.onreadystatechange=function(){_(M),C.onreadystatechange=null,d.removeChild(C),C=null},d.appendChild(C)}):function(M){setTimeout(_,0,M)},m.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var C=new Array(arguments.length-1),W=0;W<C.length;W++)C[W]=arguments[W+1];var P={callback:M,args:C};return u[b]=P,s(b),b++},m.clearImmediate=p}function p(M){delete u[M]}function _(M){if(g)setTimeout(_,0,M);else{var C=u[M];if(C){g=!0;try{(function(W){var P=W.callback,V=W.args;switch(V.length){case 0:P();break;case 1:P(V[0]);break;case 2:P(V[0],V[1]);break;case 3:P(V[0],V[1],V[2]);break;default:P.apply(o,V)}})(C)}finally{p(M),g=!1}}}}function T(M){M.source===i&&typeof M.data=="string"&&M.data.indexOf(x)===0&&_(+M.data.slice(x.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});var Pi=me((Ol,Tr)=>{"use strict";(function(){function e(u,g){let c={};return[u,g].forEach(function(m){for(let p in m)Object.prototype.hasOwnProperty.call(m,p)&&(c[p]=m[p])}),c}function t(u){if(typeof u!="string"||!u.match(/^data:image\/webp;base64,/i))throw new Error("Failed to decode WebP Base64 URL");return window.atob(u.substring(23))}function r(u,g){let c=typeof u=="string"&&/^data:image\/webp/.test(u)?u:u.toDataURL("image/webp",g);return t(c)}function n(u){let g=u.charCodeAt(0),c=u.charCodeAt(1),m=u.charCodeAt(2),p=u.charCodeAt(3);return(g|c<<8|m<<16|p<<24)>>>0}function i(u){let g=u.indexOf("VP8",12);if(g===-1)throw new Error("Bad image format, does this browser support WebP?");let c=!1;for(;g<u.length-8;){let m,p;switch(p=u.substring(g,g+4),g+=4,m=n(u.substring(g,g+4)),g+=4,p){case"VP8 ":return{frame:u.substring(g,g+m),hasAlpha:c};case"ALPH":c=!0;break}g+=m,m&1&&g++}throw new Error("Failed to find VP8 keyframe in WebP image, is this image mistakenly encoded in the Lossless WebP format?")}let o=-1,s=-2;function d(u){this.value=u}function k(u){this.value=u}function x(u,g,c){if(Array.isArray(c))for(let m=0;m<c.length;m++)x(u,g,c[m]);else if(typeof c=="string")u.writeString(c);else if(c instanceof Uint8Array)u.writeBytes(c);else if(c.id)if(c.offset=u.pos+g,u.writeUnsignedIntBE(c.id),Array.isArray(c.data)){let m,p,_;c.size===o?u.writeByte(255):c.size===s?(m=u.pos,u.writeBytes([15,255,255,255,255])):(m=u.pos,u.writeBytes([0,0,0,0])),p=u.pos,c.dataOffset=p+g,x(u,g,c.data),c.size!==o&&c.size!==s&&(_=u.pos,c.size=_-p,u.seek(m),u.writeEBMLVarIntWidth(c.size,4),u.seek(_))}else if(typeof c.data=="string")u.writeEBMLVarInt(c.data.length),c.dataOffset=u.pos+g,u.writeString(c.data);else if(typeof c.data=="number")c.size||(c.size=u.measureUnsignedInt(c.data)),u.writeEBMLVarInt(c.size),c.dataOffset=u.pos+g,u.writeUnsignedIntBE(c.data,c.size);else if(c.data instanceof k)u.writeEBMLVarInt(8),c.dataOffset=u.pos+g,u.writeDoubleBE(c.data.value);else if(c.data instanceof d)u.writeEBMLVarInt(4),c.dataOffset=u.pos+g,u.writeFloatBE(c.data.value);else if(c.data instanceof Uint8Array)u.writeEBMLVarInt(c.data.byteLength),c.dataOffset=u.pos+g,u.writeBytes(c.data);else throw new Error("Bad EBML datatype "+typeof c.data);else throw new Error("Bad EBML datatype "+typeof c.data)}let b=function(u,g){return function(c){let m=5e3,p=1,_=!1,T=0,M=0,C=null,W=null,P=null,V=[],U=0,K=0,ot={quality:.95,transparent:!1,alphaQuality:void 0,fileWriter:null,fd:null,frameDuration:null,frameRate:null},A={Cues:{id:new Uint8Array([28,83,187,107]),positionEBML:null},SegmentInfo:{id:new Uint8Array([21,73,169,102]),positionEBML:null},Tracks:{id:new Uint8Array([22,84,174,107]),positionEBML:null}},N,f={id:17545,data:new k(0)},G,ut=[],H=new g(c.fileWriter||c.fd);function E(a){return a-N.dataOffset}function h(a){(C===null||C.width!==a.width||C.height!==a.height)&&(C=document.createElement("canvas"),C.width=a.width,C.height=a.height,W=C.getContext("2d"),P=W.createImageData(C.width,C.height));let B=a.getContext("2d"),F=B.getImageData(0,0,a.width,a.height).data,y=P.data,v=0,I=a.width*a.height*4;for(let D=3;D<I;D+=4){let j=F[D];y[v++]=j,y[v++]=j,y[v++]=j,y[v++]=255}return W.putImageData(P,0,0),C}function S(){let a={id:21420,size:5,data:0},B={id:290298740,data:[]};for(let F in A){let y=A[F];y.positionEBML=Object.create(a),B.data.push({id:19899,data:[{id:21419,data:y.id},y.positionEBML]})}return B}function w(){G=S();let a={id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]},B={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:"webm-writer-js"},{id:22337,data:"webm-writer-js"},f]},F=[{id:176,data:T},{id:186,data:M}];c.transparent&&F.push({id:21440,data:1});let y={id:374648427,data:[{id:174,data:[{id:215,data:p},{id:29637,data:p},{id:156,data:0},{id:2274716,data:"und"},{id:134,data:"V_VP8"},{id:2459272,data:"VP8"},{id:131,data:1},{id:224,data:F}]}]};N={id:408125543,size:s,data:[G,B,y]};let v=new u(256);x(v,H.pos,[a,N]),H.write(v.getAsDataArray()),A.SegmentInfo.positionEBML.data=E(B.offset),A.Tracks.positionEBML.data=E(y.offset),_=!0}function l(a){let B,F,y=new u(4);if(!(a.trackNumber>0&&a.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return y.writeEBMLVarInt(a.trackNumber),y.writeU16BE(a.timecode),y.writeByte(0),B={id:161,data:[y.getAsDataArray(),a.frame]},F={id:30113,data:[{id:166,data:[{id:238,data:1},{id:165,data:a.alpha}]}]},{id:160,data:[B,F]}}function z(a){let B=new u(4);if(!(a.trackNumber>0&&a.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return B.writeEBMLVarInt(a.trackNumber),B.writeU16BE(a.timecode),B.writeByte(1<<7),{id:163,data:[B.getAsDataArray(),a.frame]}}function R(a){return a.alpha?l(a):z(a)}function O(a){return{id:524531317,data:[{id:231,data:Math.round(a.timecode)}]}}function Y(a,B,F){ut.push({id:187,data:[{id:179,data:B},{id:183,data:[{id:247,data:a},{id:241,data:E(F)}]}]})}function J(){let a={id:475249515,data:ut},B=new u(16+ut.length*32);x(B,H.pos,a),H.write(B.getAsDataArray()),A.Cues.positionEBML.data=E(a.offset)}function X(){if(V.length===0)return;let a=0;for(let y=0;y<V.length;y++)a+=V[y].frame.length+(V[y].alpha?V[y].alpha.length:0);let B=new u(a+V.length*64),F=O({timecode:Math.round(U)});for(let y=0;y<V.length;y++)F.data.push(R(V[y]));x(B,H.pos,F),H.write(B.getAsDataArray()),Y(p,Math.round(U),F.offset),V=[],U+=K,K=0}function et(){if(!c.frameDuration)if(c.frameRate)c.frameDuration=1e3/c.frameRate;else throw new Error("Missing required frameDuration or frameRate setting");c.quality=Math.max(Math.min(c.quality,.99999),0),c.alphaQuality===void 0?c.alphaQuality=c.quality:c.alphaQuality=Math.max(Math.min(c.alphaQuality,.99999),0)}function Q(a){a.trackNumber=p,a.timecode=Math.round(K),V.push(a),K+=a.duration,K>=m&&X()}function tt(){let a=new u(G.size),B=H.pos;x(a,G.dataOffset,G.data),H.seek(G.dataOffset),H.write(a.getAsDataArray()),H.seek(B)}function lt(){let a=new u(8),B=H.pos;a.writeDoubleBE(U),H.seek(f.dataOffset),H.write(a.getAsDataArray()),H.seek(B)}function gt(){let a=new u(10),B=H.pos;a.writeUnsignedIntBE(N.id),a.writeEBMLVarIntWidth(H.pos-N.dataOffset,5),H.seek(N.offset),H.write(a.getAsDataArray()),H.seek(B)}this.addFrame=function(a,B,F){_||(T=a.width||0,M=a.height||0,w());let y=i(r(a,c.quality)),v,I=null;F?v=F:typeof B=="number"?v=B:v=c.frameDuration,c.transparent&&(B instanceof HTMLCanvasElement||typeof B=="string"?I=B:y.hasAlpha&&(I=h(a))),Q({frame:y.frame,duration:v,alpha:I?i(r(I,c.alphaQuality)).frame:null})},this.complete=function(){return _||w(),X(),J(),tt(),lt(),gt(),H.complete("video/webm")},this.getWrittenSize=function(){return H.length},c=e(ot,c||{}),et()}};typeof Tr<"u"&&typeof Tr.exports<"u"?Tr.exports=b:window.WebMWriter=b(window.ArrayBufferDataStream,window.BlobBuffer)})()});var Ri=me((Ll,Ir)=>{"use strict";(function(){let e=function(t){this.data=new Uint8Array(t),this.pos=0};e.prototype.seek=function(t){this.pos=t},e.prototype.writeBytes=function(t){for(let r=0;r<t.length;r++)this.data[this.pos++]=t[r]},e.prototype.writeByte=function(t){this.data[this.pos++]=t},e.prototype.writeU8=e.prototype.writeByte,e.prototype.writeU16BE=function(t){this.data[this.pos++]=t>>8,this.data[this.pos++]=t},e.prototype.writeDoubleBE=function(t){let r=new Uint8Array(new Float64Array([t]).buffer);for(let n=r.length-1;n>=0;n--)this.writeByte(r[n])},e.prototype.writeFloatBE=function(t){let r=new Uint8Array(new Float32Array([t]).buffer);for(let n=r.length-1;n>=0;n--)this.writeByte(r[n])},e.prototype.writeString=function(t){for(let r=0;r<t.length;r++)this.data[this.pos++]=t.charCodeAt(r)},e.prototype.writeEBMLVarIntWidth=function(t,r){switch(r){case 1:this.writeU8(1<<7|t);break;case 2:this.writeU8(1<<6|t>>8),this.writeU8(t);break;case 3:this.writeU8(1<<5|t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 4:this.writeU8(1<<4|t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 5:this.writeU8(1<<3|t/4294967296&7),this.writeU8(t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;default:throw new Error("Bad EBML VINT size "+r)}},e.prototype.measureEBMLVarInt=function(t){if(t<(1<<7)-1)return 1;if(t<(1<<14)-1)return 2;if(t<(1<<21)-1)return 3;if(t<(1<<28)-1)return 4;if(t<34359738367)return 5;throw new Error("EBML VINT size not supported "+t)},e.prototype.writeEBMLVarInt=function(t){this.writeEBMLVarIntWidth(t,this.measureEBMLVarInt(t))},e.prototype.writeUnsignedIntBE=function(t,r){switch(r===void 0&&(r=this.measureUnsignedInt(t)),r){case 5:this.writeU8(Math.floor(t/4294967296));case 4:this.writeU8(t>>24);case 3:this.writeU8(t>>16);case 2:this.writeU8(t>>8);case 1:this.writeU8(t);break;default:throw new Error("Bad UINT size "+r)}},e.prototype.measureUnsignedInt=function(t){return t<1<<8?1:t<1<<16?2:t<1<<24?3:t<4294967296?4:5},e.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw new Error("ArrayBufferDataStream's pos lies beyond end of buffer")},typeof Ir<"u"&&typeof Ir.exports<"u"?Ir.exports=e:window.ArrayBufferDataStream=e})()});var zi=me((Pl,Cr)=>{"use strict";(function(){let e=function(t){return function(r){let n=[],i=Promise.resolve(),o=null,s=null;r&&r.constructor.name==="FileWriter"?o=r:t&&r&&(s=r),this.pos=0,this.length=0;function d(b){return new Promise(function(u,g){let c=new FileReader;c.addEventListener("loadend",function(){u(c.result)}),c.readAsArrayBuffer(b)})}function k(b){return new Promise(function(u,g){b instanceof Uint8Array?u(b):b instanceof ArrayBuffer||ArrayBuffer.isView(b)?u(new Uint8Array(b)):b instanceof Blob?u(d(b).then(function(c){return new Uint8Array(c)})):u(d(new Blob([b])).then(function(c){return new Uint8Array(c)}))})}function x(b){let u=b.byteLength||b.length||b.size;if(!Number.isInteger(u))throw new Error("Failed to determine size of element");return u}this.seek=function(b){if(b<0)throw new Error("Offset may not be negative");if(isNaN(b))throw new Error("Offset may not be NaN");if(b>this.length)throw new Error("Seeking beyond the end of file is not allowed");this.pos=b},this.write=function(b){let u={offset:this.pos,data:b,length:x(b)},g=u.offset>=this.length;this.pos+=u.length,this.length=Math.max(this.length,this.pos),i=i.then(function(){if(s)return new Promise(function(c,m){k(u.data).then(function(p){let _=0,T=Buffer.from(p.buffer),M=function(C,W,P){_+=W,_>=P.length?c():t.write(s,P,_,P.length-_,u.offset+_,M)};t.write(s,T,0,T.length,u.offset,M)})});if(o)return new Promise(function(c,m){o.onwriteend=c,o.seek(u.offset),o.write(new Blob([u.data]))});if(!g)for(let c=0;c<n.length;c++){let m=n[c];if(!(u.offset+u.length<=m.offset||u.offset>=m.offset+m.length)){if(u.offset<m.offset||u.offset+u.length>m.offset+m.length)throw new Error("Overwrite crosses blob boundaries");if(u.offset==m.offset&&u.length==m.length){m.data=u.data;return}else return k(m.data).then(function(p){return m.data=p,k(u.data)}).then(function(p){u.data=p,m.data.set(u.data,u.offset-m.offset)})}}n.push(u)})},this.complete=function(b){return s||o?i=i.then(function(){return null}):i=i.then(function(){let u=[];for(let g=0;g<n.length;g++)u.push(n[g].data);return new Blob(u,{type:b})}),i}}};typeof Cr<"u"&&typeof Cr.exports<"u"?Cr.exports=e:window.BlobBuffer=e(null)})()});var Ni=me((Rl,Ui)=>{Ui.exports=Pi()(Ri(),zi()(null))});var Hi=me((ji,Gi)=>{(function(e,t,r,n){"use strict";var i={URL:e.URL||e.webkitURL||e.mozURL||e.msURL,getUserMedia:function(){var E=r.getUserMedia||r.webkitGetUserMedia||r.mozGetUserMedia||r.msGetUserMedia;return E&&E.bind(r)}(),requestAnimFrame:e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame,requestTimeout:function(h,S){if(h=h||i.noop,S=S||0,!i.requestAnimFrame)return setTimeout(h,S);var w=new Date().getTime(),l=new Object,z=i.requestAnimFrame,R=function O(){var Y=new Date().getTime(),J=Y-w;J>=S?h.call():l.value=z(O)};return l.value=z(R),l},Blob:e.Blob||e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,btoa:function(){var E=e.btoa||function(h){for(var S="",w=0,l=h.length,z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",R=void 0,O=void 0,Y=void 0,J=void 0,X=void 0,et=void 0,Q=void 0;w<l;)R=h.charCodeAt(w++),O=h.charCodeAt(w++),Y=h.charCodeAt(w++),J=R>>2,X=(R&3)<<4|O>>4,et=(O&15)<<2|Y>>6,Q=Y&63,isNaN(O)?et=Q=64:isNaN(Y)&&(Q=64),S=S+z.charAt(J)+z.charAt(X)+z.charAt(et)+z.charAt(Q);return S};return E?E.bind(e):i.noop}(),isObject:function(h){return h&&Object.prototype.toString.call(h)==="[object Object]"},isEmptyObject:function(h){return i.isObject(h)&&!Object.keys(h).length},isArray:function(h){return h&&Array.isArray(h)},isFunction:function(h){return h&&typeof h=="function"},isElement:function(h){return h&&h.nodeType===1},isString:function(h){return typeof h=="string"||Object.prototype.toString.call(h)==="[object String]"},isSupported:{canvas:function(){var h=t.createElement("canvas");return h&&h.getContext&&h.getContext("2d")},webworkers:function(){return e.Worker},blob:function(){return i.Blob},Uint8Array:function(){return e.Uint8Array},Uint32Array:function(){return e.Uint32Array},videoCodecs:function(){var E=t.createElement("video"),h={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{E&&E.canPlayType&&(h.mp4=E.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",h.h264=(E.canPlayType('video/mp4; codecs="avc1.42E01E"')||E.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",h.ogv=E.canPlayType('video/ogg; codecs="theora"')!=="",h.ogg=E.canPlayType('video/ogg; codecs="theora"')!=="",h.webm=E.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return h}()},noop:function(){},each:function(h,S){var w=void 0,l=void 0;if(i.isArray(h))for(w=-1,l=h.length;++w<l&&S(w,h[w])!==!1;);else if(i.isObject(h)){for(w in h)if(h.hasOwnProperty(w)&&S(w,h[w])===!1)break}},normalizeOptions:function(h,S){if(!(!i.isObject(h)||!i.isObject(S)||!Object.keys)){var w={};return i.each(h,function(l,z){w[l]=h[l]}),i.each(S,function(l,z){var R=S[l];i.isObject(R)&&h[l]?w[l]=i.normalizeOptions(h[l],R):w[l]=R}),w}},setCSSAttr:function(h,S,w){i.isElement(h)&&(i.isString(S)&&i.isString(w)?h.style[S]=w:i.isObject(S)&&i.each(S,function(l,z){h.style[l]=z}))},removeElement:function(h){i.isElement(h)&&h.parentNode&&h.parentNode.removeChild(h)},createWebWorker:function(h){if(!i.isString(h))return{};try{var S=new i.Blob([h],{type:"text/javascript"}),w=i.URL.createObjectURL(S),l=new Worker(w);return{objectUrl:w,worker:l}}catch(z){return""+z}},getExtension:function(h){return h.substr(h.lastIndexOf(".")+1,h.length)},getFontSize:function(){var h=arguments.length>0&&arguments[0]!==n?arguments[0]:{};if(!t.body||h.resizeFont===!1)return h.fontSize;var S=h.text,w=h.gifWidth,l=parseInt(h.fontSize,10),z=parseInt(h.minFontSize,10),R=t.createElement("div"),O=t.createElement("span");for(R.setAttribute("width",w),R.appendChild(O),O.innerHTML=S,O.style.fontSize=l+"px",O.style.textIndent="-9999px",O.style.visibility="hidden",t.body.appendChild(O);O.offsetWidth>w&&l>=z;)O.style.fontSize=--l+"px";return t.body.removeChild(O),l+"px"},webWorkerError:!1},o=Object.freeze({default:i}),s={validate:function(h){h=i.isObject(h)?h:{};var S={};return i.each(s.validators,function(w,l){var z=l.errorCode;if(!h[z]&&!l.condition)return S=l,S.error=!0,!1}),delete S.condition,S},isValid:function(h){var S=s.validate(h),w=S.error!==!0;return w},validators:[{condition:i.isFunction(i.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:i.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:i.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:i.isFunction(i.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:i.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:i.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:i.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},d=Object.freeze({default:s}),k=function(){},x={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:k,completeCallback:k,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},b=Object.freeze({default:x});function u(){return s.isValid()}function g(){return s.isValid()}function c(){var E={getUserMedia:!0};return s.isValid(E)}function m(E){var h=!1;if(i.isArray(E)&&E.length){if(i.each(E,function(S,w){i.isSupported.videoCodecs[w]&&(h=!0)}),!h)return!1}else if(i.isString(E)&&E.length&&!i.isSupported.videoCodecs[E])return!1;return s.isValid({getUserMedia:!0})}function p(){var E=256,h=499,S=491,w=487,l=503,z=3*l,R=E-1,O=4,Y=100,J=16,X=1<<J,et=10,Q=1<<et,tt=10,lt=X>>tt,gt=X<<et-tt,a=E>>3,B=6,F=1<<B,y=a*F,v=30,I=10,D=1<<I,j,L=8,Z=1<<L,$=I+L,q=1<<$,nt,mt,dt,pt,Et=[],_t=[],Mt=[],wt=[];function Qt(at,st,xt){var ft,ht;for(nt=at,mt=st,dt=xt,pt=new Array(E),ft=0;ft<E;ft++)pt[ft]=new Array(4),ht=pt[ft],ht[0]=ht[1]=ht[2]=(ft<<O+8)/E|0,Mt[ft]=X/E|0,_t[ft]=0}function he(){for(var at=[],st=new Array(E),xt=0;xt<E;xt++)st[pt[xt][3]]=xt;for(var ft=0,ht=0;ht<E;ht++){var rt=st[ht];at[ft++]=pt[rt][0],at[ft++]=pt[rt][1],at[ft++]=pt[rt][2]}return at}function At(){var at,st,xt,ft,ht,rt,it,vt;for(it=0,vt=0,at=0;at<E;at++){for(ht=pt[at],xt=at,ft=ht[1],st=at+1;st<E;st++)rt=pt[st],rt[1]<ft&&(xt=st,ft=rt[1]);if(rt=pt[xt],at!=xt&&(st=rt[0],rt[0]=ht[0],ht[0]=st,st=rt[1],rt[1]=ht[1],ht[1]=st,st=rt[2],rt[2]=ht[2],ht[2]=st,st=rt[3],rt[3]=ht[3],ht[3]=st),ft!=it){for(Et[it]=vt+at>>1,st=it+1;st<ft;st++)Et[st]=at;it=ft,vt=at}}for(Et[it]=vt+R>>1,st=it+1;st<256;st++)Et[st]=R}function Jt(){var at,st,xt,ft,ht,rt,it,vt,yt,kt,Lt,bt,Ct,Rn;for(mt<z&&(dt=1),j=30+(dt-1)/3,bt=nt,Ct=0,Rn=mt,Lt=mt/(3*dt),kt=Lt/Y|0,vt=D,rt=y,it=rt>>B,it<=1&&(it=0),at=0;at<it;at++)wt[at]=vt*((it*it-at*at)*Z/(it*it));for(mt<z?yt=3:mt%h!==0?yt=3*h:mt%S!==0?yt=3*S:mt%w!==0?yt=3*w:yt=3*l,at=0;at<Lt;)if(xt=(bt[Ct+0]&255)<<O,ft=(bt[Ct+1]&255)<<O,ht=(bt[Ct+2]&255)<<O,st=Zt(xt,ft,ht),Ut(vt,st,xt,ft,ht),it!==0&&te(it,st,xt,ft,ht),Ct+=yt,Ct>=Rn&&(Ct-=mt),at++,kt===0&&(kt=1),at%kt===0)for(vt-=vt/j,rt-=rt/v,it=rt>>B,it<=1&&(it=0),st=0;st<it;st++)wt[st]=vt*((it*it-st*st)*Z/(it*it))}function de(at,st,xt){var ft,ht,rt,it,vt,yt,kt;for(vt=1e3,kt=-1,ft=Et[st],ht=ft-1;ft<E||ht>=0;)ft<E&&(yt=pt[ft],rt=yt[1]-st,rt>=vt?ft=E:(ft++,rt<0&&(rt=-rt),it=yt[0]-at,it<0&&(it=-it),rt+=it,rt<vt&&(it=yt[2]-xt,it<0&&(it=-it),rt+=it,rt<vt&&(vt=rt,kt=yt[3])))),ht>=0&&(yt=pt[ht],rt=st-yt[1],rt>=vt?ht=-1:(ht--,rt<0&&(rt=-rt),it=yt[0]-at,it<0&&(it=-it),rt+=it,rt<vt&&(it=yt[2]-xt,it<0&&(it=-it),rt+=it,rt<vt&&(vt=rt,kt=yt[3]))));return kt}function pe(){return Jt(),qe(),At(),he()}function qe(){var at,st;for(at=0;at<E;at++)pt[at][0]>>=O,pt[at][1]>>=O,pt[at][2]>>=O,pt[at][3]=at}function te(at,st,xt,ft,ht){var rt,it,vt,yt,kt,Lt,bt;for(vt=st-at,vt<-1&&(vt=-1),yt=st+at,yt>E&&(yt=E),rt=st+1,it=st-1,Lt=1;rt<yt||it>vt;){if(kt=wt[Lt++],rt<yt){bt=pt[rt++];try{bt[0]-=kt*(bt[0]-xt)/q|0,bt[1]-=kt*(bt[1]-ft)/q|0,bt[2]-=kt*(bt[2]-ht)/q|0}catch{}}if(it>vt){bt=pt[it--];try{bt[0]-=kt*(bt[0]-xt)/q|0,bt[1]-=kt*(bt[1]-ft)/q|0,bt[2]-=kt*(bt[2]-ht)/q|0}catch{}}}}function Ut(at,st,xt,ft,ht){var rt=pt[st],it=at/D;rt[0]-=it*(rt[0]-xt)|0,rt[1]-=it*(rt[1]-ft)|0,rt[2]-=it*(rt[2]-ht)|0}function Zt(at,st,xt){var ft,ht,rt,it,vt,yt,kt,Lt,bt,Ct;for(Lt=~(1<<31),bt=Lt,yt=-1,kt=yt,ft=0;ft<E;ft++)Ct=pt[ft],ht=Ct[0]-at,ht<0&&(ht=-ht),rt=Ct[1]-st,rt<0&&(rt=-rt),ht+=rt,rt=Ct[2]-xt,rt<0&&(rt=-rt),ht+=rt,ht<Lt&&(Lt=ht,yt=ft),it=ht-(_t[ft]>>J-O),it<bt&&(bt=it,kt=ft),vt=Mt[ft]>>tt,Mt[ft]-=vt,_t[ft]+=vt<<et;return Mt[yt]+=lt,_t[yt]-=gt,kt}Qt.apply(this,arguments);var Ee={};return Ee.map=de,Ee.process=pe,Ee}function _(){var E=this;try{E.onmessage=function(S){var w=S.data||{},l;w.gifshot&&(l=h.run(w),postMessage(l))}}catch{}var h={dataToRGB:function(w,l,z){for(var R=l*z*4,O=0,Y=[];O<R;)Y.push(w[O++]),Y.push(w[O++]),Y.push(w[O++]),O++;return Y},componentizedPaletteToArray:function(w){w=w||[];for(var l=[],z=0;z<w.length;z+=3){var R=w[z],O=w[z+1],Y=w[z+2];l.push(R<<16|O<<8|Y)}return l},processFrameWithQuantizer:function(w,l,z,R){for(var O=this.dataToRGB(w,l,z),Y=new p(O,O.length,R),J=Y.process(),X=new Uint32Array(this.componentizedPaletteToArray(J)),et=l*z,Q=new Uint8Array(et),tt=0,lt=0;lt<et;lt++){var gt=O[tt++],a=O[tt++],B=O[tt++];Q[lt]=Y.map(gt,a,B)}return{pixels:Q,palette:X}},run:function(w){w=w||{};var l=w,z=l.height,R=l.palette,O=l.sampleInterval,Y=l.width,J=w.data;return this.processFrameWithQuantizer(J,Y,z,O)}};return h}function T(E,h,S,w){var l=0;w=w===n?{}:w;var z=w.loop===n?null:w.loop,R=w.palette===n?null:w.palette;if(h<=0||S<=0||h>65535||S>65535)throw"Width/Height invalid.";function O(Q){var tt=Q.length;if(tt<2||tt>256||tt&tt-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return tt}E[l++]=71,E[l++]=73,E[l++]=70,E[l++]=56,E[l++]=57,E[l++]=97;var Y=0,J=0;if(E[l++]=h&255,E[l++]=h>>8&255,E[l++]=S&255,E[l++]=S>>8&255,E[l++]=(R!==null?128:0)|Y,E[l++]=J,E[l++]=0,z!==null){if(z<0||z>65535)throw"Loop count invalid.";E[l++]=33,E[l++]=255,E[l++]=11,E[l++]=78,E[l++]=69,E[l++]=84,E[l++]=83,E[l++]=67,E[l++]=65,E[l++]=80,E[l++]=69,E[l++]=50,E[l++]=46,E[l++]=48,E[l++]=3,E[l++]=1,E[l++]=z&255,E[l++]=z>>8&255,E[l++]=0}var X=!1;this.addFrame=function(Q,tt,lt,gt,a,B){if(X===!0&&(--l,X=!1),B=B===n?{}:B,Q<0||tt<0||Q>65535||tt>65535)throw"x/y invalid.";if(lt<=0||gt<=0||lt>65535||gt>65535)throw"Width/Height invalid.";if(a.length<lt*gt)throw"Not enough pixels for the frame size.";var F=!0,y=B.palette;if((y===n||y===null)&&(F=!1,y=R),y===n||y===null)throw"Must supply either a local or global palette.";for(var v=O(y),I=0;v>>=1;)++I;v=1<<I;var D=B.delay===n?0:B.delay,j=B.disposal===n?0:B.disposal;if(j<0||j>3)throw"Disposal out of range.";var L=!1,Z=0;if(B.transparent!==n&&B.transparent!==null&&(L=!0,Z=B.transparent,Z<0||Z>=v))throw"Transparent color index.";if((j!==0||L||D!==0)&&(E[l++]=33,E[l++]=249,E[l++]=4,E[l++]=j<<2|(L===!0?1:0),E[l++]=D&255,E[l++]=D>>8&255,E[l++]=Z,E[l++]=0),E[l++]=44,E[l++]=Q&255,E[l++]=Q>>8&255,E[l++]=tt&255,E[l++]=tt>>8&255,E[l++]=lt&255,E[l++]=lt>>8&255,E[l++]=gt&255,E[l++]=gt>>8&255,E[l++]=F===!0?128|I-1:0,F===!0)for(var $=0,q=y.length;$<q;++$){var nt=y[$];E[l++]=nt>>16&255,E[l++]=nt>>8&255,E[l++]=nt&255}l=et(E,l,I<2?2:I,a)},this.end=function(){return X===!1&&(E[l++]=59,X=!0),l};function et(Q,tt,lt,gt){Q[tt++]=lt;var a=tt++,B=1<<lt,F=B-1,y=B+1,v=y+1,I=lt+1,D=0,j=0;function L(_t){for(;D>=_t;)Q[tt++]=j&255,j>>=8,D-=8,tt===a+256&&(Q[a]=255,a=tt++)}function Z(_t){j|=_t<<D,D+=I,L(8)}var $=gt[0]&F,q={};Z(B);for(var nt=1,mt=gt.length;nt<mt;++nt){var dt=gt[nt]&F,pt=$<<8|dt,Et=q[pt];if(Et===n){for(j|=$<<D,D+=I;D>=8;)Q[tt++]=j&255,j>>=8,D-=8,tt===a+256&&(Q[a]=255,a=tt++);v===4096?(Z(B),v=y+1,I=lt+1,q={}):(v>=1<<I&&++I,q[pt]=v++),$=dt}else $=Et}return Z($),Z(y),L(1),a+1===tt?Q[a]=0:(Q[a]=tt-a-1,Q[tt++]=0),tt}}var M=function(){},C=function(h){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=M,this.onRenderProgressCallback=M,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=h,this.initializeWebWorkers(h)};C.prototype={workerMethods:_(),initializeWebWorkers:function(h){var S=this,w=p.toString()+"("+_.toString()+"());",l=void 0,z=void 0,R=void 0,O=void 0,Y=-1,J="";for(O=h.numWorkers;++Y<O;)l=i.createWebWorker(w),i.isObject(l)?(z=l.objectUrl,R=l.worker,S.workers.push({worker:R,objectUrl:z}),S.availableWorkers.push(R)):(J=l,i.webWorkerError=!!l);this.workerError=J,this.canvas=t.createElement("canvas"),this.canvas.width=h.gifWidth,this.canvas.height=h.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(h){this.availableWorkers.push(h)},byteMap:function(){for(var E=[],h=0;h<256;h++)E[h]=String.fromCharCode(h);return E}(),bufferToString:function(h){for(var S=h.length,w="",l=-1;++l<S;)w+=this.byteMap[h[l]];return w},onFrameFinished:function(h){var S=this,w=S.frames,l=S.options,z=!!(l.images||[]).length,R=w.every(function(O){return!O.beingProcessed&&O.done});S.numRenderedFrames++,z&&h(S.numRenderedFrames/w.length),S.onRenderProgressCallback(S.numRenderedFrames*.75/w.length),R?S.generatingGIF||S.generateGIF(w,S.onRenderCompleteCallback):i.requestTimeout(function(){S.processNextFrame()},1)},processFrame:function(h){var S=this,w=this.options,l=this.options,z=l.progressCallback,R=l.sampleInterval,O=this.frames,Y=void 0,J=void 0,X=function(){var Q=arguments.length>0&&arguments[0]!==n?arguments[0]:{},tt=Q.data;delete Y.data,Y.pixels=Array.prototype.slice.call(tt.pixels),Y.palette=Array.prototype.slice.call(tt.palette),Y.done=!0,Y.beingProcessed=!1,S.freeWorker(J),S.onFrameFinished(z)};if(Y=O[h],Y.beingProcessed||Y.done){this.onFrameFinished();return}Y.sampleInterval=R,Y.beingProcessed=!0,Y.gifshot=!0,J=this.getWorker(),J?(J.onmessage=X,J.postMessage(Y)):X({data:S.workerMethods.run(Y)})},startRendering:function(h){this.onRenderCompleteCallback=h;for(var S=0;S<this.options.numWorkers&&S<this.frames.length;S++)this.processFrame(S)},processNextFrame:function(){for(var h=-1,S=0;S<this.frames.length;S++){var w=this.frames[S];if(!w.done&&!w.beingProcessed){h=S;break}}h>=0&&this.processFrame(h)},generateGIF:function(h,S){var w=[],l={loop:this.repeat},z=this.options,R=z.interval,O=z.frameDuration,Y=z.images,J=!!Y.length,X=z.gifHeight,et=z.gifWidth,Q=new T(w,et,X,l),tt=this.onRenderProgressCallback,lt=J?R*100:0,gt=void 0,a=void 0;this.generatingGIF=!0,i.each(h,function(B,F){var y=F.palette;tt(.75+.25*F.position*1/h.length);for(var v=0;v<O;v++)Q.addFrame(0,0,et,X,F.pixels,{palette:y,delay:lt})}),Q.end(),tt(1),this.frames=[],this.generatingGIF=!1,i.isFunction(S)&&(gt=this.bufferToString(w),a="data:image/gif;base64,"+i.btoa(gt),S(a))},setRepeat:function(h){this.repeat=h},addFrame:function(h,S){S=i.isObject(S)?S:{};var w=this,l=w.ctx,z=w.options,R=z.gifWidth,O=z.gifHeight,Y=i.getFontSize(S),J=S,X=J.filter,et=J.fontColor,Q=J.fontFamily,tt=J.fontWeight,lt=J.gifHeight,gt=J.gifWidth,a=J.text,B=J.textAlign,F=J.textBaseline,y=S.textXCoordinate?S.textXCoordinate:B==="left"?1:B==="right"?R:R/2,v=S.textYCoordinate?S.textYCoordinate:F==="top"?1:F==="center"?O/2:O,I=tt+" "+Y+" "+Q,D=void 0;try{l.filter=X,l.drawImage(h,0,0,R,O),a&&(l.font=I,l.fillStyle=et,l.textAlign=B,l.textBaseline=F,l.fillText(a,y,v)),D=l.getImageData(0,0,R,O),w.addFrameImageData(D)}catch(j){return""+j}},addFrameImageData:function(){var h=arguments.length>0&&arguments[0]!==n?arguments[0]:{},S=this.frames,w=h.data;this.frames.push({data:w,width:h.width,height:h.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:S.length})},onRenderProgress:function(h){this.onRenderProgressCallback=h},isRendering:function(){return this.generatingGIF},getBase64GIF:function(h){var S=this,w=function(z){S.destroyWorkers(),i.requestTimeout(function(){h(z)},0)};S.startRendering(w)},destroyWorkers:function(){if(!this.workerError){var h=this.workers;i.each(h,function(S,w){var l=w.worker,z=w.objectUrl;l.terminate(),i.URL.revokeObjectURL(z)})}}};function W(E,h){E.getBase64GIF(function(S){h({error:!1,errorCode:"",errorMsg:"",image:S})})}function P(){var E=arguments.length>0&&arguments[0]!==n?arguments[0]:{},h=this,S=E.callback,w=E.images,l=E.options,z=E.imagesLength,R={getUserMedia:!0,"window.URL":!0},O=s.validate(R),Y=[],J=0,X=void 0,et=void 0;if(O.error)return S(O);et=new C(l),i.each(w,function(tt,lt){var gt=lt;i.isElement(gt)?(l.crossOrigin&&(gt.crossOrigin=l.crossOrigin),Y[tt]=gt,J+=1,J===z&&Q()):i.isString(gt)&&(X=new Image,l.crossOrigin&&(X.crossOrigin=l.crossOrigin),function(a){lt.text&&(a.text=lt.text),a.onerror=function(B){var F=void 0;if(--z,z===0)return F={},F.error="None of the requested images was capable of being retrieved",S(F)},a.onload=function(B){lt.text?Y[tt]={img:a,text:a.text}:Y[tt]=a,J+=1,J===z&&Q(),i.removeElement(a)},a.src=gt}(X),i.setCSSAttr(X,{position:"fixed",opacity:"0"}),t.body.appendChild(X))});function Q(){i.each(Y,function(tt,lt){lt&&(lt.text?et.addFrame(lt.img,l,lt.text):et.addFrame(lt,l))}),W(et,S)}}var V=function(){},U={getGIF:function(){var h=arguments.length>0&&arguments[0]!==n?arguments[0]:{},S=arguments[1];S=i.isFunction(S)?S:V;var w=t.createElement("canvas"),l=void 0,z=h.images,R=!!z.length,O=h.cameraStream,Y=h.crop,J=h.filter,X=h.fontColor,et=h.fontFamily,Q=h.fontWeight,tt=h.keepCameraOn,lt=h.numWorkers,gt=h.progressCallback,a=h.saveRenderingContexts,B=h.savedRenderingContexts,F=h.text,y=h.textAlign,v=h.textBaseline,I=h.videoElement,D=h.videoHeight,j=h.videoWidth,L=h.webcamVideoElement,Z=Number(h.gifWidth),$=Number(h.gifHeight),q=Number(h.interval),nt=Number(h.sampleInterval),mt=R?0:q*1e3,dt=[],pt=B.length?B.length:h.numFrames,Et=pt,_t=new C(h),Mt=i.getFontSize(h),wt=h.textXCoordinate?h.textXCoordinate:y==="left"?1:y==="right"?Z:Z/2,Qt=h.textYCoordinate?h.textYCoordinate:v==="top"?1:v==="center"?$/2:$,he=Q+" "+Mt+" "+et,At=Y?Math.floor(Y.scaledWidth/2):0,Jt=Y?j-Y.scaledWidth:0,de=Y?Math.floor(Y.scaledHeight/2):0,pe=Y?D-Y.scaledHeight:0,qe=function te(){var Ut=Et-1;B.length?(l.putImageData(B[pt-Et],0,0),Ee()):Zt();function Zt(){try{Jt>j&&(Jt=j),pe>D&&(pe=D),At<0&&(At=0),de<0&&(de=0),l.filter=J,l.drawImage(I,At,de,Jt,pe,0,0,Z,$),Ee()}catch(at){if(at.name==="NS_ERROR_NOT_AVAILABLE")i.requestTimeout(Zt,100);else throw at}}function Ee(){var at=void 0;a&&dt.push(l.getImageData(0,0,Z,$)),F&&(l.font=he,l.fillStyle=X,l.textAlign=y,l.textBaseline=v,l.fillText(F,wt,Qt)),at=l.getImageData(0,0,Z,$),_t.addFrameImageData(at),Et=Ut,gt((pt-Et)/pt),Ut>0&&i.requestTimeout(te,mt),Et||_t.getBase64GIF(function(st){S({error:!1,errorCode:"",errorMsg:"",image:st,cameraStream:O,videoElement:I,webcamVideoElement:L,savedRenderingContexts:dt,keepCameraOn:tt})})}};pt=pt!==n?pt:10,q=q!==n?q:.1,w.width=Z,w.height=$,l=w.getContext("2d"),function te(){if(!B.length&&I.currentTime===0){i.requestTimeout(te,100);return}qe()}()},getCropDimensions:function(){var h=arguments.length>0&&arguments[0]!==n?arguments[0]:{},S=h.videoWidth,w=h.videoHeight,l=h.gifWidth,z=h.gifHeight,R={width:0,height:0,scaledWidth:0,scaledHeight:0};return S>w?(R.width=Math.round(S*(z/w))-l,R.scaledWidth=Math.round(R.width*(w/z))):(R.height=Math.round(w*(l/S))-z,R.scaledHeight=Math.round(R.height*(S/l))),R}},K={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function E(h){E.attempts=E.attempts||0;var S=h.cameraStream,w=h.completedCallback,l=h.videoElement;l&&(l.videoWidth>0&&l.videoHeight>0?(l.removeEventListener("loadeddata",K.findVideoSize),w({videoElement:l,cameraStream:S,videoWidth:l.videoWidth,videoHeight:l.videoHeight})):E.attempts<10?(E.attempts+=1,i.requestTimeout(function(){K.findVideoSize(h)},400)):w({videoElement:l,cameraStream:S,videoWidth:K.defaultVideoDimensions.width,videoHeight:K.defaultVideoDimensions.height}))},onStreamingTimeout:function(h){i.isFunction(h)&&h({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(h){var S=i.isArray(h.existingVideo)?h.existingVideo[0]:h.existingVideo,w=h.cameraStream,l=h.completedCallback,z=h.streamedCallback,R=h.videoElement;if(i.isFunction(z)&&z(),S){if(i.isString(S))R.src=S,R.innerHTML='<source src="'+S+'" type="video/'+i.getExtension(S)+'" />';else if(S instanceof Blob){try{R.src=i.URL.createObjectURL(S)}catch{}R.innerHTML='<source src="'+S+'" type="'+S.type+'" />'}}else if(R.mozSrcObject)R.mozSrcObject=w;else if(i.URL)try{R.srcObject=w,R.src=i.URL.createObjectURL(w)}catch{R.srcObject=w}R.play(),i.requestTimeout(function O(){O.count=O.count||0,K.loadedData===!0?(K.findVideoSize({videoElement:R,cameraStream:w,completedCallback:l}),K.loadedData=!1):(O.count+=1,O.count>10?K.findVideoSize({videoElement:R,cameraStream:w,completedCallback:l}):O())},0)},startStreaming:function(h){var S=i.isFunction(h.error)?h.error:i.noop,w=i.isFunction(h.streamed)?h.streamed:i.noop,l=i.isFunction(h.completed)?h.completed:i.noop,z=h.crossOrigin,R=h.existingVideo,O=h.lastCameraStream,Y=h.options,J=h.webcamVideoElement,X=i.isElement(R)?R:J||t.createElement("video"),et=void 0;z&&(X.crossOrigin=Y.crossOrigin),X.autoplay=!0,X.loop=!0,X.muted=!0,X.addEventListener("loadeddata",function(Q){K.loadedData=!0,Y.offset&&(X.currentTime=Y.offset)}),R?K.stream({videoElement:X,existingVideo:R,completedCallback:l}):O?K.stream({videoElement:X,cameraStream:O,streamedCallback:w,completedCallback:l}):i.getUserMedia({video:!0},function(Q){K.stream({videoElement:X,cameraStream:Q,streamedCallback:w,completedCallback:l})},S)},startVideoStreaming:function(h){var S=arguments.length>1&&arguments[1]!==n?arguments[1]:{},w=S.timeout!==n?S.timeout:0,l=S.callback,z=S.webcamVideoElement,R=void 0;w>0&&(R=i.requestTimeout(function(){K.onStreamingTimeout(l)},1e4)),K.startStreaming({error:function(){l({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(R)},completed:function(){var Y=arguments.length>0&&arguments[0]!==n?arguments[0]:{},J=Y.cameraStream,X=Y.videoElement,et=Y.videoHeight,Q=Y.videoWidth;h({cameraStream:J,videoElement:X,videoHeight:et,videoWidth:Q})},lastCameraStream:S.lastCameraStream,webcamVideoElement:z,crossOrigin:S.crossOrigin,options:S})},stopVideoStreaming:function(h){h=i.isObject(h)?h:{};var S=h,w=S.keepCameraOn,l=S.videoElement,z=S.webcamVideoElement,R=h.cameraStream||{},O=R.getTracks?R.getTracks()||[]:[],Y=!!O.length,J=O[0];!w&&Y&&i.isFunction(J.stop)&&J.stop(),i.isElement(l)&&!z&&(l.pause(),i.isFunction(i.URL.revokeObjectURL)&&!i.webWorkerError&&l.src&&i.URL.revokeObjectURL(l.src),i.removeElement(l))}};function ot(E){E=i.isObject(E)?E:{},K.stopVideoStreaming(E)}function A(E,h){var S=E.options||{},w=S.images,l=S.video,z=Number(S.gifWidth),R=Number(S.gifHeight),O=Number(S.numFrames),Y=E.cameraStream,J=E.videoElement,X=E.videoWidth,et=E.videoHeight,Q=U.getCropDimensions({videoWidth:X,videoHeight:et,gifHeight:R,gifWidth:z}),tt=h;S.crop=Q,S.videoElement=J,S.videoWidth=X,S.videoHeight=et,S.cameraStream=Y,i.isElement(J)&&(J.width=z+Q.width,J.height=R+Q.height,S.webcamVideoElement||(i.setCSSAttr(J,{position:"fixed",opacity:"0"}),t.body.appendChild(J)),J.play(),U.getGIF(S,function(lt){(!w||!w.length)&&(!l||!l.length)&&ot(lt),tt(lt)}))}function N(){var E=arguments.length>0&&arguments[0]!==n?arguments[0]:{},h=E.callback,S=E.existingVideo,w=E.options,l={getUserMedia:!0,"window.URL":!0},z=s.validate(l),R=0,O=void 0,Y=void 0,J=void 0,X=void 0;if(z.error)return h(z);if(i.isElement(S)&&S.src){if(Y=S.src,O=i.getExtension(Y),!i.isSupported.videoCodecs[O])return h(s.messages.videoCodecs)}else i.isArray(S)&&i.each(S,function(et,Q){if(Q instanceof Blob?O=Q.type.substr(Q.type.lastIndexOf("/")+1,Q.length):O=Q.substr(Q.lastIndexOf(".")+1,Q.length),i.isSupported.videoCodecs[O])return S=Q,!1});K.startStreaming({completed:function(Q){Q.options=w||{},A(Q,h)},existingVideo:S,crossOrigin:w.crossOrigin,options:w})}function f(){var E=arguments.length>0&&arguments[0]!==n?arguments[0]:{},h=E.callback,S=E.lastCameraStream,w=E.options,l=E.webcamVideoElement;if(!g())return h(s.validate());if(w.savedRenderingContexts.length){U.getGIF(w,function(z){h(z)});return}K.startVideoStreaming(function(){var z=arguments.length>0&&arguments[0]!==n?arguments[0]:{};z.options=w||{},A(z,h)},{lastCameraStream:S,callback:h,webcamVideoElement:l,crossOrigin:w.crossOrigin})}function G(E,h){if(h=i.isFunction(E)?E:h,E=i.isObject(E)?E:{},!!i.isFunction(h)){var S=i.normalizeOptions(x,E)||{},w=E.cameraStream,l=S.images,z=l?l.length:0,R=S.video,O=S.webcamVideoElement;S=i.normalizeOptions(S,{gifWidth:Math.floor(S.gifWidth),gifHeight:Math.floor(S.gifHeight)}),z?P({images:l,imagesLength:z,callback:h,options:S}):R?N({existingVideo:R,callback:h,options:S}):f({lastCameraStream:w,callback:h,webcamVideoElement:O,options:S})}}function ut(E,h){if(h=i.isFunction(E)?E:h,E=i.isObject(E)?E:{},!!i.isFunction(h)){var S=i.normalizeOptions(x,E),w=i.normalizeOptions(S,{interval:.1,numFrames:1,gifWidth:Math.floor(S.gifWidth),gifHeight:Math.floor(S.gifHeight)});G(w,h)}}var H={utils:o,error:d,defaultOptions:b,createGIF:G,takeSnapShot:ut,stopVideoStreaming:ot,isSupported:u,isWebCamGIFSupported:g,isExistingVideoGIFSupported:m,isExistingImagesGIFSupported:c,VERSION:"0.4.5"};typeof define=="function"&&define.amd?define([],function(){return H}):typeof ji<"u"?Gi.exports=H:e.gifshot=H})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})});var Bo=me((Pn,Co)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof Pn=="object"?Co.exports=t():e.download=t()})(Pn,function(){return function e(t,r,n){var i=window,o="application/octet-stream",s=n||o,d=t,k=!r&&!n&&d,x=document.createElement("a"),b=function(P){return String(P)},u=i.Blob||i.MozBlob||i.WebKitBlob||b,g=r||"download",c,m;if(u=u.call?u.bind(i):Blob,String(this)==="true"&&(d=[d,s],s=d[0],d=d[1]),k&&k.length<2048&&(g=k.split("/").pop().split("?")[0],x.href=k,x.href.indexOf(k)!==-1)){var p=new XMLHttpRequest;return p.open("GET",k,!0),p.responseType="blob",p.onload=function(P){e(P.target.response,g,o)},setTimeout(function(){p.send()},0),p}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(d))if(d.length>1024*1024*1.999&&u!==b)d=C(d),s=d.type||o;else return navigator.msSaveBlob?navigator.msSaveBlob(C(d),g):W(d);else if(/([\x80-\xff])/.test(d)){var _=0,T=new Uint8Array(d.length),M=T.length;for(_;_<M;++_)T[_]=d.charCodeAt(_);d=new u([T],{type:s})}c=d instanceof u?d:new u([d],{type:s});function C(P){var V=P.split(/[:;,]/),U=V[1],K=V[2]=="base64"?atob:decodeURIComponent,ot=K(V.pop()),A=ot.length,N=0,f=new Uint8Array(A);for(N;N<A;++N)f[N]=ot.charCodeAt(N);return new u([f],{type:U})}function W(P,V){if("download"in x)return x.href=P,x.setAttribute("download",g),x.className="download-js-link",x.innerHTML="downloading...",x.style.display="none",document.body.appendChild(x),setTimeout(function(){x.click(),document.body.removeChild(x),V===!0&&setTimeout(function(){i.URL.revokeObjectURL(x.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(P)&&(P="data:"+P.replace(/^data:([\w\/\-\+]+)/,o)),window.open(P)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=P),!0;var U=document.createElement("iframe");document.body.appendChild(U),!V&&/^data:/.test(P)&&(P="data:"+P.replace(/^data:([\w\/\-\+]+)/,o)),U.src=P,setTimeout(function(){document.body.removeChild(U)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(c,g);if(i.URL)W(i.URL.createObjectURL(c),!0);else{if(typeof c=="string"||c.constructor===b)try{return W("data:"+s+";base64,"+i.btoa(c))}catch{return W("data:"+s+","+encodeURIComponent(c))}m=new FileReader,m.onload=function(P){W(this.result)},m.readAsDataURL(c)}return!0}})});var Hs={};zn(Hs,{Animation:()=>Gt,AnimationManager:()=>le,CameraKeyframes:()=>Kt,DeckAdapter:()=>Ze,DeckAnimation:()=>Ve,DeckLayerKeyframes:()=>fe,FrameEncoder:()=>St,GifEncoder:()=>Re,JPEGEncoder:()=>yn,JPEGSequenceEncoder:()=>mn,KeplerAnimation:()=>Ke,KeplerFilterKeyframes:()=>lr,KeplerLayerKeyframes:()=>fr,KeplerTripKeyframes:()=>hr,Keyframes:()=>Ft,PNGEncoder:()=>xn,PNGSequenceEncoder:()=>hn,PreviewEncoder:()=>oe,VERSION:()=>Yn,WebMEncoder:()=>_n,hold:()=>or,linear:()=>Ht});var mr=globalThis,No=globalThis.document||{},gr=globalThis.process||{},Do=globalThis.console,Ks=globalThis.navigator||{};function Nn(e){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&Boolean(process.versions?.electron))return!0;let t=typeof navigator<"u"&&navigator.userAgent,r=e||t;return Boolean(r&&r.indexOf("Electron")>=0)}function ge(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||Nn()}var Vr="4.1.0";function jo(e){try{let t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch{return null}}var vr=class{constructor(t,r,n="sessionStorage"){this.storage=jo(n),this.id=t,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){let r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let t={};if(this.storage){let r=this.storage.getItem(this.id);t=r?JSON.parse(r):{}}return Object.assign(this.config,t),this}};function Dn(e){let t;return e<10?t=`${e.toFixed(2)}ms`:e<100?t=`${e.toFixed(1)}ms`:e<1e3?t=`${e.toFixed(0)}ms`:t=`${(e/1e3).toFixed(2)}s`,t}function Wn(e,t=8){let r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}var yr;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(yr||(yr={}));var Go=10;function jn(e){return typeof e!="string"?e:(e=e.toUpperCase(),yr[e]||yr.WHITE)}function Gn(e,t,r){return!ge&&typeof e=="string"&&(t&&(e=`\x1B[${jn(t)}m${e}\x1B[39m`),r&&(e=`\x1B[${jn(r)+Go}m${e}\x1B[49m`)),e}function Hn(e,t=["constructor"]){let r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r),i=e;for(let o of n){let s=i[o];typeof s=="function"&&(t.find(d=>o===d)||(i[o]=s.bind(e)))}}function $e(e,t){if(!e)throw new Error(t||"Assertion failed")}function ve(){let e;if(ge()&&mr.performance)e=mr?.performance?.now?.();else if("hrtime"in gr){let t=gr?.hrtime?.();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var Se={debug:ge()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ho={enabled:!0,level:0};function Ae(){}var Vn={},Kn={once:!0},ee=class{constructor({id:t}={id:""}){this.VERSION=Vr,this._startTs=ve(),this._deltaTs=ve(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new vr(`__probe-${this.id}__`,Ho),this.timeStamp(`${this.id} started`),Hn(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ve()-this._startTs).toPrecision(10))}getDelta(){return Number((ve()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,r){this._storage.setConfiguration({[t]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,r){if(!t)throw new Error(r||"Assertion failed")}warn(t){return this._getLogFunction(0,t,Se.warn,arguments,Kn)}error(t){return this._getLogFunction(0,t,Se.error,arguments)}deprecated(t,r){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(t,r){return this.error(`\`${t}\` has been removed. Use \`${r}\` instead`)}probe(t,r){return this._getLogFunction(t,r,Se.log,arguments,{time:!0,once:!0})}log(t,r){return this._getLogFunction(t,r,Se.debug,arguments)}info(t,r){return this._getLogFunction(t,r,console.info,arguments)}once(t,r){return this._getLogFunction(t,r,Se.debug||Se.info,arguments,Kn)}table(t,r,n){return r?this._getLogFunction(t,r,console.table||Ae,n&&[n],{tag:Ko(r)}):Ae}time(t,r){return this._getLogFunction(t,r,console.time?console.time:console.info)}timeEnd(t,r){return this._getLogFunction(t,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,r){return this._getLogFunction(t,r,console.timeStamp||Ae)}group(t,r,n={collapsed:!1}){let i=Zn({logLevel:t,message:r,opts:n}),{collapsed:o}=n;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,r,n={}){return this.group(t,r,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Ae)}withGroup(t,r,n){this.group(t,r)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=qn(t)}_getLogFunction(t,r,n,i,o){if(this._shouldLog(t)){o=Zn({logLevel:t,message:r,args:i,opts:o}),n=n||o.method,$e(n),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=ve();let s=o.tag||o.message;if(o.once&&s)if(!Vn[s])Vn[s]=ve();else return Ae;return r=Vo(this.id,o.message,o),n.bind(console,r,...o.args)}return Ae}};ee.VERSION=Vr;function qn(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return $e(Number.isFinite(t)&&t>=0),t}function Zn(e){let{logLevel:t,message:r}=e;e.logLevel=qn(t);let n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":r!==void 0&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t);break;default:}typeof e.message=="function"&&(e.message=e.message());let i=typeof e.message;return $e(i==="string"||i==="object"),Object.assign(e,{args:n},e.opts)}function Vo(e,t,r){if(typeof t=="string"){let n=r.time?Wn(Dn(r.total)):"";t=r.time?`${e}: ${n}  ${t}`:`${e}: ${t}`,t=Gn(t,r.color,r.background)}return t}function Ko(e){for(let t in e)for(let r in e[t])return r||"untitled";return"empty"}globalThis.probe={};var vc=new ee({id:"@probe.gl/log"});var Zo=new ee({id:"hubble"}),Kr=Zo;function qo(){let e="1.4.0",t=globalThis.hubble&&globalThis.hubble.VERSION;if(t&&t!==e)throw new Error(`hubble.gl - multiple versions detected: ${t} vs ${e}`);return t||(Kr.log(1,`hubble.gl ${e}`)(),globalThis.hubble={...globalThis.hubble,VERSION:e,version:e,log:Kr}),e}var Yn=qo();var St=class{constructor(t={}){this.extension="",this.mimeType="",this.framerate=t.framerate||30}start(){throw new Error("Encoder: Implement a start function")}async add(t){throw new Error("Encoder: Implement an add function")}async save(){throw new Error("Encoder: Implement a save function")}};function Te(e){let t,r=new Uint8Array(e);for(t=0;t<e;t+=1)r[t]=0;return r}function ye(e,t,r=8){let n=e.toString(r);return"000000000000".substr(n.length+12-t)+e}function $n(e,t,r=0){let n,i;for(t=t||Te(e.length),n=0,i=e.length;n<i;n+=1)t[r]=e.charCodeAt(n),r+=1;return t}var Yo=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}];function Qn(e,t){let r=Te(512),n=0;return Yo.forEach(i=>{let o=e[i.field]||"",s,d;for(s=0,d=o.length;s<d;s+=1)r[n]=o.charCodeAt(s),n+=1;n+=i.length-s}),typeof t=="function"?t(r,n):r}var Zr,Ie=512,qr=class{constructor(t){this.written=0,Zr=(t||20)*Ie,this.out=Te(Zr),this.blocks=[],this.length=0,this.save=this.save.bind(this),this.clear=this.clear.bind(this),this.append=this.append.bind(this)}append(t,r,n={}){let i;if(typeof r=="string")r=$n(r);else if(r?.constructor&&r.constructor!==Uint8Array.prototype.constructor)throw`Invalid input type. You gave me: ${r.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/)?.at(1)}`;let o=n.mode||parseInt("777",8)&4095,s=n.mtime||Math.floor(Number(new Date)/1e3),d=n.uid||0,k=n.gid||0,x={fileName:t,fileMode:ye(o,7),uid:ye(d,7),gid:ye(k,7),fileSize:ye(r.length,11),mtime:ye(s,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:n.owner||"",group:n.group||""};i=0,Object.keys(x).forEach(c=>{let m,p=x[c],_;for(m=0,_=p.length;m<_;m+=1)i+=p.charCodeAt(m)}),x.checksum=`${ye(i,6)}\0 `;let b=Qn(x),u=Math.ceil(b.length/Ie)*Ie,g=Math.ceil(r.length/Ie)*Ie;this.blocks.push({header:b,input:r,headerLength:u,inputLength:g})}save(){let t=[],r=[],n=0,i=Math.pow(2,20),o=[];return this.blocks.forEach(s=>{n+s.headerLength+s.inputLength>i&&(r.push({blocks:o,length:n}),o=[],n=0),o.push(s),n+=s.headerLength+s.inputLength}),r.push({blocks:o,length:n}),r.forEach(s=>{let d=new Uint8Array(s.length),k=0;s.blocks.forEach(x=>{d.set(x.header,k),k+=x.headerLength,d.set(x.input,k),k+=x.inputLength}),t.push(d)}),t.push(new Uint8Array(2*Ie)),new Blob(t,{type:"octet/stream"})}clear(){this.written=0,this.out=Te(Zr)}},Jn=qr;var ti={recordsPerBlock:20},Tt=class{static get properties(){return{id:"tar",name:"TAR",extensions:["tar"],mimeType:"application/x-tar",builder:Tt,options:ti}}constructor(t){this.options={...ti,...t},this.tape=new Jn(this.options.recordsPerBlock),this.count=0}addFile(t,r){this.tape.append(r,new Uint8Array(t)),this.count++}async build(){return new Response(this.tape.save()).arrayBuffer()}};function Ce(e){return String(`0000000${e}`).slice(-7)}async function Be(e,t,r){let n=e.toDataURL(t,r);return await(await fetch(n)).arrayBuffer()}function Yr(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var Nt={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Xo=Nt.self||Nt.window||Nt.global||{},Qo=Nt.window||Nt.self||Nt.global||{},Jo=Nt.global||Nt.self||Nt.window||{},ta=Nt.document||{};var Dt=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser);var ei=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),ea=ei&&parseFloat(ei[1])||0;function Wt(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}var jt={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Oc=jt.self||jt.window||jt.global||{},Lc=jt.window||jt.self||jt.global||{},Pc=jt.global||jt.self||jt.window||{},Rc=jt.document||{};var wr=typeof process!="object"||String(process)!=="[object process]"||process.browser;var ni=typeof window<"u"&&typeof window.orientation<"u",ri=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),zc=ri&&parseFloat(ri[1])||0;function ct(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Xe=class{constructor(t,r){ct(this,"name",void 0),ct(this,"workerThread",void 0),ct(this,"isRunning",!0),ct(this,"result",void 0),ct(this,"_resolve",()=>{}),ct(this,"_reject",()=>{}),this.name=t,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(t,r){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:r})}done(t){Wt(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Wt(this.isRunning),this.isRunning=!1,this._reject(t)}};var Fe=class{terminate(){}};var $r=new Map;function ii(e){Wt(e.source&&!e.url||!e.source&&e.url);let t=$r.get(e.source||e.url);return t||(e.url&&(t=ra(e.url),$r.set(e.url,t)),e.source&&(t=oi(e.source),$r.set(e.source,t))),Wt(t),t}function ra(e){if(!e.startsWith("http"))return e;let t=na(e);return oi(t)}function oi(e){let t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function na(e){return`try {
  importScripts('`.concat(e,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function Xr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2?arguments[2]:void 0,n=r||new Set;if(e){if(ai(e))n.add(e);else if(ai(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(let i in e)Xr(e[i],t,n)}}return r===void 0?Array.from(n):[]}function ai(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}function Qr(e){if(e===null)return{};let t=Object.assign({},e);return Object.keys(t).forEach(r=>{typeof e[r]=="object"&&!ArrayBuffer.isView(e[r])&&!(e[r]instanceof Array)?t[r]=Qr(e[r]):typeof t[r]=="function"||t[r]instanceof RegExp?t[r]={}:t[r]=e[r]}),t}var Jr=()=>{},re=class{static isSupported(){return typeof Worker<"u"&&wr||typeof Fe<"u"&&!wr}constructor(t){ct(this,"name",void 0),ct(this,"source",void 0),ct(this,"url",void 0),ct(this,"terminated",!1),ct(this,"worker",void 0),ct(this,"onMessage",void 0),ct(this,"onError",void 0),ct(this,"_loadableURL","");let{name:r,source:n,url:i}=t;Wt(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=Jr,this.onError=o=>console.log(o),this.worker=wr?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Jr,this.onError=Jr,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,r){r=r||Xr(t),this.worker.postMessage(t,r)}_getErrorFromErrorEvent(t){let r="Failed to load ";return r+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(r+="".concat(t.message," in ")),t.lineno&&(r+=":".concat(t.lineno,":").concat(t.colno)),new Error(r)}_createBrowserWorker(){this._loadableURL=ii({source:this.source,url:this.url});let t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},t.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},t.onmessageerror=r=>console.error(r),t}_createNodeWorker(){let t;if(this.url){let n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new Fe(n,{eval:!1})}else if(this.source)t=new Fe(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",r=>{this.onMessage(r)}),t.on("error",r=>{this.onError(r)}),t.on("exit",r=>{}),t}};var Qe=class{static isSupported(){return re.isSupported()}constructor(t){ct(this,"name","unnamed"),ct(this,"source",void 0),ct(this,"url",void 0),ct(this,"maxConcurrency",1),ct(this,"maxMobileConcurrency",1),ct(this,"onDebug",()=>{}),ct(this,"reuseWorkers",!0),ct(this,"props",{}),ct(this,"jobQueue",[]),ct(this,"idleQueue",[]),ct(this,"count",0),ct(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(o,s,d)=>o.done(d),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(o,s)=>o.error(s),i=new Promise(o=>(this.jobQueue.push({name:t,onMessage:r,onError:n,onStart:o}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;let t=this._getAvailableWorker();if(!t)return;let r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:t,backlog:this.jobQueue.length});let n=new Xe(r.name,t);t.onMessage=i=>r.onMessage(n,i.type,i.payload),t.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new re({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ni?this.maxMobileConcurrency:this.maxConcurrency}};var ia={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},It=class{static isSupported(){return re.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return It._workerFarm=It._workerFarm||new It({}),It._workerFarm.setProps(t),It._workerFarm}constructor(t){ct(this,"props",void 0),ct(this,"workerPools",new Map),this.props={...ia},this.setProps(t),this.workerPools=new Map}destroy(){for(let t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(let r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(t){let{name:r,source:n,url:i}=t,o=this.workerPools.get(r);return o||(o=new Qe({name:r,source:n,url:i}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};ct(It,"_workerFarm",void 0);var oa="latest",si="3.4.15";function ci(e){let t=e.version!==si?" (worker-utils@".concat(si,")"):"";return"".concat(e.name,"@").concat(e.version).concat(t)}function ui(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t[e.id]||{},n="".concat(e.id,"-worker.js"),i=r.workerUrl;if(!i&&e.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(i="modules/".concat(e.module,"/dist/").concat(n)),!i){let o=e.version;o==="latest"&&(o=oa);let s=o?"@".concat(o):"";i="https://unpkg.com/@loaders.gl/".concat(e.module).concat(s,"/dist/").concat(n)}return Wt(i),i}async function tn(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=ci(e),o=It.getWorkerFarm(r),{source:s}=r,d={name:i,source:s};s||(d.url=ui(e,r));let k=o.getWorkerPool(d),x=r.jobName||e.name,b=await k.startJob(x,aa.bind(null,n)),u=Qr(r);return b.postMessage("process",{input:t,options:u}),(await b.result).result}async function aa(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":let{id:i,input:o,options:s}=n;try{if(!e.process){t.postMessage("error",{id:i,error:"Worker not set up to process on main thread"});return}let d=await e.process(o,s);t.postMessage("done",{id:i,result:d})}catch(d){let k=d instanceof Error?d.message:"unknown error";t.postMessage("error",{id:i,error:k})}break;default:console.warn("process-on-worker: unknown message ".concat(r))}}function en(e,t){return!It.isSupported()||!Dt&&!(t!=null&&t._nodeWorkers)?!1:e.worker&&t?.worker}function rn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=t.map(d=>d instanceof ArrayBuffer?new Uint8Array(d):d),i=n.reduce((d,k)=>d+k.byteLength,0),o=new Uint8Array(i),s=0;for(let d of n)o.set(d,s),s+=d.byteLength;return o.buffer}var sa="",fi={};function ne(e){for(let t in fi)if(e.startsWith(t)){let r=fi[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e="".concat(sa).concat(e)),e}function nn(e){throw new Error("Buffer not supported in browser")}function on(e){return nn?nn(e):e}var xr={};zn(xr,{_readToArrayBuffer:()=>xa,close:()=>ga,createWriteStream:()=>wa,fstat:()=>ya,isSupported:()=>ba,open:()=>ma,read:()=>va,readFile:()=>la,readFileSync:()=>ha,readdir:()=>ua,stat:()=>fa,writeFile:()=>da,writeFileSync:()=>pa});var ua=null,fa=null,la=null,ha=null,da=null,pa=null,ma=null,ga=null,va=null,ya=null,wa=null,xa=null,ba=!1;var Me=e=>typeof Response<"u"&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json;var br=e=>typeof Blob<"u"&&e instanceof Blob;var _a=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,ka=/^([-\w.]+\/[-\w.+]+)/;function li(e){let t=ka.exec(e);return t?t[1]:e}function an(e){let t=_a.exec(e);return t?t[1]:""}var Ea=/\?.*/;function hi(e){return e.replace(Ea,"")}function di(e){return Me(e)?e.url:br(e)?e.name||"":typeof e=="string"?e:""}function pi(e){if(Me(e)){let t=e,r=t.headers.get("content-type")||"",n=hi(t.url);return li(r)||an(n)}return br(e)?e.type||"":typeof e=="string"?an(e):""}function mi(e){return Me(e)?e.headers["content-length"]||-1:br(e)?e.size:typeof e=="string"?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}async function gi(e){if(Me(e))return e;let t={},r=mi(e);r>=0&&(t["content-length"]=String(r));let n=di(e),i=pi(e);i&&(t["content-type"]=i);let o=await Sa(e);o&&(t["x-first-bytes"]=o),typeof e=="string"&&(e=new TextEncoder().encode(e));let s=new Response(e,{headers:t});return Object.defineProperty(s,"url",{value:n}),s}async function Sa(e){if(typeof e=="string")return"data:,".concat(e.slice(0,5));if(e instanceof Blob){let r=e.slice(0,5);return await new Promise(n=>{let i=new FileReader;i.onload=o=>{var s;return n(o==null||(s=o.target)===null||s===void 0?void 0:s.result)},i.readAsDataURL(r)})}if(e instanceof ArrayBuffer){let r=e.slice(0,5),n=Aa(r);return"data:base64,".concat(n)}return null}function Aa(e){let t="",r=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)}async function vi(e,t){if(typeof e=="string"){e=ne(e);let r=t;return t!=null&&t.fetch&&typeof t?.fetch!="function"&&(r=t.fetch),await fetch(e,r)}return await gi(e)}async function yi(e,t,r){e=ne(e),Dt||await xr.writeFile(e,on(t),{flag:"w"}),Yr(!1)}function sn(e){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;let t=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,r=e||t;return!!(r&&r.indexOf("Electron")>=0)}function Pt(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||sn()}var ie={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process};var Ta=ie.self||ie.window||ie.global,Oe=ie.window||ie.self||ie.global,Ia=ie.document||{},we=ie.process||{};var _r=typeof __VERSION__<"u"?__VERSION__:"untranspiled source",uf=Pt();function Ca(e){try{let t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch{return null}}var Je=class{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";ct(this,"storage",void 0),ct(this,"id",void 0),ct(this,"config",{}),this.storage=Ca(n),this.id=t,this.config={},Object.assign(this.config,r),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){let r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}return this}_loadConfiguration(){let t={};if(this.storage){let r=this.storage.getItem(this.id);t=r?JSON.parse(r):{}}return Object.assign(this.config,t),this}};function wi(e){let t;return e<10?t="".concat(e.toFixed(2),"ms"):e<100?t="".concat(e.toFixed(1),"ms"):e<1e3?t="".concat(e.toFixed(0),"ms"):t="".concat((e/1e3).toFixed(2),"s"),t}function xi(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,r=Math.max(t-e.length,0);return"".concat(" ".repeat(r)).concat(e)}function kr(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>n&&(r=Math.min(r,n/e.width));let o=e.width*r,s=e.height*r,d=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),d]}var Er;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Er||(Er={}));function bi(e){return typeof e=="string"?Er[e.toUpperCase()]||Er.WHITE:e}function _i(e,t,r){return!Pt&&typeof e=="string"&&(t&&(t=bi(t),e="\x1B[".concat(t,"m").concat(e,"\x1B[39m")),r&&(t=bi(r),e="\x1B[".concat(r+10,"m").concat(e,"\x1B[49m"))),e}function ki(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r);for(let i of n)typeof e[i]=="function"&&(t.find(o=>i===o)||(e[i]=e[i].bind(e)))}function Le(e,t){if(!e)throw new Error(t||"Assertion failed")}function xe(){let e;if(Pt&&"performance"in Oe){var t,r;e=Oe===null||Oe===void 0||(t=Oe.performance)===null||t===void 0||(r=t.now)===null||r===void 0?void 0:r.call(t)}else if("hrtime"in we){var n;let i=we===null||we===void 0||(n=we.hrtime)===null||n===void 0?void 0:n.call(we);e=i[0]*1e3+i[1]/1e6}else e=Date.now();return e}var Pe={debug:Pt&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ba={enabled:!0,level:0};function Ot(){}var Ei={},Si={once:!0},qt=class{constructor(){let{id:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};ct(this,"id",void 0),ct(this,"VERSION",_r),ct(this,"_startTs",xe()),ct(this,"_deltaTs",xe()),ct(this,"_storage",void 0),ct(this,"userData",{}),ct(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this._storage=new Je("__probe-".concat(this.id,"__"),Ba),this.userData={},this.timeStamp("".concat(this.id," started")),ki(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((xe()-this._startTs).toPrecision(10))}getDelta(){return Number((xe()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,r){this._storage.updateConfiguration({[t]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,r){Le(t,r)}warn(t){return this._getLogFunction(0,t,Pe.warn,arguments,Si)}error(t){return this._getLogFunction(0,t,Pe.error,arguments)}deprecated(t,r){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(r,"` instead"))}removed(t,r){return this.error("`".concat(t,"` has been removed. Use `").concat(r,"` instead"))}probe(t,r){return this._getLogFunction(t,r,Pe.log,arguments,{time:!0,once:!0})}log(t,r){return this._getLogFunction(t,r,Pe.debug,arguments)}info(t,r){return this._getLogFunction(t,r,console.info,arguments)}once(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return this._getLogFunction(t,r,Pe.debug||Pe.info,arguments,Si)}table(t,r,n){return r?this._getLogFunction(t,r,console.table||Ot,n&&[n],{tag:La(r)}):Ot}image(t){let{logLevel:r,priority:n,image:i,message:o="",scale:s=1}=t;return this._shouldLog(r||n)?Pt?Oa({image:i,message:o,scale:s}):Ma({image:i,message:o,scale:s}):Ot}time(t,r){return this._getLogFunction(t,r,console.time?console.time:console.info)}timeEnd(t,r){return this._getLogFunction(t,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,r){return this._getLogFunction(t,r,console.timeStamp||Ot)}group(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1},i=Ai({logLevel:t,message:r,opts:n}),{collapsed:o}=n;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(t,r,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Ot)}withGroup(t,r,n){this.group(t,r)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Ti(t)}_getLogFunction(t,r,n,i,o){if(this._shouldLog(t)){o=Ai({logLevel:t,message:r,args:i,opts:o}),n=n||o.method,Le(n),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=xe();let s=o.tag||o.message;if(o.once)if(!Ei[s])Ei[s]=xe();else return Ot;return r=Fa(this.id,o.message,o),n.bind(console,r,...o.args)}return Ot}};ct(qt,"VERSION",_r);function Ti(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Le(Number.isFinite(t)&&t>=0),t}function Ai(e){let{logLevel:t,message:r}=e;e.logLevel=Ti(t);let n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":r!==void 0&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t);break;default:}typeof e.message=="function"&&(e.message=e.message());let i=typeof e.message;return Le(i==="string"||i==="object"),Object.assign(e,{args:n},e.opts)}function Fa(e,t,r){if(typeof t=="string"){let n=r.time?xi(wi(r.total)):"";t=r.time?"".concat(e,": ").concat(n,"  ").concat(t):"".concat(e,": ").concat(t),t=_i(t,r.color,r.background)}return t}function Ma(e){let{image:t,message:r="",scale:n=1}=e,i=null;try{i=module.require("asciify-image")}catch{}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*n),"%")}).then(o=>console.log(o)):Ot}function Oa(e){let{image:t,message:r="",scale:n=1}=e;if(typeof t=="string"){let o=new Image;return o.onload=()=>{let s=kr(o,r,n);console.log(...s)},o.src=t,Ot}let i=t.nodeName||"";if(i.toLowerCase()==="img")return console.log(...kr(t,r,n)),Ot;if(i.toLowerCase()==="canvas"){let o=new Image;return o.onload=()=>console.log(...kr(o,r,n)),o.src=t.toDataURL(),Ot}return Ot}function La(e){for(let t in e)for(let r in e[t])return r||"untitled";return"empty"}var zf=new qt({id:"@probe.gl/log"});var jf=new qt({id:"loaders.gl"});var Sr=class{constructor(){ct(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.console.log.bind(this.console,...r)}info(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.console.info.bind(this.console,...r)}warn(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.console.warn.bind(this.console,...r)}error(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.console.error.bind(this.console,...r)}};var Ii={fetch:null,mimeType:void 0,nothrow:!1,log:new Sr,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Dt,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]};function Pa(){globalThis.loaders=globalThis.loaders||{};let{loaders:e}=globalThis;return e._state=e._state||{},e._state}var cn=()=>{let e=Pa();return e.globalOptions=e.globalOptions||{...Ii},e.globalOptions};async function tr(e,t,r){if(r={...cn(),...r},en(t,r))return await tn(t,e,r);if(t.encode)return await t.encode(e,r);if(t.encodeSync)return t.encodeSync(e,r);if(t.encodeText)return new TextEncoder().encode(await t.encodeText(e,r));if(t.encodeInBatches){let i=Bi(e,t,r),o=[];for await(let s of i)o.push(s);return rn(...o)}if(!Dt&&t.encodeURLtoURL){let i=Ci("input");await yi(i,e);let o=Ci("output"),s=await Fi(i,o,t,r);return(await vi(s)).arrayBuffer()}throw new Error("Writer could not encode data")}function Bi(e,t,r){if(t.encodeInBatches){let n=Ra(e);return t.encodeInBatches(n,r)}throw new Error("Writer could not encode data in batches")}async function Fi(e,t,r,n){if(e=ne(e),t=ne(t),Dt||!r.encodeURLtoURL)throw new Error;return await r.encodeURLtoURL(e,t,n)}function Ra(e){return[{table:e,start:0,end:e.length}]}function Ci(e){return"/tmp/".concat(e)}var Li=pr(Oi()),Rt={name:"Zip Archive",extensions:["zip"],category:"archive",mimeTypes:["application/zip"],encode:za};async function za(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=new Li.default;for(let i in e){let o=e[i];r.file(i,o,t)}t=Object.assign({},t,{type:"arraybuffer"});let{onUpdate:n=()=>{}}=t;return r.generateAsync(t,n).catch(i=>{throw t.log.error("Unable to write zip archive: ".concat(i)),i})}var er="tar",fn="zip",ln=class extends St{constructor(t){switch(super(t),this.tarBuilder=null,this.filemap={},this.options={archive:er},t.png&&(this.options={...t.png}),this.options.archive=this.options.archive||er,this.options.archive){case er:{this.mimeType=Tt.properties.mimeType,this.extension=`.${Tt.properties.extensions[0]}`;break}case fn:{this.mimeType=Rt.mimeTypes?.[0]||"",this.extension=`.${Rt.extensions?.[0]}`;break}default:throw new Error(`Unsupported archive type [zip, tar]: ${this.options.archive}`)}}start(){this.tarBuilder=new Tt({}),this.filemap={}}async add(t){let r="image/png",n=".png",i=await Be(t,r);switch(this.options.archive){case er:{if(!this.tarBuilder)break;let o=Ce(this.tarBuilder.count)+n;this.tarBuilder.addFile(i,o);break}case fn:{let o=Ce(Object.keys(this.filemap).length)+n;this.filemap[o]=i;break}default:throw new Error(`Unsupported archive type [zip, tar]: ${this.options.archive}`)}}async save(){switch(this.options.archive){case er:{if(!this.tarBuilder)break;let t=await this.tarBuilder.build();return new Blob([t],{type:Tt.properties.mimeType})}case fn:{let t=await tr(this.filemap,Rt);return new Blob([t],{type:Rt.mimeTypes?.[0]})}default:throw new Error(`Unsupported archive type [zip, tar]: ${this.options.archive}`)}return null}},hn=ln;var rr="tar",dn="zip",pn=class extends St{constructor(t){switch(super(t),this.tarBuilder=null,this.filemap={},this.options={quality:1,archive:rr},t.jpeg&&(this.options={...t.jpeg}),this.options.quality=this.options.quality||1,this.options.archive=this.options.archive||rr,this.options.archive){case rr:{this.mimeType=Tt.properties.mimeType,this.extension=`.${Tt.properties.extensions[0]}`;break}case dn:{this.mimeType=Rt.mimeTypes?.[0]||"",this.extension=`.${Rt.extensions?.[0]}`;break}default:throw new Error(`Unsupported archive type [zip, tar]: ${this.options.archive}`)}}start(){this.tarBuilder=new Tt({}),this.filemap={}}async add(t){let r="image/jpeg",n=".jpg",i=await Be(t,r,this.options.quality);switch(this.options.archive){case rr:{if(!this.tarBuilder)break;let o=Ce(this.tarBuilder.count)+n;this.tarBuilder.addFile(i,o);break}case dn:{let o=Ce(Object.keys(this.filemap).length)+n;this.filemap[o]=i;break}default:throw new Error(`Unsupported archive type [zip, tar]: ${this.options.archive}`)}}async save(){switch(this.options.archive){case rr:{if(!this.tarBuilder)break;let t=await this.tarBuilder.build();return new Blob([t],{type:Tt.properties.mimeType})}case dn:{let t=await tr(this.filemap,Rt);return new Blob([t],{type:Rt.mimeTypes?.[0]})}default:throw new Error(`Unsupported archive type [zip, tar]: ${this.options.archive}`)}return null}},mn=pn;var gn=class extends St{constructor(t){super(t),this.blob=null,this.add=this.add.bind(this)}async add(t){let r=await Be(t,this.mimeType,this.quality);return this.blob=new Blob([r],{type:this.mimeType}),Promise.resolve()}async save(){return Promise.resolve(this.blob)}},Ar=gn;var vn=class extends Ar{constructor(t){super(t),this.mimeType="image/jpeg",this.extension=".jpg"}},yn=vn;var wn=class extends Ar{constructor(t){super(t),this.mimeType="image/png",this.extension=".png"}},xn=wn;var Di=pr(Ni(),1);var bn=class extends St{constructor(t){super(t),this.quality=.8,t.webm&&t.webm.quality&&(this.quality=t.webm.quality),document.createElement("canvas").toDataURL("image/webp").substr(5,10)!=="image/webp"&&console.error("WebP not supported - try another export format"),this.extension=".webm",this.mimeType="video/webm",this.videoWriter=null,this.start=this.start.bind(this),this.add=this.add.bind(this),this.save=this.save.bind(this)}start(){this.videoWriter=new Di.default({quality:this.quality,fileWriter:null,fd:null,frameRate:this.framerate})}async add(t){this.videoWriter.addFrame(t),await Promise.resolve()}async save(){return this.videoWriter.complete()}},_n=bn;var oe=class extends St{start(){this.af&&cancelAnimationFrame(this.af)}async add(t){return new Promise(n=>{this.af&&cancelAnimationFrame(this.af),this.af=requestAnimationFrame(()=>n())})}async save(){return this.af&&cancelAnimationFrame(this.af),await Promise.resolve(null)}};function Wi(e,t){if(!e)throw new Error(t)}var Vi=pr(Hi()),Ua={source:"images",width:200,height:200,crossOrigin:"Anonymous",progressCallback:e=>{},completeCallback:()=>{},numWorkers:2,sampleInterval:10,interval:.1,offset:null,numFrames:10,frameDuration:1,filter:"",waterMark:null,waterMarkHeight:null,waterMarkWidth:null,waterMarkXCoordinate:1,waterMarkYCoordinate:1,text:"",showFrameText:!0,fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,webcamVideoElement:null,keepCameraOn:!1,cameraStream:null,saveRenderingContexts:!1,savedRenderingContexts:[]},ae=class{static get properties(){return{id:"gif",name:"GIF",extensions:["gif"],mimeTypes:["image/gif"],builder:ae,options:Ua}}constructor(t){this.options={...t},this.source=t.source,delete t.source,this.files=[],this.gifshot=Vi.default}async initialize(t){}async add(t){await this.initialize(),this.files.push(t)}async build(){switch(await this.initialize(),this._cleanOptions(this.options),this.source){case"images":this.options.images=this.files;break;case"video":this.options.video=this.files;break;case"webcam":Wi(this.files.length===0);break;default:throw new Error("GIFBuilder: invalid source")}return await this._createGIF()}async _createGIF(){return new Promise((t,r)=>{this.gifshot.createGIF(this.options,n=>{if(n.error){r(n.errorMsg);return}t(n.image)})})}_cleanOptions(t){(t.video||t.images||t.gifWidth||t.gifHeight)&&console.warn("GIFBuilder: ignoring options"),delete t.video,delete t.images,t.gifWidth=t.width,t.gifHeight=t.height,delete t.width,delete t.height}};var Re=class extends St{constructor(t){super(t),this.gifBuilder=null,this.source="images",this.mimeType="image/gif",this.extension=".gif";let r={width:720,height:480,numWorkers:4,sampleInterval:10,jpegQuality:1};t.gif&&(r={...r,...t.gif}),this.options=r,this.start=this.start.bind(this),this.add=this.add.bind(this),this.save=this.save.bind(this)}start(){this.gifBuilder=new ae({source:this.source,...this.options,interval:1/this.framerate})}async add(t){if(this.source==="images"){let r=t.toDataURL("image/jpeg",this.options.jpegQuality);await this.gifBuilder.add(r)}}async save(){return fetch(await this.gifBuilder.build()).then(t=>t.blob())}};var Gt=class{constructor({id:t}){this.unattachedKeyframes=[],this.id=t,this.unattachedKeyframes=[]}attachKeyframes(t){for(let r of this.unattachedKeyframes)r.animationHandle&&t.detachAnimation(r.animationHandle),r.animationHandle=t.attachAnimation(r,void 0);this.unattachedKeyframes=[]}getKeyframes(){throw new Error("not implemented")}setKeyframes(t){throw new Error("not implemented")}animator(t){throw new Error("not implemented")}draw(){return this.animator(this)}};var oh=1/Math.PI*180,ah=1/180*Math.PI;function Ki(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Br(e,t,r){return Ki(e)?e.map((n,i)=>Br(n,t[i],r)):r*t+(1-r)*e}var kn=typeof Float32Array<"u"?Float32Array:Array;var ch=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Da(){var e=new kn(2);return kn!=Float32Array&&(e[0]=0,e[1]=0),e}function Zi(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Wa(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function qi(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Yi(e){var t=e[0],r=e[1];return Math.hypot(t,r)}var $i=Wa;var lh=function(){var e=Da();return function(t,r,n,i,o,s){var d,k;for(r||(r=2),n||(n=0),i?k=Math.min(i*r+n,t.length):k=t.length,d=n;d<k;d+=r)e[0]=t[d],e[1]=t[d+1],o(e,e,s),t[d]=e[0],t[d+1]=e[1];return t}}();var Ga=1,Ha=1,nr=class{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){let{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=Ga++,d={time:0,delay:r,duration:n,rate:i,repeat:o};return this._setChannelTime(d,this.time),this.channels.set(s,d),s}removeChannel(t){this.channels.delete(t);for(let[r,n]of this.animations)n.channel===t&&this.detachAnimation(r)}isFinished(t){let r=this.channels.get(t);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(t){if(t===void 0)return this.time;let r=this.channels.get(t);return r===void 0?-1:r.time}setTime(t){this.time=Math.max(0,t);let r=this.channels.values();for(let i of r)this._setChannelTime(i,this.time);let n=this.animations.values();for(let i of n){let{animation:o,channel:s}=i;o.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,r){let n=Ha++;return this.animations.set(n,{animation:t,channel:r}),t.setTime(this.getTime(r)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,r){let n=r-t.delay,i=t.duration*t.repeat;n>=i?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}};var ir=class{constructor(t){this._lastTime=-1,this.startIndex=-1,this.endIndex=-1,this.factor=0,this.times=[],this.values=[],this.setKeyFrames(t),this.setTime(0)}setKeyFrames(t){let r=t.length;this.times.length=r,this.values.length=r;for(let n=0;n<r;++n)this.times[n]=t[n][0],this.values[n]=t[n][1];this._calculateKeys(this._lastTime)}setTime(t){t=Math.max(0,t),t!==this._lastTime&&(this._calculateKeys(t),this._lastTime=t)}getStartTime(){return this.times[this.startIndex]}getEndTime(){return this.times[this.endIndex]}getStartData(){return this.values[this.startIndex]}getEndData(){return this.values[this.endIndex]}_calculateKeys(t){let r=0,n=this.times.length;for(r=0;r<n-2&&!(this.times[r+1]>t);++r);this.startIndex=r,this.endIndex=r+1;let i=this.times[this.startIndex],o=this.times[this.endIndex];this.factor=Math.min(Math.max(0,(t-i)/(o-i)),1)}};var or=e=>e===1?1:0,Ht=e=>e;var be=function(){return be=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},be.apply(this,arguments)};function Xi(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],s=0,d=o.length;s<d;s++,i++)n[i]=o[s];return n}var Yt=function(){};var Qi=function(e,t,r){return Math.min(Math.max(r,e),t)};var En=function(e,t,r){var n=t-e;return n===0?1:(r-e)/n};var _e=function(e,t,r){return-r*e+r*t+e};var Bt=function(){return Bt=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Bt.apply(this,arguments)};var Fr=function(e,t){return function(r){return Math.max(Math.min(r,t),e)}},se=function(e){return e%1?Number(e.toFixed(5)):e},ze=/(-)?([\d]*\.?[\d])+/g,Mr=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,Ji=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function $t(e){return typeof e=="string"}var Ue={test:function(e){return typeof e=="number"},parse:parseFloat,transform:function(e){return e}},Or=Bt(Bt({},Ue),{transform:Fr(0,1)}),Zh=Bt(Bt({},Ue),{default:1});var ar=function(e){return{test:function(t){return $t(t)&&t.endsWith(e)&&t.split(" ").length===1},parse:parseFloat,transform:function(t){return""+t+e}}},Xh=ar("deg"),Ne=ar("%"),Qh=ar("px"),Jh=ar("vh"),td=ar("vw"),ed=Bt(Bt({},Ne),{parse:function(e){return Ne.parse(e)/100},transform:function(e){return Ne.transform(e*100)}});var De=function(e,t){return function(r){return $t(r)&&Ji.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)}},Lr=function(e,t,r){return function(n){var i;if(!$t(n))return n;var o=n.match(ze),s=o[0],d=o[1],k=o[2],x=o[3];return i={},i[e]=parseFloat(s),i[t]=parseFloat(d),i[r]=parseFloat(k),i.alpha=x!==void 0?parseFloat(x):1,i}};var Xt={test:De("hsl","hue"),parse:Lr("hue","saturation","lightness"),transform:function(e){var t=e.hue,r=e.saturation,n=e.lightness,i=e.alpha,o=i===void 0?1:i;return"hsla("+Math.round(t)+", "+Ne.transform(se(r))+", "+Ne.transform(se(n))+", "+se(Or.transform(o))+")"}};var Va=Fr(0,255),Pr=Bt(Bt({},Ue),{transform:function(e){return Math.round(Va(e))}}),Vt={test:De("rgb","red"),parse:Lr("red","green","blue"),transform:function(e){var t=e.red,r=e.green,n=e.blue,i=e.alpha,o=i===void 0?1:i;return"rgba("+Pr.transform(t)+", "+Pr.transform(r)+", "+Pr.transform(n)+", "+se(Or.transform(o))+")"}};function Ka(e){var t="",r="",n="",i="";return e.length>5?(t=e.substr(1,2),r=e.substr(3,2),n=e.substr(5,2),i=e.substr(7,2)):(t=e.substr(1,1),r=e.substr(2,1),n=e.substr(3,1),i=e.substr(4,1),t+=t,r+=r,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}var We={test:De("#"),parse:Ka,transform:Vt.transform};var ce={test:function(e){return Vt.test(e)||We.test(e)||Xt.test(e)},parse:function(e){return Vt.test(e)?Vt.parse(e):Xt.test(e)?Xt.parse(e):We.parse(e)},transform:function(e){return $t(e)?e:e.hasOwnProperty("red")?Vt.transform(e):Xt.transform(e)}};var to="${c}",eo="${n}";function Za(e){var t,r,n,i;return isNaN(e)&&$t(e)&&((r=(t=e.match(ze))===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0)+((i=(n=e.match(Mr))===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0)>0}function ro(e){var t=[],r=0,n=e.match(Mr);n&&(r=n.length,e=e.replace(Mr,to),t.push.apply(t,n.map(ce.parse)));var i=e.match(ze);return i&&(e=e.replace(ze,eo),t.push.apply(t,i.map(Ue.parse))),{values:t,numColors:r,tokenised:e}}function no(e){return ro(e).values}function io(e){var t=ro(e),r=t.values,n=t.numColors,i=t.tokenised,o=r.length;return function(s){for(var d=i,k=0;k<o;k++)d=d.replace(k<n?to:eo,k<n?ce.transform(s[k]):se(s[k]));return d}}var qa=function(e){return typeof e=="number"?0:e};function Ya(e){var t=no(e),r=io(e);return r(t.map(qa))}var Rr={test:Za,parse:no,createTransformer:io,getAnimatableNone:Ya};var $a=function(e,t,r){var n=e*e,i=t*t;return Math.sqrt(Math.max(0,r*(i-n)+n))},Xa=[We,Vt,Xt],oo=function(e){return Xa.find(function(t){return t.test(e)})},ao=function(e){return"'"+e+"' is not an animatable color. Use the equivalent color code instead."},zr=function(e,t){var r=oo(e),n=oo(t);Yt(!!r,ao(e)),Yt(!!n,ao(t)),Yt(r.transform===n.transform,"Both colors must be hex/RGBA, OR both must be HSLA.");var i=r.parse(e),o=n.parse(t),s=be({},i),d=r===Xt?_e:$a;return function(k){for(var x in s)x!=="alpha"&&(s[x]=d(i[x],o[x],k));return s.alpha=_e(i.alpha,o.alpha,k),r.transform(s)}};var so=function(e){return typeof e=="number"};var Qa=function(e,t){return function(r){return t(e(r))}},Ur=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(Qa)};function uo(e,t){return so(e)?function(r){return _e(e,t,r)}:ce.test(e)?zr(e,t):An(e,t)}var Sn=function(e,t){var r=Xi(e),n=r.length,i=e.map(function(o,s){return uo(o,t[s])});return function(o){for(var s=0;s<n;s++)r[s]=i[s](o);return r}},fo=function(e,t){var r=be(be({},e),t),n={};for(var i in r)e[i]!==void 0&&t[i]!==void 0&&(n[i]=uo(e[i],t[i]));return function(o){for(var s in n)r[s]=n[s](o);return r}};function co(e){for(var t=Rr.parse(e),r=t.length,n=0,i=0,o=0,s=0;s<r;s++)n||typeof t[s]=="number"?n++:t[s].hue!==void 0?o++:i++;return{parsed:t,numNumbers:n,numRGB:i,numHSL:o}}var An=function(e,t){var r=Rr.createTransformer(t),n=co(e),i=co(t);return Yt(n.numHSL===i.numHSL&&n.numRGB===i.numRGB&&n.numNumbers>=i.numNumbers,"Complex values '"+e+"' and '"+t+"' too different to mix. Ensure all colors are of the same type."),Ur(Sn(n.parsed,i.parsed),r)};var Ja=function(e,t){return function(r){return _e(e,t,r)}};function ts(e){if(typeof e=="number")return Ja;if(typeof e=="string")return ce.test(e)?zr:An;if(Array.isArray(e))return Sn;if(typeof e=="object")return fo}function es(e,t,r){for(var n=[],i=r||ts(e[0]),o=e.length-1,s=0;s<o;s++){var d=i(e[s],e[s+1]);if(t){var k=Array.isArray(t)?t[s]:t;d=Ur(k,d)}n.push(d)}return n}function rs(e,t){var r=e[0],n=e[1],i=t[0];return function(o){return i(En(r,n,o))}}function ns(e,t){var r=e.length,n=r-1;return function(i){var o=0,s=!1;if(i<=e[0]?s=!0:i>=e[n]&&(o=n-1,s=!0),!s){for(var d=1;d<r&&!(e[d]>i||d===n);d++);o=d-1}var k=En(e[o],e[o+1],i);return t[o](k)}}function Tn(e,t,r){var n=r===void 0?{}:r,i=n.clamp,o=i===void 0?!0:i,s=n.ease,d=n.mixer,k=e.length;Yt(k===t.length,"Both input and output ranges must be the same length"),Yt(!s||!Array.isArray(s)||s.length===k-1,"Array of easing functions must be of length `input.length - 1`, as it applies to the transitions **between** the defined values."),e[0]>e[k-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var x=es(t,s,d),b=k===2?rs(e,x):ns(e,x);return o?function(u){return b(Qi(e[0],e[k-1],u))}:b}var sr=function(e){return function(t){return 1-e(1-t)}},Nr=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},lo=function(e){return function(t){return Math.pow(t,e)}},In=function(e){return function(t){return t*t*((e+1)*t-e)}},ho=function(e){var t=In(e);return function(r){return(r*=2)<1?.5*t(r):.5*(2-Math.pow(2,-10*(r-1)))}};var po=1.525,is=4/11,os=8/11,as=9/10,Cn=function(e){return e},Bn=lo(2),ss=sr(Bn),cs=Nr(Bn),mo=function(e){return 1-Math.sin(Math.acos(e))},go=sr(mo),us=Nr(go),Fn=In(po),fs=sr(Fn),ls=Nr(Fn),hs=ho(po),ds=4356/361,ps=35442/1805,ms=16061/1805,vo=function(e){if(e===1||e===0)return e;var t=e*e;return e<is?7.5625*t:e<os?9.075*t-9.9*e+3.4:e<as?ds*t-ps*e+ms:10.8*e*e-20.52*e+10.72},gs=sr(vo);function yo(e,t){if(typeof t=="string"){let r=[];for(let n=0;n<e.length-1;n++)r.push(t);return r}if(e.length-1!==t.length)throw new Error("There must be one fewer interpolator than keyframes");return t}function wo(e,t){if(typeof t=="function"){let r=[];for(let n=0;n<e.length-1;n++)r.push(t);return r}if(e.length-1!==t.length)throw new Error("There must be one fewer easing than keyframes");return t}function xo(e,t){if(typeof t=="number"){let r=[],n=0;for(let i=0;i<e.length;i++)r.push(n),n+=t;return r}if(e.length!==t.length)throw new Error("There must be same number of timings as keyframes");return t}function bo(e,t,r,n){return t.map((o,s)=>s===0?[e[s],{...o,ease:void 0,interpolate:void 0}]:[e[s],{...o,ease:r[s-1],interpolate:n[s-1]}])}function ue(e,t,r=Cn){return Tn([0,1],[e,t],{ease:r})}var Mn=class extends ir{constructor({features:t=[],timings:r,keyframes:n,easings:i=Ht,interpolators:o="linear"}){super([]),this.activeFeatures={},this._setActiveFeatures=this._setActiveFeatures.bind(this),this.getFrame=this.getFrame.bind(this),this.set=this.set.bind(this),this.activeFeatures=t.reduce((s,d)=>(s[d]=!1,s),{}),this.set({timings:r,keyframes:n,easings:i,interpolators:o})}set({timings:t,keyframes:r,easings:n=Ht,interpolators:i="linear"}){if(!r||r.length===0)throw new Error("There must be at least one keyframe");let o=yo(r,i),s=wo(r,n),d=xo(r,t);this._setActiveFeatures(r);let k=bo(d,r,s,o);this.keyframes=r,this.timings=t,this.easings=n,this.interpolators=i,this.setKeyFrames(k)}getFrame(){let t=this.factor,r=this.getStartData(),n=this.getEndData(),i={};return Object.keys(this.activeFeatures).forEach(o=>{this.activeFeatures[o]&&(i[o]=ue(r[o],n[o],n.ease)(t))}),i}_setActiveFeatures(t){let r=t[0];this.activeFeatures=Object.keys(r).reduce((n,i)=>(r[i]!==void 0&&(n[i]=!0),n),this.activeFeatures)}},Ft=Mn;function _o(e,t,r){return r*t+(1-r)*e}function vs(e){return Math.log(e)*Math.LOG2E}var Dr=Math.log2||vs;function cr(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var zt=Math.PI,So=zt/4,ko=zt/180,Eo=180/zt,Wr=512;function ur(e){return Math.pow(2,e)}function On(e){return Dr(e)}function je(e){let[t,r]=e;cr(Number.isFinite(t)),cr(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");let n=t*ko,i=r*ko,o=Wr*(n+zt)/(2*zt),s=Wr*(zt+Math.log(Math.tan(So+i*.5)))/(2*zt);return[o,s]}function ke(e){let[t,r]=e,n=t/Wr*(2*zt)-zt,i=2*(Math.atan(Math.exp(r/Wr*(2*zt)-zt))-So);return[n*Eo,i*Eo]}var Tp=Math.PI/180;var Ao=.01,Fs=["longitude","latitude","zoom"],Ms={curve:1.414,speed:1.2};function jr(e,t,r,n){let{startZoom:i,startCenterXY:o,uDelta:s,w0:d,u1:k,S:x,rho:b,rho2:u,r0:g}=Os(e,t,n);if(k<Ao){let W={};for(let P of Fs){let V=e[P],U=t[P];W[P]=_o(V,U,r)}return W}let c=r*x,m=Math.cosh(g)/Math.cosh(g+b*c),p=d*((Math.cosh(g)*Math.tanh(g+b*c)-Math.sinh(g))/u)/k,_=1/m,T=i+On(_),M=qi([],s,p);Zi(M,M,o);let C=ke(M);return{longitude:C[0],latitude:C[1],zoom:T}}function Os(e,t,r){r=Object.assign({},Ms,r);let n=r.curve,i=e.zoom,o=[e.longitude,e.latitude],s=ur(i),d=t.zoom,k=[t.longitude,t.latitude],x=ur(d-i),b=je(o),u=je(k),g=$i([],u,b),c=Math.max(e.width,e.height),m=c/x,p=Yi(g)*s,_=Math.max(p,Ao),T=n*n,M=(m*m-c*c+T*T*_*_)/(2*c*T*_),C=(m*m-c*c-T*T*_*_)/(2*m*T*_),W=Math.log(Math.sqrt(M*M+1)-M),P=Math.log(Math.sqrt(C*C+1)-C),V=(P-W)/n;return{startZoom:i,startCenterXY:b,uDelta:g,w0:c,u1:p,S:V,rho:n,rho2:T,r0:W,r1:P}}var Ps=["bearing","pitch"],Rs={speed:1.2,curve:1.414};function zs(e,t,r,n){let i=jr(e,t,t.ease(r),{...Rs,...n});for(let o of Ps)i[o]=Br(e[o]||0,t[o]||0,t.ease(r));return i}var Kt=class extends Ft{constructor({timings:t,keyframes:r,easings:n,interpolators:i,width:o,height:s}){super({timings:t,keyframes:r,easings:n,interpolators:i,features:["latitude","longitude","zoom","pitch","bearing"]}),this.width=o,this.height=s}getFrame(){let t=this.factor,r=this.getStartData(),n=this.getEndData();if(n.interpolate==="flyTo"){if(!this.width||!this.height)throw new Error("width and height must be defined to use flyTo interpolator");let i=this.getEndTime()-this.getStartTime();return zs({...r,width:this.width,height:this.height},n,t,{maxDuration:i})}return super.getFrame()}};function Us(e){return e&&e[0]?Object.keys(e[0]):[]}var fe=class extends Ft{constructor({id:t,features:r,timings:n,keyframes:i,easings:o}){super({timings:n,keyframes:i,easings:o,features:r||Us(i)}),this.id=t}};function Ns(e){return e?Object.keys(e.config.visConfig):[]}var Ln=class extends Ft{constructor({layer:t,timings:r,keyframes:n,easings:i}){super({timings:r,keyframes:n,easings:i,features:Ns(t)}),this.layer=t}set({layer:t=void 0,timings:r,keyframes:n,easings:i,interpolators:o}){t&&(this.layer=t),super.set({timings:r,keyframes:n,easings:i,interpolators:o})}},fr=Ln;function To(e){let t=e.value[1]-e.value[0];return{keyframes:[{value:[e.domain[0],e.domain[0]+t]},{value:[e.domain[1]-t,e.domain[1]]}],easings:Ht}}function Ds({filter:e,timings:t}){if(e.type!=="timeRange")throw new Error("filter type must be 'timeRange'.'");let r=t[1]-t[0];switch(e.animationWindow){default:case"free":return To(e);case"incremental":return{keyframes:[{value:[e.value[0],e.value[0]+1]},{value:[e.value[0],e.domain[1]]}],easings:Ht};case"point":return{keyframes:[{value:e.domain[0]},{value:e.domain[1]}],easings:Ht};case"interval":{let{bins:n,plotType:i}=e,{interval:o}=i;if(!o||!n||Object.keys(n).length===0||!Object.values(n)[0][o])return To(e);let s=Object.values(n)[0][o],d=Math.round(r/s.length);return{timings:s.map((k,x)=>t[0]+d*x),keyframes:s.map(k=>({value:[k.x0,k.x1]})),easings:or}}}}var Ge=class extends Ft{constructor({filter:t=void 0,filterIdx:r,timings:n,keyframes:i=void 0,easings:o,interpolators:s,getTimeRangeFilterKeyframes:d=void 0}){if(t?.type==="input")throw new Error("filter type 'input' is not supported.");super(Ge._processParams({filter:t,timings:n,keyframes:i,easings:o,interpolators:s,getTimeRangeFilterKeyframes:d})),this.id=t?.id,this.type=t?.type,this.animationWindow=t?.animationWindow,this.filterIdx=r,this.getTimeRangeFilterKeyframes=d}set({filter:t=void 0,filterIdx:r=void 0,timings:n,keyframes:i,easings:o,interpolators:s}){t&&r&&(this.id=t.id,this.type=t.type,this.animationWindow=t.animationWindow,this.filterIdx=r),super.set(Ge._processParams({filter:t,timings:n,keyframes:i,easings:o,interpolators:s,getTimeRangeFilterKeyframes:this.getTimeRangeFilterKeyframes}))}getFrame(){let t=this.factor,r=this.getStartData(),n=this.getEndData();if(["select","multiSelect","polygon"].includes(this.type||""))return r.value;if(this.type==="range")return[ue(r.value[0],n.value[0],n.ease)(t),ue(r.value[1],n.value[1],n.ease)(t)];if(this.type==="timeRange")switch(this.animationWindow){case"free":case"incremental":return[ue(r.value[0],n.value[0],n.ease)(t),ue(r.value[1],n.value[1],n.ease)(t)];case"point":return ue(r.value,n.value,n.ease)(t);case"interval":default:return r.value}return super.getFrame()}static _processParams({filter:t=void 0,timings:r,keyframes:n=void 0,easings:i,interpolators:o,getTimeRangeFilterKeyframes:s=void 0}){let d={features:["value"],timings:r,keyframes:n,easings:i,interpolators:o};if(t&&t.type==="timeRange"&&n===void 0){if(!Array.isArray(r)||r.length!==2)throw new Error("[start, end] timings required.");d={...d,...s?s({filter:t,timings:r}):Ds({filter:t,timings:r})}}return d}},lr=Ge;function Ws({animationConfig:e}){return{keyframes:[{currentTime:e.domain[0]},{currentTime:e.domain[1]}]}}var He=class extends Ft{constructor({animationConfig:t=void 0,timings:r,keyframes:n=void 0,easings:i,interpolators:o}){super(He._processParams({animationConfig:t,timings:r,keyframes:n,easings:i,interpolators:o}))}set({animationConfig:t=void 0,timings:r,keyframes:n=void 0,easings:i,interpolators:o}){super.set(He._processParams({animationConfig:t,timings:r,keyframes:n,easings:i,interpolators:o}))}static _processParams({animationConfig:t=void 0,timings:r,keyframes:n=void 0,easings:i,interpolators:o}){let s={features:["currentTime"],timings:r,keyframes:n,easings:i,interpolators:o};if(t&&n===void 0){if(!Array.isArray(r)||r.length!==2)throw new Error("[start, end] timings required.");s={...s,...Ws({animationConfig:t})}}return s}},hr=He;function Io(){}var Ve=class extends Gt{constructor({id:t="deck",cameraKeyframe:r=void 0,getLayers:n=d=>[],layerKeyframes:i=[],onLayersUpdate:o=Io,onCameraUpdate:s=Io}){super({id:t}),this.layerKeyframes={},this.layerKeyframes={},this.onLayersUpdate=o,this.onCameraUpdate=s,this.getLayers=n,this.setKeyframes({cameraKeyframe:r,layerKeyframes:i}),this.draw()}setOnLayersUpdate(t){this.onLayersUpdate=t}setOnCameraUpdate(t){this.onCameraUpdate=t}setGetLayers(t){this.getLayers=t,this.draw()}setKeyframes({layerKeyframes:t=[],cameraKeyframe:r=void 0,timeline:n=void 0}){this.cameraKeyframe&&r?this.cameraKeyframe.set(r):r&&(this.cameraKeyframe=new Kt(r),this.unattachedKeyframes.push(this.cameraKeyframe)),t&&t.length>0&&(this.layerKeyframes=t.reduce((i,o)=>(i[o.id]?i[o.id].set(o):(i[o.id]=new fe(o),this.unattachedKeyframes.push(i[o.id])),i),this.layerKeyframes)),n&&this.attachKeyframes(n)}getKeyframes(){return{cameraKeyframe:this.cameraKeyframe,layerKeyframes:this.layerKeyframes}}animator(t){t.cameraKeyframe&&t.onCameraUpdate(t.cameraKeyframe.getFrame()),Object.values(t.layerKeyframes).length>0&&t.onLayersUpdate(this.getLayers(t))}applyLayerKeyframes(t){return t.map(r=>{if(this.layerKeyframes[r.id]){let n=this.layerKeyframes[r.id].getFrame();return r.clone({...n,updateTriggers:n})}return r})}};function Gr(){}function js({layers:e,layerKeyframe:t}){return e.find(r=>r.id===t.id)||e.find(r=>r.config.label===t.label)}function Gs({filters:e,filterKeyframe:t}){return Number.isFinite(t.filterIdx)?t.filterIdx:e.findIndex(r=>r.id===t.id)}var Ke=class extends Gt{constructor({id:t="kepler",layers:r=[],layerKeyframes:n=[],filters:i=[],filterKeyframes:o=[],getTimeRangeFilterKeyframes:s=void 0,animationConfig:d=void 0,tripKeyframe:k=void 0,cameraKeyframe:x=void 0,onTripFrameUpdate:b=Gr,onFilterFrameUpdate:u=Gr,onLayerFrameUpdate:g=Gr,onCameraFrameUpdate:c=Gr}){super({id:t}),this.layerKeyframes={},this.filterKeyframes={},this.tripKeyframe=void 0,this.onTripFrameUpdate=b,this.onFilterFrameUpdate=u,this.onLayerFrameUpdate=g,this.onCameraFrameUpdate=c,this.layerKeyframes={},this.filterKeyframes={},this.setKeyframes({layers:r,layerKeyframes:n,filters:i,filterKeyframes:o,cameraKeyframe:x,animationConfig:d,tripKeyframe:k,getTimeRangeFilterKeyframes:s}),this.draw()}setKeyframes({layers:t=[],layerKeyframes:r=[],filters:n=[],filterKeyframes:i=[],getTimeRangeFilterKeyframes:o=void 0,animationConfig:s=void 0,tripKeyframe:d=void 0,cameraKeyframe:k=void 0,timeline:x=void 0}){this.tripKeyframe&&d?this.tripKeyframe.set({animationConfig:s,...d}):d&&(this.tripKeyframe=new hr({animationConfig:s,...d}),this.unattachedKeyframes.push(this.tripKeyframe)),this.cameraKeyframe&&k?this.cameraKeyframe.set(k):k&&(this.cameraKeyframe=new Kt(k),this.unattachedKeyframes.push(this.cameraKeyframe)),r.length>0&&(this.layerKeyframes=r.reduce((b,u)=>{let g=js({layers:t,layerKeyframe:u});return g&&(b[g.id]?b[g.id].set({layer:g,...u}):(b[g.id]=new fr({layer:g,...u}),this.unattachedKeyframes.push(b[g.id]))),b},this.layerKeyframes)),i.length>0&&(this.filterKeyframes=i.reduce((b,u)=>{let g=Gs({filters:n,filterKeyframe:u}),c=Number.isFinite(g)&&n[g];return c&&(b[c.id]?b[c.id].set({filter:c,...u}):(b[c.id]=new lr({filter:c,filterIdx:g,getTimeRangeFilterKeyframes:o,...u}),this.unattachedKeyframes.push(b[c.id]))),b},this.filterKeyframes)),x&&this.attachKeyframes(x)}getKeyframes(){return{cameraKeyframe:this.cameraKeyframe,layerKeyframes:this.layerKeyframes,filterKeyframes:this.filterKeyframes,tripKeyframe:this.tripKeyframe}}animator(t){t.cameraKeyframe&&t.onCameraFrameUpdate(t.cameraKeyframe.getFrame()),t.tripKeyframe&&t.onTripFrameUpdate(t.tripKeyframe.getFrame().currentTime);for(let r of Object.values(t.filterKeyframes))t.onFilterFrameUpdate(r.filterIdx,"value",r.getFrame());for(let r of Object.values(t.layerKeyframes))t.onLayerFrameUpdate(r.layer,r.getFrame())}};var le=class{constructor({timeline:t=void 0,animations:r=[]}){this.animations={},this.timeline=t||new nr;for(let n of r)this.attachAnimation(n)}attachAnimation(t){t.attachKeyframes(this.timeline),this.animations[t.id]=t}setKeyframes(t,r){this.animations[t].setKeyframes({timeline:this.timeline,...r})}getKeyframes(t){return this.animations[t].getKeyframes()}getAnimation(t){return this.animations[t]}draw(){Object.values(this.animations).forEach(t=>t.draw())}};var Mo=pr(Bo(),1);function Fo(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}var Hr=class{constructor(){this.recording=!1,this.capturing=!1,this.timeMs=0,this.onStop=null,this.recording=!1,this.capturing=!1,this.timeMs=0,this.timecode=null,this.encoder=null,this.filename=null,this._getNextTimeMs=this._getNextTimeMs.bind(this),this._step=this._step.bind(this),this._capture=this._capture.bind(this),this.capture=this.capture.bind(this),this.render=this.render.bind(this),this.download=this.download.bind(this),this.stop=this.stop.bind(this),this._save=this._save.bind(this)}isRecording(){return this.recording}render({Encoder:t,formatConfigs:r,timecode:n,filename:i=void 0,onStop:o=void 0}){this.isRecording()||(console.time("render"),this.filename=this._sanitizeFilename(i),this.timecode=this._sanatizeTimecode(n),console.log(`Starting recording for ${this.timecode.duration}ms.`),this.onStop=o,this.encoder=new t({...r,framerate:this.timecode.framerate}),this.recording=!0,this.encoder.start())}capture(t,r){!this.capturing&&this.isRecording()&&(this.capturing=!0,this._capture(t).then(n=>{this.capturing=!1,n.kind==="next-frame"?r(n.nextTimeMs):n.kind==="stop"?this.onStop?.():console.log(n)}))}stop({onComplete:t=void 0,onSave:r=void 0,onStopped:n=void 0,abort:i=!1}){if(this.isRecording()){console.log(`Stopped recording. Recorded for ${this.timeMs}ms.`),this.recording=!1,this.capturing=!1,n&&n(),console.timeEnd("render");let o=()=>{t&&t(),this.timecode=null,this.onStop=void 0};i||this._save(r).then(o),o()}}download(t){return t&&(0,Mo.default)(t,this.filename+this.encoder.extension,this.encoder.mimeType),!1}async _save(t){t||(t=this.download),console.time("save"),await this.encoder.save().then(t).then(()=>console.timeEnd("save"))}_sanitizeFilename(t){return t||(t=Fo()),t}_sanatizeTimecode(t){let r={duration:void 0,...t};if(r.start||(r.start=0),this.timeMs=r.start,r.duration||(r.duration=r.end-r.start),r.duration<=0)throw new Error(`Invalid recording length (${r.duration}ms).  Must be greater than 0.`);return r}async _capture(t){return this.isRecording()?await this.encoder.add(t).then(this._step).catch(r=>({kind:"error",error:r})):{kind:"error",error:"NOT_RECORDING"}}_step(){let t=this._getNextTimeMs();return t>this.timecode.end?{kind:"stop"}:(this.timeMs=t,{kind:"next-frame",nextTimeMs:t})}_getNextTimeMs(){let t=Math.floor(1e3/this.timecode.framerate);return this.timeMs+t}};var Ze=class{constructor({animationManager:t=void 0,glContext:r=void 0}){this.animationManager=t||new le({}),this.glContext=r,this.videoCapture=new Hr,this.shouldAnimate=!1,this.enabled=!1,this.getProps=this.getProps.bind(this),this.render=this.render.bind(this),this.stop=this.stop.bind(this),this.seek=this.seek.bind(this)}setDeck(t){this.deck=t}getProps({deck:t,onNextFrame:r=void 0,extraProps:n=void 0}){t&&(this.deck=t);let i={_animate:this.shouldAnimate};return r&&(i.onAfterRender=()=>this.onAfterRender(r)),this.enabled?i.controller=!1:i.controller=!0,this.glContext&&(i.gl=this.glContext),{...n,...i}}render({Encoder:t=oe,formatConfigs:r={},filename:n=void 0,timecode:i={start:0,end:0,framerate:30},onStopped:o=void 0,onSave:s=void 0,onComplete:d=void 0}){this.shouldAnimate=!0,this.videoCapture.render({Encoder:t,formatConfigs:r,timecode:i,filename:n,onStop:()=>this.stop({onStopped:o,onSave:s,onComplete:d})}),this.enabled=!0,this.seek({timeMs:i.start})}stop({onStopped:t,onSave:r,onComplete:n,abort:i}){this.enabled=!1,this.shouldAnimate=!1,this.videoCapture.stop({onStopped:t,onSave:r,onComplete:n,abort:i})}seek({timeMs:t}){this.animationManager.timeline.setTime(t),this.animationManager.draw()}onAfterRender(t,r=!0){let n=this.deck&&this.deck.props.layers.every(i=>i.isLoaded);if(this.videoCapture.isRecording()&&n&&r){let i=this.deck.canvas;this.videoCapture.capture(i,o=>{this.seek({timeMs:o}),t(o)})}}};return Uo(Hs);})();
/*! Bundled license information:

jszip/dist/jszip.min.js:
  (*!
  
  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>
  
  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
  
  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  *)

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
      return __exports__;
      });
