"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getFieldsFromTile = void 0;
exports.getFilterProps = getFilterProps;
exports.getMetaUrl = getMetaUrl;
exports.getTileUrl = getTileUrl;
exports.isTileDataset = isTileDataset;
exports.matchDatasetType = matchDatasetType;
exports.parseVectorMetadata = parseVectorMetadata;
var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));
var _typeAnalyzer = require("type-analyzer");
var _d3Array = require("d3-array");
var _console = _interopRequireDefault(require("global/console"));
var _uniq = _interopRequireDefault(require("lodash/uniq"));
var _mvt = require("@loaders.gl/mvt");
var _pmtiles = require("@loaders.gl/pmtiles");
var _commonUtils = require("@kepler.gl/common-utils");
var _constants = require("@kepler.gl/constants");
var _utils = require("@kepler.gl/utils");
function _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t["return"] || t["return"](); } finally { if (u) throw o; } } }; }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2["default"])(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; } // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function isTileDataset(dataset) {
  return Boolean((dataset === null || dataset === void 0 ? void 0 : dataset.type) === _constants.DatasetType.VECTOR_TILE);
}
// https://github.com/mapbox/tilejson-spec/tree/master/2.2.0
function isLat(num) {
  return Number.isFinite(num) && num <= 90 && num >= -90;
}
function isLng(num) {
  return Number.isFinite(num) && num <= 180 && num >= -180;
}
function isZoom(num) {
  return Number.isFinite(num) && num >= 0 && num <= 22;
}
function fromArrayOrString(data) {
  if (typeof data === 'string') {
    return data.split(',').map(parseFloat);
  } else if (Array.isArray(data)) {
    return data;
  }
  return null;
}
function parseCenter(center) {
  // supported formats
  // string: "-96.657715,40.126127,-90.140061,43.516689",
  // array: [-91.505127,41.615442,14]
  var result = fromArrayOrString(center);
  if (Array.isArray(result) && result.length === 3 && isLng(result[0]) && isLat(result[1]) && isZoom(result[2])) {
    return result;
  }
  return null;
}

/**
 * bounds should be [minLng, minLat, maxLng, maxLat]
 * @param {*} bounds
 */
function parseBounds(bounds) {
  // supported formats
  // string: "-96.657715,40.126127,-90.140061,43.516689",
  // array: [ -180, -85.05112877980659, 180, 85.0511287798066 ]
  var result = fromArrayOrString(bounds);
  // validate bounds
  if (Array.isArray(result) && result.length === 4 && [result[0], result[2]].every(isLng) && [result[1], result[3]].every(isLat)) {
    return result;
  }
  return null;
}
var X_PATT = /\{x\}/;
var Y_PATT = /\{y\}/;
var Z_PATT = /\{z\}/;
function isFullyQualifiedTileUrl(tileUrl) {
  return X_PATT.test(tileUrl) && Y_PATT.test(tileUrl) && Z_PATT.test(tileUrl);
}

/**
 * Normalize tile URL
 * @param  {string} tileUrl Initial tile URL, which may be either the root URL for the
 *                          tileset or a fully qualified template
 * @param  {function} validateUrl function to validate tile URL
 * @return {string|null}    Fully qualified tile URL template, or null if input does not
 *                          appear to be a valid URL
 */
function getTileUrl(tileUrl) {
  var validateUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : isFullyQualifiedTileUrl;
  // Check for a valid URL. Ideally we'd have a simple method here.
  var uriParts = (0, _commonUtils.parseUri)(tileUrl);
  if (!uriParts.protocol || !uriParts.host) {
    return null;
  }
  if (validateUrl(tileUrl)) {
    return tileUrl;
  }
  return "".concat(tileUrl.replace(/\/$/, ''), "/{z}/{x}/{y}.pbf");
}

/**
 * Map of util functions for different tileset types, keyed by host
 */
var TILESET_FUNCTIONS = {
  'api.mapbox.com': {
    getMetaUrl: getMetaUrlMapbox,
    parseMetadata: parseMetadataTileJSON
  },
  "default": {
    getMetaUrl: getMetaUrlTippecanoe,
    parseMetadata: parseMetadataTileJSON
  }
};
function getTilesetFunctions(tileUrl) {
  var host = '';
  try {
    host = new URL(tileUrl || '').hostname;
  } catch (error) {
    // do nothing
  }
  return TILESET_FUNCTIONS[host] || TILESET_FUNCTIONS["default"];
}

/**
 * Get the metadata URL for a given tileset
 */
function getMetaUrl(tileUrl) {
  return getTilesetFunctions(tileUrl).getMetaUrl(tileUrl);
}
/**
 * Parse the metadata for a given tileset
 */
function parseVectorMetadata(
// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types
metadata, option) {
  var _ref = option || {},
    _ref$tileUrl = _ref.tileUrl,
    tileUrl = _ref$tileUrl === void 0 ? '' : _ref$tileUrl;
  return getTilesetFunctions(tileUrl).parseMetadata(metadata);
}
var MAPBOX_URL_PATT = /\/\{z\}\/\{x\}\/\{y\}\.mvt/;
function getMetaUrlMapbox() {
  var tileUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  return tileUrl.replace(MAPBOX_URL_PATT, '.json');
}
function parseMetadataTileJSON(metadata) {
  var _parsed$fields;
  var parsed = parseMetadataTippecanoeFromDataSource(metadata);
  if (!parsed) return null;

  // PMTiles can potentially be in RasterTile format
  var mimeType = metadata.tileMIMEType;
  if (mimeType) {
    parsed.pmtilesType = mimeType === 'application/vnd.mapbox-vector-tile' ? _constants.PMTilesType.MVT : _constants.PMTilesType.RASTER;
  }

  // Fields already parsed from `json` property
  if ((_parsed$fields = parsed.fields) !== null && _parsed$fields !== void 0 && _parsed$fields.length) {
    return parsed;
  }
  return parsed;
}
function getMetaUrlTippecanoe(tileUrl) {
  var url = getTileUrl(tileUrl);
  if (!url) return null;
  // assumes the structure <url_base>/{z}...
  var baseUrl = url.split(Z_PATT)[0].replace(/\/$/, '');
  return "".concat(baseUrl, "/metadata.json");
}

/**
 * Special parsing for metadata returned by MVTSource and PMTilesSource.
 * @param metadata Tileset metadata parsed by a DataSouce
 * @returns Metadata in Kepler-friendly format.
 */
function parseMetadataTippecanoeFromDataSource(metadata) {
  var _pmTileMetadata$tilej, _pmTileMetadata$tilej2;
  if (!metadata || (0, _typeof2["default"])(metadata) !== 'object') {
    return null;
  }
  var result = {
    attributions: [],
    metaJson: null,
    bounds: null,
    center: null,
    maxZoom: null,
    minZoom: null,
    fields: []
  };
  var mvtMetadata = metadata;
  var pmTileMetadata = metadata;

  // try to parse metaJson
  if (typeof mvtMetadata.metaJson === 'string') {
    try {
      result.metaJson = JSON.parse(mvtMetadata.metaJson);
    } catch (err) {
      // do nothing
    }
  } else if ((0, _typeof2["default"])(mvtMetadata.metaJson) === 'object') {
    result.metaJson = mvtMetadata.metaJson;
  }
  result.bounds = parseBounds(Array.isArray(metadata.boundingBox) ? metadata.boundingBox.flat() : '');

  // PMTileSource has centerZoom and center [lon, lat], MVTSource - [lon, lat, zoom]
  var center = pmTileMetadata.centerZoom !== undefined && Array.isArray(metadata.center) ? [].concat((0, _toConsumableArray2["default"])(metadata.center), [pmTileMetadata.centerZoom]) : metadata.center;
  result.center = parseCenter(center || '');
  result.maxZoom = safeParseFloat(metadata.maxZoom);
  result.minZoom = safeParseFloat(metadata.minZoom);
  result.name = metadata.name || '';
  result.description = mvtMetadata.description || ((_pmTileMetadata$tilej = pmTileMetadata.tilejson) === null || _pmTileMetadata$tilej === void 0 ? void 0 : _pmTileMetadata$tilej.description) || '';
  if (Array.isArray((_pmTileMetadata$tilej2 = pmTileMetadata.tilejson) === null || _pmTileMetadata$tilej2 === void 0 ? void 0 : _pmTileMetadata$tilej2.layers)) {
    var _pmTileMetadata$tilej3;
    var layers = pmTilesLayerToTippecanoeLayer((_pmTileMetadata$tilej3 = pmTileMetadata.tilejson) === null || _pmTileMetadata$tilej3 === void 0 ? void 0 : _pmTileMetadata$tilej3.layers);
    result.fields = collectAttributes(layers);
  } else if (Array.isArray(mvtMetadata.layers)) {
    var _layers = pmTilesLayerToTippecanoeLayer(mvtMetadata.layers);
    result.fields = collectAttributes(_layers);
  }
  result = _objectSpread(_objectSpread({}, result), {}, {
    attributions: pmTileMetadata.attributions || (mvtMetadata.htmlAttribution ? [mvtMetadata.htmlAttribution] : undefined) || []
  }, parseMetaJson(result.metaJson));
  return result;
}
function safeParseFloat(input) {
  var result = typeof input === 'string' ? parseFloat(input) : typeof input === 'number' ? input : null;
  return result === null || isNaN(result) ? null : result;
}
function parseMetaJson(metaJson) {
  if (!metaJson || (0, _typeof2["default"])(metaJson) !== 'object') {
    return null;
  }
  if (metaJson.tilestats && Array.isArray(metaJson.tilestats.layers)) {
    // we are in luck!
    return {
      fields: collectAttributes(metaJson.tilestats.layers)
    };
  }
  return null;
}
function getTimeAnimationDomain(mappedValue) {
  var timeSteps = (0, _uniq["default"])(mappedValue).sort(_d3Array.ascending).filter(_commonUtils.notNullorUndefined);
  var domain = [timeSteps[0], timeSteps[timeSteps.length - 1]];

  // if taks 10 * 1000 ms to finish the entire animation
  var duration = 10000 / timeSteps.length;
  var clamped = (0, _utils.clamp)([100, 2000], duration);
  return {
    domain: domain,
    timeSteps: timeSteps,
    duration: clamped,
    mappedValue: mappedValue
  };
}
var pmTileTypeToAttrMap = {
  float32: 'number',
  string: 'string',
  utf8: 'string',
  "int": 'int',
  "boolean": 'boolean'
};

/**
 * Transform TileJSON['layers'] back to TippecanoeLayer
 */
function pmTilesLayerToTippecanoeLayer(layers) {
  if (!layers) return [];
  var outLayers = [];
  var _iterator = _createForOfIteratorHelper(layers),
    _step;
  try {
    for (_iterator.s(); !(_step = _iterator.n()).done;) {
      var layer = _step.value;
      var _ref2 = layer || {},
        _ref2$fields = _ref2.fields,
        fields = _ref2$fields === void 0 ? [] : _ref2$fields;
      var _iterator2 = _createForOfIteratorHelper(fields),
        _step2;
      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var _pmField$values;
          var pmField = _step2.value;
          var attribute = {
            attribute: pmField.name,
            type: pmTileTypeToAttrMap[pmField.type],
            count: pmField.uniqueValueCount,
            values: (_pmField$values = pmField.values) !== null && _pmField$values !== void 0 ? _pmField$values : [],
            min: pmField.min,
            max: pmField.max
          };
          outLayers.push({
            attributes: [attribute]
          });
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }
    }
  } catch (err) {
    _iterator.e(err);
  } finally {
    _iterator.f();
  }
  return outLayers;
}
function collectAttributes() {
  var layers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var fields = {};
  var indexedAttributes = {};
  var _iterator3 = _createForOfIteratorHelper(layers),
    _step3;
  try {
    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
      var layer = _step3.value;
      var _ref3 = layer || {},
        _ref3$attributes = _ref3.attributes,
        attributes = _ref3$attributes === void 0 ? [] : _ref3$attributes;
      var _iterator5 = _createForOfIteratorHelper(attributes),
        _step5;
      try {
        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
          var attr = _step5.value;
          var _name = attr.attribute;
          if (typeof _name === 'string') {
            // eslint-disable-next-line max-depth
            if (_name.split('|').length > 1) {
              // indexed field
              var fname = _name.split('|')[0];
              indexedAttributes[fname] = indexedAttributes[fname] || [];
              indexedAttributes[fname].push(attr);
            } else if (!fields[_name]) {
              fields[_name] = attributeToField(attr);
            } else {
              mergeAttributeDomain(fields[_name], attr);
            }
          }
        }
      } catch (err) {
        _iterator5.e(err);
      } finally {
        _iterator5.f();
      }
    }

    // parse indexed attribute, and put index key unidentified back as normal field
  } catch (err) {
    _iterator3.e(err);
  } finally {
    _iterator3.f();
  }
  for (var _i = 0, _Object$entries = Object.entries(indexedAttributes); _i < _Object$entries.length; _i++) {
    var _Object$entries$_i = (0, _slicedToArray2["default"])(_Object$entries[_i], 2),
      name = _Object$entries$_i[0],
      attrs = _Object$entries$_i[1];
    var _parseIndexedField = parseIndexedField(name, attrs),
      indexedField = _parseIndexedField.indexedField,
      unidentified = _parseIndexedField.unidentified;
    fields[indexedField.name] = indexedField;
    var _iterator4 = _createForOfIteratorHelper(unidentified),
      _step4;
    try {
      for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
        var unidentifiedAttr = _step4.value;
        if (unidentifiedAttr.attribute) {
          fields[unidentifiedAttr.attribute] = fields[unidentifiedAttr.attribute] || attributeToField(unidentifiedAttr);
          mergeAttributeDomain(fields[unidentifiedAttr.attribute], unidentifiedAttr);
        }
      }
    } catch (err) {
      _iterator4.e(err);
    } finally {
      _iterator4.f();
    }
  }
  return Object.values(fields);
}
function getIndexKeyFromFieldName(name) {
  return name && name.split('|').length > 1 ? name.split('|')[1] : null;
}
function parseIndexedField(name, attrs) {
  var unidentified = [];
  // analyze time format
  var field;
  var _iterator6 = _createForOfIteratorHelper(attrs),
    _step6;
  try {
    for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
      var attr = _step6.value;
      var fieldName = attr.attribute;
      var indexKey = getIndexKeyFromFieldName(fieldName || '');
      var analyzedType = indexKey && (0, _commonUtils.containValidTime)([indexKey]);
      if (analyzedType) {
        field = field || _objectSpread(_objectSpread({}, attributeToField(attr)), {}, {
          // overide name and id to truncated name
          name: name,
          id: name,
          indexBy: {
            format: analyzedType.format,
            type: (0, _commonUtils.analyzerTypeToFieldType)(analyzedType.type),
            mappedValue: {}
          }
        });
        mergeAttributeDomain(field, attr);
        // save epoch time in mappedValue
        var fieldTs = indexKey;
        if (analyzedType.format === 'x' || analyzedType.format === 'X') {
          fieldTs = Number(indexKey);
        }
        var epoch = (0, _utils.timeToUnixMilli)(fieldTs, analyzedType.format);
        if (epoch) {
          field.indexBy.mappedValue[epoch] = fieldName;
        }
      } else {
        // key is not valid timestamp
        unidentified.push(attr);
      }
    }
  } catch (err) {
    _iterator6.e(err);
  } finally {
    _iterator6.f();
  }
  if (field.indexBy && field.indexBy.type === _constants.ALL_FIELD_TYPES.timestamp) {
    field.indexBy.timeDomain = getTimeAnimationDomain(Object.keys(field.indexBy.mappedValue).map(Number));
  }
  return {
    unidentified: unidentified,
    indexedField: field
  };
}
function compare(num1, num2, operator) {
  return Number.isFinite(num1) && Number.isFinite(num2) ? Math[operator](num1, num2) : Number.isFinite(num1) ? num1 : Number.isFinite(num2) ? num2 : NaN;
}
function getFilterProps(fieldType, attribute) {
  switch (fieldType) {
    case _constants.ALL_FIELD_TYPES.real:
    case _constants.ALL_FIELD_TYPES.integer:
      {
        var _getAttributeDomain = getAttributeDomain(fieldType, attribute),
          _getAttributeDomain2 = (0, _slicedToArray2["default"])(_getAttributeDomain, 2),
          min = _getAttributeDomain2[0],
          max = _getAttributeDomain2[1];
        var diff = max - min;
        var step = (0, _utils.getNumericStepSize)(diff) || 0.1;
        var domain = [(0, _utils.formatNumberByStep)(min, step, 'floor'), (0, _utils.formatNumberByStep)(max, step, 'ceil')];
        var filterProps = {
          domain: domain,
          value: domain,
          type: _constants.FILTER_TYPES.range,
          typeOptions: [_constants.FILTER_TYPES.range],
          gpu: true,
          step: step
        };
        return filterProps;
      }
    case _constants.ALL_FIELD_TYPES["boolean"]:
      {
        // Represent boolean as numeric range [0,1] to enable GPU filtering for vector tiles
        var _domain = [0, 1];
        var _filterProps = {
          domain: _domain,
          value: _domain,
          type: _constants.FILTER_TYPES.range,
          typeOptions: [_constants.FILTER_TYPES.range],
          gpu: true,
          step: 1
        };
        return _filterProps;
      }
    default:
      {
        // Assume string for all other fields
        var _filterProps2 = {
          domain: attribute.values,
          value: attribute.values,
          type: _constants.FILTER_TYPES.multiSelect,
          gpu: false
        };
        return _filterProps2;
      }
  }
}
function attributeToField() {
  var attribute = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
    values: []
  };
  // attribute: "_season_peaks_color"
  // count: 1000
  // max: 0.95
  // min: 0.24375
  // type: "number"
  var fieldTypes = attributeTypeToFieldType(attribute.type);
  return _objectSpread({
    name: attribute.attribute,
    id: attribute.attribute,
    format: '',
    filterProps: getFilterProps(fieldTypes.type, attribute)
  }, fieldTypes);
}
function getAttributeDomain(type, attribute) {
  switch (type) {
    case _constants.ALL_FIELD_TYPES.real:
    case _constants.ALL_FIELD_TYPES.integer:
      return [Number.isFinite(attribute.min) ? attribute.min : NaN, Number.isFinite(attribute.max) ? attribute.max : NaN];
    case _constants.ALL_FIELD_TYPES["boolean"]:
      return [0, 1];
    default:
      return [0, 1];
  }
}

/**
 * @param field This function mutates the field parameter
 */
function mergeAttributeDomain(field, attribute) {
  switch (field.type) {
    case _constants.ALL_FIELD_TYPES.real:
    case _constants.ALL_FIELD_TYPES.integer:
      {
        var _field$metadata, _field$filterProps;
        var domain = ((_field$metadata = field.metadata) === null || _field$metadata === void 0 ? void 0 : _field$metadata.domain) || ((_field$filterProps = field.filterProps) === null || _field$filterProps === void 0 ? void 0 : _field$filterProps.domain);
        if (domain) {
          domain.min = compare(attribute.min, domain[0], 'min');
          domain.max = compare(attribute.max, domain[1], 'max');
        }
        return;
      }
    default:
      return;
  }
}

// possible types https://github.com/mapbox/tippecanoe#modifying-feature-attributes
var attrTypeMap = {
  number: {
    type: _constants.ALL_FIELD_TYPES.real,
    analyzerType: _typeAnalyzer.DATA_TYPES.FLOAT
  },
  numeric: {
    type: _constants.ALL_FIELD_TYPES.real,
    analyzerType: _typeAnalyzer.DATA_TYPES.FLOAT
  },
  string: {
    type: _constants.ALL_FIELD_TYPES.string,
    analyzerType: _typeAnalyzer.DATA_TYPES.STRING
  },
  vachar: {
    type: _constants.ALL_FIELD_TYPES.string,
    analyzerType: _typeAnalyzer.DATA_TYPES.STRING
  },
  "float": {
    type: _constants.ALL_FIELD_TYPES.real,
    analyzerType: _typeAnalyzer.DATA_TYPES.FLOAT
  },
  "int": {
    type: _constants.ALL_FIELD_TYPES.integer,
    analyzerType: _typeAnalyzer.DATA_TYPES.INT
  },
  int4: {
    type: _constants.ALL_FIELD_TYPES.integer,
    analyzerType: _typeAnalyzer.DATA_TYPES.INT
  },
  "boolean": {
    type: _constants.ALL_FIELD_TYPES["boolean"],
    analyzerType: _typeAnalyzer.DATA_TYPES.BOOLEAN
  },
  bool: {
    type: _constants.ALL_FIELD_TYPES["boolean"],
    analyzerType: _typeAnalyzer.DATA_TYPES.BOOLEAN
  }
};
function attributeTypeToFieldType(aType) {
  var type = aType === null || aType === void 0 ? void 0 : aType.toLowerCase();
  if (!type || !attrTypeMap[type]) {
    _console["default"].warn("cannot convert attribute type ".concat(type, " to kepler.gl data type, use string by default"));
    return attrTypeMap.string;
  }
  return attrTypeMap[type];
}

/**
 * Returns true if a dataset can be used as source data for a layer.
 * @param dataset A dataset.
 * @param layer A layer.
 * @returns Returns true if a dataset can be used as source data for a layer.
 */
function matchDatasetType(dataset, layer) {
  // allow selection if type is not assigned yet
  if (!layer.type) {
    return true;
  }
  // allow selection if is current selected dataset
  if (layer.config.dataId === dataset.id) {
    return true;
  }
  // allow selection if layer doesn't have supportedDatasetTypes
  if (!layer.supportedDatasetTypes) {
    return true;
  }
  return Array.isArray(layer.supportedDatasetTypes) && layer.supportedDatasetTypes.includes(dataset.type || '');
}
/**
 * Extracts fields from a tile and updates the metadata object with found fields.
 * Note: this function is for tilesets that don't include fields in metadata (most likely saved with older spec.).
 * @param params.remoteTileFormat The format of the remote tile (MVT or PMTiles).
 * @param params.tilesetUrl The URL of the tileset.
 * @param params.metadataUrl The URL of the metadata.
 * @param params.metadata The metadata object containing fields and tile properties.
 */
var getFieldsFromTile = exports.getFieldsFromTile = /*#__PURE__*/function () {
  var _ref5 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(_ref4) {
    var remoteTileFormat, tilesetUrl, metadataUrl, metadata, _metadata$fields, _metadata$bounds, lon, lat, tileIndices, tileSource, tile, updatedFields;
    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) switch (_context.prev = _context.next) {
        case 0:
          remoteTileFormat = _ref4.remoteTileFormat, tilesetUrl = _ref4.tilesetUrl, metadataUrl = _ref4.metadataUrl, metadata = _ref4.metadata;
          _context.prev = 1;
          if (!(tilesetUrl && metadataUrl && metadata && ((_metadata$fields = metadata.fields) === null || _metadata$fields === void 0 ? void 0 : _metadata$fields.length) === 0 && metadata.minZoom && ((_metadata$bounds = metadata.bounds) === null || _metadata$bounds === void 0 ? void 0 : _metadata$bounds.length) === 4 && (!metadata.pmtilesType || metadata.pmtilesType === _constants.PMTilesType.MVT))) {
            _context.next = 12;
            break;
          }
          lon = (metadata.bounds[0] + metadata.bounds[2]) / 2;
          lat = (metadata.bounds[1] + metadata.bounds[3]) / 2;
          tileIndices = lonLatToTileIndex(lon, lat, metadata.minZoom);
          tileSource = remoteTileFormat === _constants.RemoteTileFormat.MVT ? _mvt.MVTSource.createDataSource(decodeURIComponent(tilesetUrl), {
            mvt: {
              metadataUrl: decodeURIComponent(metadataUrl)
            }
          }) : _pmtiles.PMTilesSource.createDataSource(tilesetUrl, {});
          _context.next = 9;
          return tileSource.getTileData({
            index: tileIndices
          });
        case 9:
          tile = _context.sent;
          updatedFields = tileToFields(tile).map(function (f) {
            return _objectSpread(_objectSpread({}, f), {}, {
              analyzerType: f.analyzerType || _constants.ALL_FIELD_TYPES.string,
              id: f.id || f.name
            });
          });
          metadata.fields = updatedFields;
        case 12:
          _context.next = 16;
          break;
        case 14:
          _context.prev = 14;
          _context.t0 = _context["catch"](1);
        case 16:
        case "end":
          return _context.stop();
      }
    }, _callee, null, [[1, 14]]);
  }));
  return function getFieldsFromTile(_x) {
    return _ref5.apply(this, arguments);
  };
}();

/**
 * Converts tile features into Kepler fields.
 * @param tile The tile object containing features.
 * @returns An array of Kepler fields derived from the tile's features.
 */
var tileToFields = function tileToFields(tile) {
  var _tile$features;
  if ((tile === null || tile === void 0 || (_tile$features = tile.features) === null || _tile$features === void 0 ? void 0 : _tile$features.length) > 0) {
    var header = Object.keys(tile.features[0].properties);
    var output = tile.features.map(function (f) {
      var obj = {};
      header.forEach(function (columnName) {
        obj[columnName] = f.properties[columnName];
      });
      return obj;
    });
    var fields = (0, _commonUtils.getFieldsFromData)(output, header);
    // extra transformation of strings to numbers for tiles isn't implemented, so use string, not computed types
    return fields.map(function (f) {
      var forceString = (f.type === 'integer' || f.type === 'float') && typeof tile.features[0].properties[f.name] === 'string';
      return _objectSpread(_objectSpread({}, f), {}, {
        analyzerType: forceString ? _typeAnalyzer.DATA_TYPES.STRING : f.analyzerType,
        type: forceString ? 'string' : f.type
      });
    });
  }
  return [];
};

/**
 * Converts longitude, latitude, and zoom level into vector tile indices (x, y, z).
 * @param lon Longitude in degrees, ranging from -180 to 180.
 * @param lat Latitude in degrees, ranging from -90 to 90.
 * @param zoom Zoom level (integer), where higher values provide more detail.
 * @returns Tile indices with x and y coordinates and zoom level z.
 */
function lonLatToTileIndex(lon, lat, zoom) {
  if (lat < -85.0511 || lat > 85.0511) {
    throw new Error('Latitude out of range. Must be between -85.0511 and 85.0511.');
  }
  if (zoom < 0) {
    throw new Error('Zoom level must be a non-negative integer.');
  }

  // 2^zoom (number of tiles per axis at given zoom level)
  var scale = 1 << zoom;
  // Convert longitude to tile X
  var x = Math.floor((lon + 180) / 360 * scale);
  // Convert latitude to tile Y
  var latRad = lat * Math.PI / 180;
  var y = Math.floor((1 - Math.log(Math.tan(latRad) + 1 / Math.cos(latRad)) / Math.PI) / 2 * scale);
  return {
    x: x,
    y: y,
    z: zoom
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdHlwZUFuYWx5emVyIiwicmVxdWlyZSIsIl9kM0FycmF5IiwiX2NvbnNvbGUiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3VuaXEiLCJfbXZ0IiwiX3BtdGlsZXMiLCJfY29tbW9uVXRpbHMiLCJfY29uc3RhbnRzIiwiX3V0aWxzIiwiX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiLCJyIiwiZSIsInQiLCJTeW1ib2wiLCJpdGVyYXRvciIsIkFycmF5IiwiaXNBcnJheSIsIl91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheSIsImxlbmd0aCIsIl9uIiwiRiIsInMiLCJuIiwiZG9uZSIsInZhbHVlIiwiZiIsIlR5cGVFcnJvciIsIm8iLCJhIiwidSIsImNhbGwiLCJuZXh0IiwiX2FycmF5TGlrZVRvQXJyYXkiLCJ0b1N0cmluZyIsInNsaWNlIiwiY29uc3RydWN0b3IiLCJuYW1lIiwiZnJvbSIsInRlc3QiLCJvd25LZXlzIiwiT2JqZWN0Iiwia2V5cyIsImdldE93blByb3BlcnR5U3ltYm9scyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwiZm9yRWFjaCIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlZmluZVByb3BlcnR5IiwiaXNUaWxlRGF0YXNldCIsImRhdGFzZXQiLCJCb29sZWFuIiwidHlwZSIsIkRhdGFzZXRUeXBlIiwiVkVDVE9SX1RJTEUiLCJpc0xhdCIsIm51bSIsIk51bWJlciIsImlzRmluaXRlIiwiaXNMbmciLCJpc1pvb20iLCJmcm9tQXJyYXlPclN0cmluZyIsImRhdGEiLCJzcGxpdCIsIm1hcCIsInBhcnNlRmxvYXQiLCJwYXJzZUNlbnRlciIsImNlbnRlciIsInJlc3VsdCIsInBhcnNlQm91bmRzIiwiYm91bmRzIiwiZXZlcnkiLCJYX1BBVFQiLCJZX1BBVFQiLCJaX1BBVFQiLCJpc0Z1bGx5UXVhbGlmaWVkVGlsZVVybCIsInRpbGVVcmwiLCJnZXRUaWxlVXJsIiwidmFsaWRhdGVVcmwiLCJ1bmRlZmluZWQiLCJ1cmlQYXJ0cyIsInBhcnNlVXJpIiwicHJvdG9jb2wiLCJob3N0IiwiY29uY2F0IiwicmVwbGFjZSIsIlRJTEVTRVRfRlVOQ1RJT05TIiwiZ2V0TWV0YVVybCIsImdldE1ldGFVcmxNYXBib3giLCJwYXJzZU1ldGFkYXRhIiwicGFyc2VNZXRhZGF0YVRpbGVKU09OIiwiZ2V0TWV0YVVybFRpcHBlY2Fub2UiLCJnZXRUaWxlc2V0RnVuY3Rpb25zIiwiVVJMIiwiaG9zdG5hbWUiLCJlcnJvciIsInBhcnNlVmVjdG9yTWV0YWRhdGEiLCJtZXRhZGF0YSIsIm9wdGlvbiIsIl9yZWYiLCJfcmVmJHRpbGVVcmwiLCJNQVBCT1hfVVJMX1BBVFQiLCJfcGFyc2VkJGZpZWxkcyIsInBhcnNlZCIsInBhcnNlTWV0YWRhdGFUaXBwZWNhbm9lRnJvbURhdGFTb3VyY2UiLCJtaW1lVHlwZSIsInRpbGVNSU1FVHlwZSIsInBtdGlsZXNUeXBlIiwiUE1UaWxlc1R5cGUiLCJNVlQiLCJSQVNURVIiLCJmaWVsZHMiLCJ1cmwiLCJiYXNlVXJsIiwiX3BtVGlsZU1ldGFkYXRhJHRpbGVqIiwiX3BtVGlsZU1ldGFkYXRhJHRpbGVqMiIsIl90eXBlb2YyIiwiYXR0cmlidXRpb25zIiwibWV0YUpzb24iLCJtYXhab29tIiwibWluWm9vbSIsIm12dE1ldGFkYXRhIiwicG1UaWxlTWV0YWRhdGEiLCJKU09OIiwicGFyc2UiLCJlcnIiLCJib3VuZGluZ0JveCIsImZsYXQiLCJjZW50ZXJab29tIiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsInNhZmVQYXJzZUZsb2F0IiwiZGVzY3JpcHRpb24iLCJ0aWxlanNvbiIsImxheWVycyIsIl9wbVRpbGVNZXRhZGF0YSR0aWxlajMiLCJwbVRpbGVzTGF5ZXJUb1RpcHBlY2Fub2VMYXllciIsImNvbGxlY3RBdHRyaWJ1dGVzIiwiaHRtbEF0dHJpYnV0aW9uIiwicGFyc2VNZXRhSnNvbiIsImlucHV0IiwiaXNOYU4iLCJ0aWxlc3RhdHMiLCJnZXRUaW1lQW5pbWF0aW9uRG9tYWluIiwibWFwcGVkVmFsdWUiLCJ0aW1lU3RlcHMiLCJ1bmlxIiwic29ydCIsImFzY2VuZGluZyIsIm5vdE51bGxPclVuZGVmaW5lZCIsImRvbWFpbiIsImR1cmF0aW9uIiwiY2xhbXBlZCIsImNsYW1wIiwicG1UaWxlVHlwZVRvQXR0ck1hcCIsImZsb2F0MzIiLCJzdHJpbmciLCJ1dGY4Iiwib3V0TGF5ZXJzIiwiX2l0ZXJhdG9yIiwiX3N0ZXAiLCJsYXllciIsIl9yZWYyIiwiX3JlZjIkZmllbGRzIiwiX2l0ZXJhdG9yMiIsIl9zdGVwMiIsIl9wbUZpZWxkJHZhbHVlcyIsInBtRmllbGQiLCJhdHRyaWJ1dGUiLCJjb3VudCIsInVuaXF1ZVZhbHVlQ291bnQiLCJ2YWx1ZXMiLCJtaW4iLCJtYXgiLCJhdHRyaWJ1dGVzIiwiaW5kZXhlZEF0dHJpYnV0ZXMiLCJfaXRlcmF0b3IzIiwiX3N0ZXAzIiwiX3JlZjMiLCJfcmVmMyRhdHRyaWJ1dGVzIiwiX2l0ZXJhdG9yNSIsIl9zdGVwNSIsImF0dHIiLCJmbmFtZSIsImF0dHJpYnV0ZVRvRmllbGQiLCJtZXJnZUF0dHJpYnV0ZURvbWFpbiIsIl9pIiwiX09iamVjdCRlbnRyaWVzIiwiZW50cmllcyIsIl9PYmplY3QkZW50cmllcyRfaSIsIl9zbGljZWRUb0FycmF5MiIsImF0dHJzIiwiX3BhcnNlSW5kZXhlZEZpZWxkIiwicGFyc2VJbmRleGVkRmllbGQiLCJpbmRleGVkRmllbGQiLCJ1bmlkZW50aWZpZWQiLCJfaXRlcmF0b3I0IiwiX3N0ZXA0IiwidW5pZGVudGlmaWVkQXR0ciIsImdldEluZGV4S2V5RnJvbUZpZWxkTmFtZSIsImZpZWxkIiwiX2l0ZXJhdG9yNiIsIl9zdGVwNiIsImZpZWxkTmFtZSIsImluZGV4S2V5IiwiYW5hbHl6ZWRUeXBlIiwiY29udGFpblZhbGlkVGltZSIsImlkIiwiaW5kZXhCeSIsImZvcm1hdCIsImFuYWx5emVyVHlwZVRvRmllbGRUeXBlIiwiZmllbGRUcyIsImVwb2NoIiwidGltZVRvVW5peE1pbGxpIiwiQUxMX0ZJRUxEX1RZUEVTIiwidGltZXN0YW1wIiwidGltZURvbWFpbiIsImNvbXBhcmUiLCJudW0xIiwibnVtMiIsIm9wZXJhdG9yIiwiTWF0aCIsIk5hTiIsImdldEZpbHRlclByb3BzIiwiZmllbGRUeXBlIiwicmVhbCIsImludGVnZXIiLCJfZ2V0QXR0cmlidXRlRG9tYWluIiwiZ2V0QXR0cmlidXRlRG9tYWluIiwiX2dldEF0dHJpYnV0ZURvbWFpbjIiLCJkaWZmIiwic3RlcCIsImdldE51bWVyaWNTdGVwU2l6ZSIsImZvcm1hdE51bWJlckJ5U3RlcCIsImZpbHRlclByb3BzIiwiRklMVEVSX1RZUEVTIiwicmFuZ2UiLCJ0eXBlT3B0aW9ucyIsImdwdSIsIm11bHRpU2VsZWN0IiwiZmllbGRUeXBlcyIsImF0dHJpYnV0ZVR5cGVUb0ZpZWxkVHlwZSIsIl9maWVsZCRtZXRhZGF0YSIsIl9maWVsZCRmaWx0ZXJQcm9wcyIsImF0dHJUeXBlTWFwIiwibnVtYmVyIiwiYW5hbHl6ZXJUeXBlIiwiREFUQV9UWVBFUyIsIkZMT0FUIiwibnVtZXJpYyIsIlNUUklORyIsInZhY2hhciIsIklOVCIsImludDQiLCJCT09MRUFOIiwiYm9vbCIsImFUeXBlIiwidG9Mb3dlckNhc2UiLCJDb25zb2xlIiwid2FybiIsIm1hdGNoRGF0YXNldFR5cGUiLCJjb25maWciLCJkYXRhSWQiLCJzdXBwb3J0ZWREYXRhc2V0VHlwZXMiLCJpbmNsdWRlcyIsImdldEZpZWxkc0Zyb21UaWxlIiwiZXhwb3J0cyIsIl9yZWY1IiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiX3JlZ2VuZXJhdG9yIiwibWFyayIsIl9jYWxsZWUiLCJfcmVmNCIsInJlbW90ZVRpbGVGb3JtYXQiLCJ0aWxlc2V0VXJsIiwibWV0YWRhdGFVcmwiLCJfbWV0YWRhdGEkZmllbGRzIiwiX21ldGFkYXRhJGJvdW5kcyIsImxvbiIsImxhdCIsInRpbGVJbmRpY2VzIiwidGlsZVNvdXJjZSIsInRpbGUiLCJ1cGRhdGVkRmllbGRzIiwid3JhcCIsIl9jYWxsZWUkIiwiX2NvbnRleHQiLCJwcmV2IiwibG9uTGF0VG9UaWxlSW5kZXgiLCJSZW1vdGVUaWxlRm9ybWF0IiwiTVZUU291cmNlIiwiY3JlYXRlRGF0YVNvdXJjZSIsImRlY29kZVVSSUNvbXBvbmVudCIsIm12dCIsIlBNVGlsZXNTb3VyY2UiLCJnZXRUaWxlRGF0YSIsImluZGV4Iiwic2VudCIsInRpbGVUb0ZpZWxkcyIsInQwIiwic3RvcCIsIl94IiwiX3RpbGUkZmVhdHVyZXMiLCJmZWF0dXJlcyIsImhlYWRlciIsInByb3BlcnRpZXMiLCJvdXRwdXQiLCJvYmoiLCJjb2x1bW5OYW1lIiwiZ2V0RmllbGRzRnJvbURhdGEiLCJmb3JjZVN0cmluZyIsIkFOQUxZWkVSX0RBVEFfVFlQRVMiLCJ6b29tIiwiRXJyb3IiLCJzY2FsZSIsIngiLCJmbG9vciIsImxhdFJhZCIsIlBJIiwieSIsImxvZyIsInRhbiIsImNvcyIsInoiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvdGlsZXNldC92ZWN0b3ItdGlsZS11dGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQge0RBVEFfVFlQRVMgYXMgQU5BTFlaRVJfREFUQV9UWVBFU30gZnJvbSAndHlwZS1hbmFseXplcic7XG5pbXBvcnQge2FzY2VuZGluZ30gZnJvbSAnZDMtYXJyYXknO1xuaW1wb3J0IENvbnNvbGUgZnJvbSAnZ2xvYmFsL2NvbnNvbGUnO1xuaW1wb3J0IHVuaXEgZnJvbSAnbG9kYXNoL3VuaXEnO1xuaW1wb3J0IHtEQVRBX1RZUEVTfSBmcm9tICd0eXBlLWFuYWx5emVyJztcblxuaW1wb3J0IHtNVlRTb3VyY2UsIFRpbGVKU09OfSBmcm9tICdAbG9hZGVycy5nbC9tdnQnO1xuaW1wb3J0IHtQTVRpbGVzU291cmNlLCBQTVRpbGVzTWV0YWRhdGF9IGZyb20gJ0Bsb2FkZXJzLmdsL3BtdGlsZXMnO1xuXG5pbXBvcnQge1xuICBhbmFseXplclR5cGVUb0ZpZWxkVHlwZSxcbiAgY29udGFpblZhbGlkVGltZSxcbiAgbm90TnVsbG9yVW5kZWZpbmVkIGFzIG5vdE51bGxPclVuZGVmaW5lZCxcbiAgcGFyc2VVcmksXG4gIGdldEZpZWxkc0Zyb21EYXRhXG59IGZyb20gJ0BrZXBsZXIuZ2wvY29tbW9uLXV0aWxzJztcbmltcG9ydCB7XG4gIERhdGFzZXRUeXBlLFxuICBBTExfRklFTERfVFlQRVMsXG4gIEZJTFRFUl9UWVBFUyxcbiAgUE1UaWxlc1R5cGUsXG4gIFJlbW90ZVRpbGVGb3JtYXRcbn0gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuXG5pbXBvcnQge0ZlYXR1cmUsIEZpZWxkIGFzIEtlcGxlckZpZWxkLCBLZXBsZXJMYXllcn0gZnJvbSAnQGtlcGxlci5nbC90eXBlcyc7XG5pbXBvcnQge2NsYW1wLCBmb3JtYXROdW1iZXJCeVN0ZXAsIGdldE51bWVyaWNTdGVwU2l6ZSwgdGltZVRvVW5peE1pbGxpfSBmcm9tICdAa2VwbGVyLmdsL3V0aWxzJztcblxuaW1wb3J0IHtcbiAgRmlsdGVyUHJvcHMsXG4gIE51bWVyaWNGaWVsZEZpbHRlclByb3BzLFxuICBTdHJpbmdGaWVsZEZpbHRlclByb3BzLFxuICBkZWZhdWx0IGFzIEtlcGxlckRhdGFzZXRcbn0gZnJvbSAnLi4va2VwbGVyLXRhYmxlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGlsZURhdGFzZXQoZGF0YXNldDogS2VwbGVyRGF0YXNldCB8IHt0eXBlOiBzdHJpbmd9KTogYm9vbGVhbiB7XG4gIHJldHVybiBCb29sZWFuKGRhdGFzZXQ/LnR5cGUgPT09IERhdGFzZXRUeXBlLlZFQ1RPUl9USUxFKTtcbn1cblxudHlwZSBWZWN0b3JUaWxlRmllbGQgPSB7XG4gIGFuYWx5emVyVHlwZTogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGlkOiBzdHJpbmc7XG4gIGZvcm1hdDogc3RyaW5nO1xuICB0eXBlOiBzdHJpbmc7XG4gIGZpbHRlclByb3BzPzogRmlsdGVyUHJvcHM7XG59O1xuXG5leHBvcnQgdHlwZSBWZWN0b3JUaWxlTWV0YWRhdGEgPSB7XG4gIGF0dHJpYnV0aW9ucz86IHVua25vd25bXTtcbiAgbWV0YUpzb246IGFueSB8IG51bGw7XG4gIGJvdW5kczogbnVtYmVyW10gfCBudWxsO1xuICBjZW50ZXI6IG51bWJlcltdIHwgbnVsbDtcbiAgbWF4Wm9vbTogbnVtYmVyIHwgbnVsbDtcbiAgbWluWm9vbTogbnVtYmVyIHwgbnVsbDtcbiAgbmFtZT86IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIGZpZWxkczogVmVjdG9yVGlsZUZpZWxkW107XG5cbiAgLy8gaWYgdGhlIHRpbGVzZXQgaXMgb2YgcG10aWxlcyBmb3JtYXQgdGhlbiBpbmNsdWRlIGluZm8gYWJvdXQgdHlwZSBvZiBwbXRpbGVzXG4gIHBtdGlsZXNUeXBlPzogUE1UaWxlc1R5cGU7XG59O1xuXG50eXBlIFRpbGVzZXRNZXRhZGF0YSA9IFZlY3RvclRpbGVNZXRhZGF0YTtcblxuZXhwb3J0IHR5cGUgVGlwcGVjYW5vZUxheWVyQXR0cmlidXRlID0ge1xuICBhdHRyaWJ1dGU/OiBzdHJpbmc7XG4gIHR5cGU/OiBzdHJpbmc7XG4gIG1pbj86IG51bWJlcjtcbiAgbWF4PzogbnVtYmVyO1xuICB2YWx1ZXM6IHN0cmluZ1tdIHwgbnVtYmVyW107XG59O1xuXG50eXBlIFRpcHBlY2Fub2VMYXllciA9IHtcbiAgYXR0cmlidXRlcz86IFRpcHBlY2Fub2VMYXllckF0dHJpYnV0ZVtdO1xufTtcbnR5cGUgVGlsZXNldEZ1bmN0aW9uID0ge1xuICBnZXRNZXRhVXJsOiAoczogc3RyaW5nKSA9PiBzdHJpbmcgfCBudWxsO1xuICBwYXJzZU1ldGFkYXRhOiAoZDogYW55LCBvcHRpb25zPzogYW55KSA9PiBUaWxlc2V0TWV0YWRhdGEgfCBudWxsO1xufTtcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXBib3gvdGlsZWpzb24tc3BlYy90cmVlL21hc3Rlci8yLjIuMFxuZnVuY3Rpb24gaXNMYXQobnVtOiBhbnkpOiBib29sZWFuIHtcbiAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShudW0pICYmIG51bSA8PSA5MCAmJiBudW0gPj0gLTkwO1xufVxuZnVuY3Rpb24gaXNMbmcobnVtOiBhbnkpOiBib29sZWFuIHtcbiAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShudW0pICYmIG51bSA8PSAxODAgJiYgbnVtID49IC0xODA7XG59XG5mdW5jdGlvbiBpc1pvb20obnVtOiBhbnkpOiBib29sZWFuIHtcbiAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShudW0pICYmIG51bSA+PSAwICYmIG51bSA8PSAyMjtcbn1cbmZ1bmN0aW9uIGZyb21BcnJheU9yU3RyaW5nKGRhdGE6IHN0cmluZyB8IG51bWJlcltdKTogbnVtYmVyW10gfCBudWxsIHtcbiAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBkYXRhLnNwbGl0KCcsJykubWFwKHBhcnNlRmxvYXQpO1xuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VDZW50ZXIoY2VudGVyOiBzdHJpbmcgfCBudW1iZXJbXSk6IG51bWJlcltdIHwgbnVsbCB7XG4gIC8vIHN1cHBvcnRlZCBmb3JtYXRzXG4gIC8vIHN0cmluZzogXCItOTYuNjU3NzE1LDQwLjEyNjEyNywtOTAuMTQwMDYxLDQzLjUxNjY4OVwiLFxuICAvLyBhcnJheTogWy05MS41MDUxMjcsNDEuNjE1NDQyLDE0XVxuICBjb25zdCByZXN1bHQgPSBmcm9tQXJyYXlPclN0cmluZyhjZW50ZXIpO1xuICBpZiAoXG4gICAgQXJyYXkuaXNBcnJheShyZXN1bHQpICYmXG4gICAgcmVzdWx0Lmxlbmd0aCA9PT0gMyAmJlxuICAgIGlzTG5nKHJlc3VsdFswXSkgJiZcbiAgICBpc0xhdChyZXN1bHRbMV0pICYmXG4gICAgaXNab29tKHJlc3VsdFsyXSlcbiAgKSB7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBib3VuZHMgc2hvdWxkIGJlIFttaW5MbmcsIG1pbkxhdCwgbWF4TG5nLCBtYXhMYXRdXG4gKiBAcGFyYW0geyp9IGJvdW5kc1xuICovXG5mdW5jdGlvbiBwYXJzZUJvdW5kcyhib3VuZHM6IHN0cmluZyB8IG51bWJlcltdKTogbnVtYmVyW10gfCBudWxsIHtcbiAgLy8gc3VwcG9ydGVkIGZvcm1hdHNcbiAgLy8gc3RyaW5nOiBcIi05Ni42NTc3MTUsNDAuMTI2MTI3LC05MC4xNDAwNjEsNDMuNTE2Njg5XCIsXG4gIC8vIGFycmF5OiBbIC0xODAsIC04NS4wNTExMjg3Nzk4MDY1OSwgMTgwLCA4NS4wNTExMjg3Nzk4MDY2IF1cbiAgY29uc3QgcmVzdWx0ID0gZnJvbUFycmF5T3JTdHJpbmcoYm91bmRzKTtcbiAgLy8gdmFsaWRhdGUgYm91bmRzXG4gIGlmIChcbiAgICBBcnJheS5pc0FycmF5KHJlc3VsdCkgJiZcbiAgICByZXN1bHQubGVuZ3RoID09PSA0ICYmXG4gICAgW3Jlc3VsdFswXSwgcmVzdWx0WzJdXS5ldmVyeShpc0xuZykgJiZcbiAgICBbcmVzdWx0WzFdLCByZXN1bHRbM11dLmV2ZXJ5KGlzTGF0KVxuICApIHtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5jb25zdCBYX1BBVFQgPSAvXFx7eFxcfS87XG5jb25zdCBZX1BBVFQgPSAvXFx7eVxcfS87XG5jb25zdCBaX1BBVFQgPSAvXFx7elxcfS87XG5cbmZ1bmN0aW9uIGlzRnVsbHlRdWFsaWZpZWRUaWxlVXJsKHRpbGVVcmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gWF9QQVRULnRlc3QodGlsZVVybCkgJiYgWV9QQVRULnRlc3QodGlsZVVybCkgJiYgWl9QQVRULnRlc3QodGlsZVVybCk7XG59XG5cbi8qKlxuICogTm9ybWFsaXplIHRpbGUgVVJMXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHRpbGVVcmwgSW5pdGlhbCB0aWxlIFVSTCwgd2hpY2ggbWF5IGJlIGVpdGhlciB0aGUgcm9vdCBVUkwgZm9yIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHRpbGVzZXQgb3IgYSBmdWxseSBxdWFsaWZpZWQgdGVtcGxhdGVcbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSB2YWxpZGF0ZVVybCBmdW5jdGlvbiB0byB2YWxpZGF0ZSB0aWxlIFVSTFxuICogQHJldHVybiB7c3RyaW5nfG51bGx9ICAgIEZ1bGx5IHF1YWxpZmllZCB0aWxlIFVSTCB0ZW1wbGF0ZSwgb3IgbnVsbCBpZiBpbnB1dCBkb2VzIG5vdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVhciB0byBiZSBhIHZhbGlkIFVSTFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGlsZVVybChcbiAgdGlsZVVybDogc3RyaW5nLFxuICB2YWxpZGF0ZVVybDogKHM6IHN0cmluZykgPT4gYm9vbGVhbiA9IGlzRnVsbHlRdWFsaWZpZWRUaWxlVXJsXG4pOiBzdHJpbmcgfCBudWxsIHtcbiAgLy8gQ2hlY2sgZm9yIGEgdmFsaWQgVVJMLiBJZGVhbGx5IHdlJ2QgaGF2ZSBhIHNpbXBsZSBtZXRob2QgaGVyZS5cbiAgY29uc3QgdXJpUGFydHMgPSBwYXJzZVVyaSh0aWxlVXJsKTtcbiAgaWYgKCF1cmlQYXJ0cy5wcm90b2NvbCB8fCAhdXJpUGFydHMuaG9zdCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmICh2YWxpZGF0ZVVybCh0aWxlVXJsKSkge1xuICAgIHJldHVybiB0aWxlVXJsO1xuICB9XG4gIHJldHVybiBgJHt0aWxlVXJsLnJlcGxhY2UoL1xcLyQvLCAnJyl9L3t6fS97eH0ve3l9LnBiZmA7XG59XG5cbi8qKlxuICogTWFwIG9mIHV0aWwgZnVuY3Rpb25zIGZvciBkaWZmZXJlbnQgdGlsZXNldCB0eXBlcywga2V5ZWQgYnkgaG9zdFxuICovXG5jb25zdCBUSUxFU0VUX0ZVTkNUSU9OUzoge1trZXk6IHN0cmluZ106IFRpbGVzZXRGdW5jdGlvbn0gPSB7XG4gICdhcGkubWFwYm94LmNvbSc6IHtcbiAgICBnZXRNZXRhVXJsOiBnZXRNZXRhVXJsTWFwYm94LFxuICAgIHBhcnNlTWV0YWRhdGE6IHBhcnNlTWV0YWRhdGFUaWxlSlNPTlxuICB9LFxuICBkZWZhdWx0OiB7XG4gICAgZ2V0TWV0YVVybDogZ2V0TWV0YVVybFRpcHBlY2Fub2UsXG4gICAgcGFyc2VNZXRhZGF0YTogcGFyc2VNZXRhZGF0YVRpbGVKU09OXG4gIH1cbn07XG5cbmZ1bmN0aW9uIGdldFRpbGVzZXRGdW5jdGlvbnModGlsZVVybDogc3RyaW5nIHwgbnVsbCk6IFRpbGVzZXRGdW5jdGlvbiB7XG4gIGxldCBob3N0ID0gJyc7XG4gIHRyeSB7XG4gICAgaG9zdCA9IG5ldyBVUkwodGlsZVVybCB8fCAnJykuaG9zdG5hbWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gZG8gbm90aGluZ1xuICB9XG5cbiAgcmV0dXJuIFRJTEVTRVRfRlVOQ1RJT05TW2hvc3RdIHx8IFRJTEVTRVRfRlVOQ1RJT05TLmRlZmF1bHQ7XG59XG5cbi8qKlxuICogR2V0IHRoZSBtZXRhZGF0YSBVUkwgZm9yIGEgZ2l2ZW4gdGlsZXNldFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWV0YVVybCh0aWxlVXJsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgcmV0dXJuIGdldFRpbGVzZXRGdW5jdGlvbnModGlsZVVybCkuZ2V0TWV0YVVybCh0aWxlVXJsKTtcbn1cbnR5cGUgUGFyc2VNZXRhZGF0YU9wdGlvbiA9IHtcbiAgdGlsZVVybD86IHN0cmluZyB8IG51bGw7XG59O1xuLyoqXG4gKiBQYXJzZSB0aGUgbWV0YWRhdGEgZm9yIGEgZ2l2ZW4gdGlsZXNldFxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VWZWN0b3JNZXRhZGF0YShcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbiAgbWV0YWRhdGE6IFBNVGlsZXNNZXRhZGF0YSB8IFRpbGVKU09OLFxuICBvcHRpb24/OiBQYXJzZU1ldGFkYXRhT3B0aW9uXG4pOiBUaWxlc2V0TWV0YWRhdGEgfCBudWxsIHtcbiAgY29uc3Qge3RpbGVVcmwgPSAnJ30gPSBvcHRpb24gfHwge307XG4gIHJldHVybiBnZXRUaWxlc2V0RnVuY3Rpb25zKHRpbGVVcmwpLnBhcnNlTWV0YWRhdGEobWV0YWRhdGEpO1xufVxuXG5jb25zdCBNQVBCT1hfVVJMX1BBVFQgPSAvXFwvXFx7elxcfVxcL1xce3hcXH1cXC9cXHt5XFx9XFwubXZ0LztcblxuZnVuY3Rpb24gZ2V0TWV0YVVybE1hcGJveCh0aWxlVXJsID0gJycpOiBzdHJpbmcge1xuICByZXR1cm4gdGlsZVVybC5yZXBsYWNlKE1BUEJPWF9VUkxfUEFUVCwgJy5qc29uJyk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlTWV0YWRhdGFUaWxlSlNPTihtZXRhZGF0YTogUE1UaWxlc01ldGFkYXRhIHwgVGlsZUpTT04pOiBUaWxlc2V0TWV0YWRhdGEgfCBudWxsIHtcbiAgY29uc3QgcGFyc2VkID0gcGFyc2VNZXRhZGF0YVRpcHBlY2Fub2VGcm9tRGF0YVNvdXJjZShtZXRhZGF0YSk7XG4gIGlmICghcGFyc2VkKSByZXR1cm4gbnVsbDtcblxuICAvLyBQTVRpbGVzIGNhbiBwb3RlbnRpYWxseSBiZSBpbiBSYXN0ZXJUaWxlIGZvcm1hdFxuICBjb25zdCBtaW1lVHlwZSA9IChtZXRhZGF0YSBhcyBQTVRpbGVzTWV0YWRhdGEpLnRpbGVNSU1FVHlwZTtcbiAgaWYgKG1pbWVUeXBlKSB7XG4gICAgcGFyc2VkLnBtdGlsZXNUeXBlID1cbiAgICAgIG1pbWVUeXBlID09PSAnYXBwbGljYXRpb24vdm5kLm1hcGJveC12ZWN0b3ItdGlsZScgPyBQTVRpbGVzVHlwZS5NVlQgOiBQTVRpbGVzVHlwZS5SQVNURVI7XG4gIH1cblxuICAvLyBGaWVsZHMgYWxyZWFkeSBwYXJzZWQgZnJvbSBganNvbmAgcHJvcGVydHlcbiAgaWYgKHBhcnNlZC5maWVsZHM/Lmxlbmd0aCkge1xuICAgIHJldHVybiBwYXJzZWQ7XG4gIH1cblxuICByZXR1cm4gcGFyc2VkO1xufVxuXG5mdW5jdGlvbiBnZXRNZXRhVXJsVGlwcGVjYW5vZSh0aWxlVXJsKSB7XG4gIGNvbnN0IHVybCA9IGdldFRpbGVVcmwodGlsZVVybCk7XG4gIGlmICghdXJsKSByZXR1cm4gbnVsbDtcbiAgLy8gYXNzdW1lcyB0aGUgc3RydWN0dXJlIDx1cmxfYmFzZT4ve3p9Li4uXG4gIGNvbnN0IGJhc2VVcmwgPSB1cmwuc3BsaXQoWl9QQVRUKVswXS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICByZXR1cm4gYCR7YmFzZVVybH0vbWV0YWRhdGEuanNvbmA7XG59XG5cbi8qKlxuICogU3BlY2lhbCBwYXJzaW5nIGZvciBtZXRhZGF0YSByZXR1cm5lZCBieSBNVlRTb3VyY2UgYW5kIFBNVGlsZXNTb3VyY2UuXG4gKiBAcGFyYW0gbWV0YWRhdGEgVGlsZXNldCBtZXRhZGF0YSBwYXJzZWQgYnkgYSBEYXRhU291Y2VcbiAqIEByZXR1cm5zIE1ldGFkYXRhIGluIEtlcGxlci1mcmllbmRseSBmb3JtYXQuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlTWV0YWRhdGFUaXBwZWNhbm9lRnJvbURhdGFTb3VyY2UoXG4gIG1ldGFkYXRhOiBQTVRpbGVzTWV0YWRhdGEgfCBUaWxlSlNPTiB8IG51bGxcbik6IFRpbGVzZXRNZXRhZGF0YSB8IG51bGwge1xuICBpZiAoIW1ldGFkYXRhIHx8IHR5cGVvZiBtZXRhZGF0YSAhPT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGxldCByZXN1bHQ6IFRpbGVzZXRNZXRhZGF0YSA9IHtcbiAgICBhdHRyaWJ1dGlvbnM6IFtdLFxuICAgIG1ldGFKc29uOiBudWxsLFxuICAgIGJvdW5kczogbnVsbCxcbiAgICBjZW50ZXI6IG51bGwsXG4gICAgbWF4Wm9vbTogbnVsbCxcbiAgICBtaW5ab29tOiBudWxsLFxuICAgIGZpZWxkczogW11cbiAgfTtcblxuICBjb25zdCBtdnRNZXRhZGF0YSA9IG1ldGFkYXRhIGFzIFRpbGVKU09OO1xuICBjb25zdCBwbVRpbGVNZXRhZGF0YSA9IG1ldGFkYXRhIGFzIFBNVGlsZXNNZXRhZGF0YTtcblxuICAvLyB0cnkgdG8gcGFyc2UgbWV0YUpzb25cbiAgaWYgKHR5cGVvZiBtdnRNZXRhZGF0YS5tZXRhSnNvbiA9PT0gJ3N0cmluZycpIHtcbiAgICB0cnkge1xuICAgICAgcmVzdWx0Lm1ldGFKc29uID0gSlNPTi5wYXJzZShtdnRNZXRhZGF0YS5tZXRhSnNvbik7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBkbyBub3RoaW5nXG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiBtdnRNZXRhZGF0YS5tZXRhSnNvbiA9PT0gJ29iamVjdCcpIHtcbiAgICByZXN1bHQubWV0YUpzb24gPSBtdnRNZXRhZGF0YS5tZXRhSnNvbjtcbiAgfVxuXG4gIHJlc3VsdC5ib3VuZHMgPSBwYXJzZUJvdW5kcyhcbiAgICBBcnJheS5pc0FycmF5KG1ldGFkYXRhLmJvdW5kaW5nQm94KSA/IG1ldGFkYXRhLmJvdW5kaW5nQm94LmZsYXQoKSA6ICcnXG4gICk7XG5cbiAgLy8gUE1UaWxlU291cmNlIGhhcyBjZW50ZXJab29tIGFuZCBjZW50ZXIgW2xvbiwgbGF0XSwgTVZUU291cmNlIC0gW2xvbiwgbGF0LCB6b29tXVxuICBjb25zdCBjZW50ZXIgPVxuICAgIHBtVGlsZU1ldGFkYXRhLmNlbnRlclpvb20gIT09IHVuZGVmaW5lZCAmJiBBcnJheS5pc0FycmF5KG1ldGFkYXRhLmNlbnRlcilcbiAgICAgID8gWy4uLm1ldGFkYXRhLmNlbnRlciwgcG1UaWxlTWV0YWRhdGEuY2VudGVyWm9vbV1cbiAgICAgIDogbWV0YWRhdGEuY2VudGVyO1xuICByZXN1bHQuY2VudGVyID0gcGFyc2VDZW50ZXIoY2VudGVyIHx8ICcnKTtcblxuICByZXN1bHQubWF4Wm9vbSA9IHNhZmVQYXJzZUZsb2F0KG1ldGFkYXRhLm1heFpvb20pO1xuICByZXN1bHQubWluWm9vbSA9IHNhZmVQYXJzZUZsb2F0KG1ldGFkYXRhLm1pblpvb20pO1xuICByZXN1bHQubmFtZSA9IG1ldGFkYXRhLm5hbWUgfHwgJyc7XG4gIHJlc3VsdC5kZXNjcmlwdGlvbiA9IG12dE1ldGFkYXRhLmRlc2NyaXB0aW9uIHx8IHBtVGlsZU1ldGFkYXRhLnRpbGVqc29uPy5kZXNjcmlwdGlvbiB8fCAnJztcblxuICBpZiAoQXJyYXkuaXNBcnJheShwbVRpbGVNZXRhZGF0YS50aWxlanNvbj8ubGF5ZXJzKSkge1xuICAgIGNvbnN0IGxheWVycyA9IHBtVGlsZXNMYXllclRvVGlwcGVjYW5vZUxheWVyKHBtVGlsZU1ldGFkYXRhLnRpbGVqc29uPy5sYXllcnMpO1xuICAgIHJlc3VsdC5maWVsZHMgPSBjb2xsZWN0QXR0cmlidXRlcyhsYXllcnMpO1xuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkobXZ0TWV0YWRhdGEubGF5ZXJzKSkge1xuICAgIGNvbnN0IGxheWVycyA9IHBtVGlsZXNMYXllclRvVGlwcGVjYW5vZUxheWVyKG12dE1ldGFkYXRhLmxheWVycyk7XG4gICAgcmVzdWx0LmZpZWxkcyA9IGNvbGxlY3RBdHRyaWJ1dGVzKGxheWVycyk7XG4gIH1cblxuICByZXN1bHQgPSB7XG4gICAgLi4ucmVzdWx0LFxuICAgIGF0dHJpYnV0aW9uczpcbiAgICAgIHBtVGlsZU1ldGFkYXRhLmF0dHJpYnV0aW9ucyB8fFxuICAgICAgKG12dE1ldGFkYXRhLmh0bWxBdHRyaWJ1dGlvbiA/IFttdnRNZXRhZGF0YS5odG1sQXR0cmlidXRpb25dIDogdW5kZWZpbmVkKSB8fFxuICAgICAgW10sXG4gICAgLi4ucGFyc2VNZXRhSnNvbihyZXN1bHQubWV0YUpzb24pXG4gIH07XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gc2FmZVBhcnNlRmxvYXQoaW5wdXQ6IHVua25vd24pOiBudW1iZXIgfCBudWxsIHtcbiAgY29uc3QgcmVzdWx0ID1cbiAgICB0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnID8gcGFyc2VGbG9hdChpbnB1dCkgOiB0eXBlb2YgaW5wdXQgPT09ICdudW1iZXInID8gaW5wdXQgOiBudWxsO1xuICByZXR1cm4gcmVzdWx0ID09PSBudWxsIHx8IGlzTmFOKHJlc3VsdCkgPyBudWxsIDogcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBwYXJzZU1ldGFKc29uKG1ldGFKc29uOiBhbnkpOiB7ZmllbGRzOiBWZWN0b3JUaWxlRmllbGRbXX0gfCBudWxsIHtcbiAgaWYgKCFtZXRhSnNvbiB8fCB0eXBlb2YgbWV0YUpzb24gIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAobWV0YUpzb24udGlsZXN0YXRzICYmIEFycmF5LmlzQXJyYXkobWV0YUpzb24udGlsZXN0YXRzLmxheWVycykpIHtcbiAgICAvLyB3ZSBhcmUgaW4gbHVjayFcbiAgICByZXR1cm4ge2ZpZWxkczogY29sbGVjdEF0dHJpYnV0ZXMobWV0YUpzb24udGlsZXN0YXRzLmxheWVycyl9O1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBnZXRUaW1lQW5pbWF0aW9uRG9tYWluKG1hcHBlZFZhbHVlOiBudW1iZXJbXSk6IHtcbiAgZG9tYWluOiBudW1iZXJbXTtcbiAgdGltZVN0ZXBzOiBudW1iZXJbXTtcbiAgbWFwcGVkVmFsdWU6IG51bWJlcltdO1xuICBkdXJhdGlvbjogbnVtYmVyO1xufSB7XG4gIGNvbnN0IHRpbWVTdGVwcyA9IHVuaXEobWFwcGVkVmFsdWUpLnNvcnQoYXNjZW5kaW5nKS5maWx0ZXIobm90TnVsbE9yVW5kZWZpbmVkKTtcblxuICBjb25zdCBkb21haW4gPSBbdGltZVN0ZXBzWzBdLCB0aW1lU3RlcHNbdGltZVN0ZXBzLmxlbmd0aCAtIDFdXTtcblxuICAvLyBpZiB0YWtzIDEwICogMTAwMCBtcyB0byBmaW5pc2ggdGhlIGVudGlyZSBhbmltYXRpb25cbiAgY29uc3QgZHVyYXRpb24gPSAxMDAwMCAvIHRpbWVTdGVwcy5sZW5ndGg7XG4gIGNvbnN0IGNsYW1wZWQgPSBjbGFtcChbMTAwLCAyMDAwXSwgZHVyYXRpb24pO1xuXG4gIHJldHVybiB7ZG9tYWluLCB0aW1lU3RlcHMsIGR1cmF0aW9uOiBjbGFtcGVkLCBtYXBwZWRWYWx1ZX07XG59XG5cbmNvbnN0IHBtVGlsZVR5cGVUb0F0dHJNYXAgPSB7XG4gIGZsb2F0MzI6ICdudW1iZXInLFxuICBzdHJpbmc6ICdzdHJpbmcnLFxuICB1dGY4OiAnc3RyaW5nJyxcbiAgaW50OiAnaW50JyxcbiAgYm9vbGVhbjogJ2Jvb2xlYW4nXG59O1xuXG4vKipcbiAqIFRyYW5zZm9ybSBUaWxlSlNPTlsnbGF5ZXJzJ10gYmFjayB0byBUaXBwZWNhbm9lTGF5ZXJcbiAqL1xuZnVuY3Rpb24gcG1UaWxlc0xheWVyVG9UaXBwZWNhbm9lTGF5ZXIobGF5ZXJzOiBUaWxlSlNPTlsnbGF5ZXJzJ10pOiBUaXBwZWNhbm9lTGF5ZXJbXSB7XG4gIGlmICghbGF5ZXJzKSByZXR1cm4gW107XG5cbiAgY29uc3Qgb3V0TGF5ZXJzOiBUaXBwZWNhbm9lTGF5ZXJbXSA9IFtdO1xuICBmb3IgKGNvbnN0IGxheWVyIG9mIGxheWVycykge1xuICAgIGNvbnN0IHtmaWVsZHMgPSBbXX0gPSBsYXllciB8fCB7fTtcbiAgICBmb3IgKGNvbnN0IHBtRmllbGQgb2YgZmllbGRzKSB7XG4gICAgICBjb25zdCBhdHRyaWJ1dGUgPSB7XG4gICAgICAgIGF0dHJpYnV0ZTogcG1GaWVsZC5uYW1lLFxuICAgICAgICB0eXBlOiBwbVRpbGVUeXBlVG9BdHRyTWFwW3BtRmllbGQudHlwZV0sXG4gICAgICAgIGNvdW50OiBwbUZpZWxkLnVuaXF1ZVZhbHVlQ291bnQsXG4gICAgICAgIHZhbHVlczogKHBtRmllbGQudmFsdWVzID8/IFtdKSBhcyBudW1iZXJbXSB8IHN0cmluZ1tdLFxuICAgICAgICBtaW46IHBtRmllbGQubWluLFxuICAgICAgICBtYXg6IHBtRmllbGQubWF4XG4gICAgICB9O1xuXG4gICAgICBvdXRMYXllcnMucHVzaCh7XG4gICAgICAgIGF0dHJpYnV0ZXM6IFthdHRyaWJ1dGVdXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dExheWVycztcbn1cblxuZnVuY3Rpb24gY29sbGVjdEF0dHJpYnV0ZXMobGF5ZXJzOiBUaXBwZWNhbm9lTGF5ZXJbXSA9IFtdKTogVmVjdG9yVGlsZUZpZWxkW10ge1xuICBjb25zdCBmaWVsZHMgPSB7fTtcbiAgY29uc3QgaW5kZXhlZEF0dHJpYnV0ZXM6IHtba2V5OiBzdHJpbmddOiBUaXBwZWNhbm9lTGF5ZXJBdHRyaWJ1dGVbXX0gPSB7fTtcblxuICBmb3IgKGNvbnN0IGxheWVyIG9mIGxheWVycykge1xuICAgIGNvbnN0IHthdHRyaWJ1dGVzID0gW119ID0gbGF5ZXIgfHwge307XG4gICAgZm9yIChjb25zdCBhdHRyIG9mIGF0dHJpYnV0ZXMpIHtcbiAgICAgIGNvbnN0IG5hbWUgPSBhdHRyLmF0dHJpYnV0ZTtcbiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1kZXB0aFxuICAgICAgICBpZiAobmFtZS5zcGxpdCgnfCcpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAvLyBpbmRleGVkIGZpZWxkXG4gICAgICAgICAgY29uc3QgZm5hbWUgPSBuYW1lLnNwbGl0KCd8JylbMF07XG4gICAgICAgICAgaW5kZXhlZEF0dHJpYnV0ZXNbZm5hbWVdID0gaW5kZXhlZEF0dHJpYnV0ZXNbZm5hbWVdIHx8IFtdO1xuICAgICAgICAgIGluZGV4ZWRBdHRyaWJ1dGVzW2ZuYW1lXS5wdXNoKGF0dHIpO1xuICAgICAgICB9IGVsc2UgaWYgKCFmaWVsZHNbbmFtZV0pIHtcbiAgICAgICAgICBmaWVsZHNbbmFtZV0gPSBhdHRyaWJ1dGVUb0ZpZWxkKGF0dHIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1lcmdlQXR0cmlidXRlRG9tYWluKGZpZWxkc1tuYW1lXSwgYXR0cik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBwYXJzZSBpbmRleGVkIGF0dHJpYnV0ZSwgYW5kIHB1dCBpbmRleCBrZXkgdW5pZGVudGlmaWVkIGJhY2sgYXMgbm9ybWFsIGZpZWxkXG4gIGZvciAoY29uc3QgW25hbWUsIGF0dHJzXSBvZiBPYmplY3QuZW50cmllcyhpbmRleGVkQXR0cmlidXRlcykpIHtcbiAgICBjb25zdCB7aW5kZXhlZEZpZWxkLCB1bmlkZW50aWZpZWR9ID0gcGFyc2VJbmRleGVkRmllbGQobmFtZSwgYXR0cnMpO1xuICAgIGZpZWxkc1tpbmRleGVkRmllbGQubmFtZV0gPSBpbmRleGVkRmllbGQ7XG4gICAgZm9yIChjb25zdCB1bmlkZW50aWZpZWRBdHRyIG9mIHVuaWRlbnRpZmllZCkge1xuICAgICAgaWYgKHVuaWRlbnRpZmllZEF0dHIuYXR0cmlidXRlKSB7XG4gICAgICAgIGZpZWxkc1t1bmlkZW50aWZpZWRBdHRyLmF0dHJpYnV0ZV0gPVxuICAgICAgICAgIGZpZWxkc1t1bmlkZW50aWZpZWRBdHRyLmF0dHJpYnV0ZV0gfHwgYXR0cmlidXRlVG9GaWVsZCh1bmlkZW50aWZpZWRBdHRyKTtcbiAgICAgICAgbWVyZ2VBdHRyaWJ1dGVEb21haW4oZmllbGRzW3VuaWRlbnRpZmllZEF0dHIuYXR0cmlidXRlXSwgdW5pZGVudGlmaWVkQXR0cik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIE9iamVjdC52YWx1ZXMoZmllbGRzKTtcbn1cblxuZnVuY3Rpb24gZ2V0SW5kZXhLZXlGcm9tRmllbGROYW1lKG5hbWU6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICByZXR1cm4gbmFtZSAmJiBuYW1lLnNwbGl0KCd8JykubGVuZ3RoID4gMSA/IG5hbWUuc3BsaXQoJ3wnKVsxXSA6IG51bGw7XG59XG5cbmV4cG9ydCB0eXBlIEZpZWxkSW5kZXhCeSA9IHtcbiAgZm9ybWF0OiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcbiAgbWFwcGVkVmFsdWU6IHtcbiAgICBba2V5OiBzdHJpbmddOiBzdHJpbmc7XG4gIH07XG59O1xuXG5mdW5jdGlvbiBwYXJzZUluZGV4ZWRGaWVsZChcbiAgbmFtZTogc3RyaW5nLFxuICBhdHRyczogVGlwcGVjYW5vZUxheWVyQXR0cmlidXRlW11cbik6IHtcbiAgdW5pZGVudGlmaWVkOiBUaXBwZWNhbm9lTGF5ZXJBdHRyaWJ1dGVbXTtcbiAgaW5kZXhlZEZpZWxkOiBWZWN0b3JUaWxlRmllbGQ7XG59IHtcbiAgY29uc3QgdW5pZGVudGlmaWVkOiBUaXBwZWNhbm9lTGF5ZXJBdHRyaWJ1dGVbXSA9IFtdO1xuICAvLyBhbmFseXplIHRpbWUgZm9ybWF0XG4gIGxldCBmaWVsZDtcblxuICBmb3IgKGNvbnN0IGF0dHIgb2YgYXR0cnMpIHtcbiAgICBjb25zdCBmaWVsZE5hbWUgPSBhdHRyLmF0dHJpYnV0ZTtcbiAgICBjb25zdCBpbmRleEtleSA9IGdldEluZGV4S2V5RnJvbUZpZWxkTmFtZShmaWVsZE5hbWUgfHwgJycpO1xuICAgIGNvbnN0IGFuYWx5emVkVHlwZSA9IGluZGV4S2V5ICYmIGNvbnRhaW5WYWxpZFRpbWUoW2luZGV4S2V5XSk7XG4gICAgaWYgKGFuYWx5emVkVHlwZSkge1xuICAgICAgZmllbGQgPSBmaWVsZCB8fCB7XG4gICAgICAgIC4uLmF0dHJpYnV0ZVRvRmllbGQoYXR0ciksXG4gICAgICAgIC8vIG92ZXJpZGUgbmFtZSBhbmQgaWQgdG8gdHJ1bmNhdGVkIG5hbWVcbiAgICAgICAgbmFtZSxcbiAgICAgICAgaWQ6IG5hbWUsXG4gICAgICAgIGluZGV4Qnk6IHtcbiAgICAgICAgICBmb3JtYXQ6IGFuYWx5emVkVHlwZS5mb3JtYXQsXG4gICAgICAgICAgdHlwZTogYW5hbHl6ZXJUeXBlVG9GaWVsZFR5cGUoYW5hbHl6ZWRUeXBlLnR5cGUpLFxuICAgICAgICAgIG1hcHBlZFZhbHVlOiB7fVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgbWVyZ2VBdHRyaWJ1dGVEb21haW4oZmllbGQsIGF0dHIpO1xuICAgICAgLy8gc2F2ZSBlcG9jaCB0aW1lIGluIG1hcHBlZFZhbHVlXG4gICAgICBsZXQgZmllbGRUczogc3RyaW5nIHwgbnVtYmVyIHwgbnVsbCA9IGluZGV4S2V5O1xuICAgICAgaWYgKGFuYWx5emVkVHlwZS5mb3JtYXQgPT09ICd4JyB8fCBhbmFseXplZFR5cGUuZm9ybWF0ID09PSAnWCcpIHtcbiAgICAgICAgZmllbGRUcyA9IE51bWJlcihpbmRleEtleSk7XG4gICAgICB9XG4gICAgICBjb25zdCBlcG9jaCA9IHRpbWVUb1VuaXhNaWxsaShmaWVsZFRzLCBhbmFseXplZFR5cGUuZm9ybWF0KTtcbiAgICAgIGlmIChlcG9jaCkge1xuICAgICAgICBmaWVsZC5pbmRleEJ5Lm1hcHBlZFZhbHVlW2Vwb2NoXSA9IGZpZWxkTmFtZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8ga2V5IGlzIG5vdCB2YWxpZCB0aW1lc3RhbXBcbiAgICAgIHVuaWRlbnRpZmllZC5wdXNoKGF0dHIpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChmaWVsZC5pbmRleEJ5ICYmIGZpZWxkLmluZGV4QnkudHlwZSA9PT0gQUxMX0ZJRUxEX1RZUEVTLnRpbWVzdGFtcCkge1xuICAgIGZpZWxkLmluZGV4QnkudGltZURvbWFpbiA9IGdldFRpbWVBbmltYXRpb25Eb21haW4oXG4gICAgICBPYmplY3Qua2V5cyhmaWVsZC5pbmRleEJ5Lm1hcHBlZFZhbHVlKS5tYXAoTnVtYmVyKVxuICAgICk7XG4gIH1cblxuICByZXR1cm4ge3VuaWRlbnRpZmllZCwgaW5kZXhlZEZpZWxkOiBmaWVsZH07XG59XG5cbmZ1bmN0aW9uIGNvbXBhcmUobnVtMTogbnVtYmVyIHwgdW5kZWZpbmVkLCBudW0yOiBudW1iZXIgfCB1bmRlZmluZWQsIG9wZXJhdG9yOiBzdHJpbmcpOiBudW1iZXIge1xuICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG51bTEpICYmIE51bWJlci5pc0Zpbml0ZShudW0yKVxuICAgID8gTWF0aFtvcGVyYXRvcl0obnVtMSBhcyBudW1iZXIsIG51bTIgYXMgbnVtYmVyKVxuICAgIDogTnVtYmVyLmlzRmluaXRlKG51bTEpXG4gICAgPyAobnVtMSBhcyBudW1iZXIpXG4gICAgOiBOdW1iZXIuaXNGaW5pdGUobnVtMilcbiAgICA/IChudW0yIGFzIG51bWJlcilcbiAgICA6IE5hTjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbHRlclByb3BzKFxuICBmaWVsZFR5cGU6IHN0cmluZyxcbiAgYXR0cmlidXRlOiBUaXBwZWNhbm9lTGF5ZXJBdHRyaWJ1dGVcbik6IEZpbHRlclByb3BzIHtcbiAgc3dpdGNoIChmaWVsZFR5cGUpIHtcbiAgICBjYXNlIEFMTF9GSUVMRF9UWVBFUy5yZWFsOlxuICAgIGNhc2UgQUxMX0ZJRUxEX1RZUEVTLmludGVnZXI6IHtcbiAgICAgIGNvbnN0IFttaW4sIG1heF0gPSBnZXRBdHRyaWJ1dGVEb21haW4oZmllbGRUeXBlLCBhdHRyaWJ1dGUpO1xuICAgICAgY29uc3QgZGlmZiA9IG1heCAtIG1pbjtcbiAgICAgIGNvbnN0IHN0ZXAgPSBnZXROdW1lcmljU3RlcFNpemUoZGlmZikgfHwgMC4xO1xuICAgICAgY29uc3QgZG9tYWluID0gW1xuICAgICAgICBmb3JtYXROdW1iZXJCeVN0ZXAobWluLCBzdGVwLCAnZmxvb3InKSxcbiAgICAgICAgZm9ybWF0TnVtYmVyQnlTdGVwKG1heCwgc3RlcCwgJ2NlaWwnKVxuICAgICAgXTtcbiAgICAgIGNvbnN0IGZpbHRlclByb3BzOiBOdW1lcmljRmllbGRGaWx0ZXJQcm9wcyA9IHtcbiAgICAgICAgZG9tYWluLFxuICAgICAgICB2YWx1ZTogZG9tYWluIGFzIFtudW1iZXIsIG51bWJlcl0sXG4gICAgICAgIHR5cGU6IEZJTFRFUl9UWVBFUy5yYW5nZSxcbiAgICAgICAgdHlwZU9wdGlvbnM6IFtGSUxURVJfVFlQRVMucmFuZ2VdLFxuICAgICAgICBncHU6IHRydWUsXG4gICAgICAgIHN0ZXBcbiAgICAgIH07XG4gICAgICByZXR1cm4gZmlsdGVyUHJvcHM7XG4gICAgfVxuXG4gICAgY2FzZSBBTExfRklFTERfVFlQRVMuYm9vbGVhbjoge1xuICAgICAgLy8gUmVwcmVzZW50IGJvb2xlYW4gYXMgbnVtZXJpYyByYW5nZSBbMCwxXSB0byBlbmFibGUgR1BVIGZpbHRlcmluZyBmb3IgdmVjdG9yIHRpbGVzXG4gICAgICBjb25zdCBkb21haW46IFtudW1iZXIsIG51bWJlcl0gPSBbMCwgMV07XG4gICAgICBjb25zdCBmaWx0ZXJQcm9wczogTnVtZXJpY0ZpZWxkRmlsdGVyUHJvcHMgPSB7XG4gICAgICAgIGRvbWFpbixcbiAgICAgICAgdmFsdWU6IGRvbWFpbixcbiAgICAgICAgdHlwZTogRklMVEVSX1RZUEVTLnJhbmdlLFxuICAgICAgICB0eXBlT3B0aW9uczogW0ZJTFRFUl9UWVBFUy5yYW5nZV0sXG4gICAgICAgIGdwdTogdHJ1ZSxcbiAgICAgICAgc3RlcDogMVxuICAgICAgfTtcbiAgICAgIHJldHVybiBmaWx0ZXJQcm9wcztcbiAgICB9XG5cbiAgICBkZWZhdWx0OiB7XG4gICAgICAvLyBBc3N1bWUgc3RyaW5nIGZvciBhbGwgb3RoZXIgZmllbGRzXG4gICAgICBjb25zdCBmaWx0ZXJQcm9wczogU3RyaW5nRmllbGRGaWx0ZXJQcm9wcyA9IHtcbiAgICAgICAgZG9tYWluOiBhdHRyaWJ1dGUudmFsdWVzIGFzIHN0cmluZ1tdLFxuICAgICAgICB2YWx1ZTogYXR0cmlidXRlLnZhbHVlcyBhcyBzdHJpbmdbXSxcbiAgICAgICAgdHlwZTogRklMVEVSX1RZUEVTLm11bHRpU2VsZWN0LFxuICAgICAgICBncHU6IGZhbHNlXG4gICAgICB9O1xuICAgICAgcmV0dXJuIGZpbHRlclByb3BzO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBhdHRyaWJ1dGVUb0ZpZWxkKGF0dHJpYnV0ZTogVGlwcGVjYW5vZUxheWVyQXR0cmlidXRlID0ge3ZhbHVlczogW119KTogVmVjdG9yVGlsZUZpZWxkIHtcbiAgLy8gYXR0cmlidXRlOiBcIl9zZWFzb25fcGVha3NfY29sb3JcIlxuICAvLyBjb3VudDogMTAwMFxuICAvLyBtYXg6IDAuOTVcbiAgLy8gbWluOiAwLjI0Mzc1XG4gIC8vIHR5cGU6IFwibnVtYmVyXCJcbiAgY29uc3QgZmllbGRUeXBlcyA9IGF0dHJpYnV0ZVR5cGVUb0ZpZWxkVHlwZShhdHRyaWJ1dGUudHlwZSk7XG4gIHJldHVybiB7XG4gICAgbmFtZTogYXR0cmlidXRlLmF0dHJpYnV0ZSBhcyBzdHJpbmcsXG4gICAgaWQ6IGF0dHJpYnV0ZS5hdHRyaWJ1dGUgYXMgc3RyaW5nLFxuICAgIGZvcm1hdDogJycsXG4gICAgZmlsdGVyUHJvcHM6IGdldEZpbHRlclByb3BzKGZpZWxkVHlwZXMudHlwZSwgYXR0cmlidXRlKSxcbiAgICAuLi5maWVsZFR5cGVzXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldEF0dHJpYnV0ZURvbWFpbih0eXBlOiBzdHJpbmcgfCBudWxsLCBhdHRyaWJ1dGU6IFRpcHBlY2Fub2VMYXllckF0dHJpYnV0ZSk6IG51bWJlcltdIHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBBTExfRklFTERfVFlQRVMucmVhbDpcbiAgICBjYXNlIEFMTF9GSUVMRF9UWVBFUy5pbnRlZ2VyOlxuICAgICAgcmV0dXJuIFtcbiAgICAgICAgTnVtYmVyLmlzRmluaXRlKGF0dHJpYnV0ZS5taW4pID8gKGF0dHJpYnV0ZS5taW4gYXMgbnVtYmVyKSA6IE5hTixcbiAgICAgICAgTnVtYmVyLmlzRmluaXRlKGF0dHJpYnV0ZS5tYXgpID8gKGF0dHJpYnV0ZS5tYXggYXMgbnVtYmVyKSA6IE5hTlxuICAgICAgXTtcblxuICAgIGNhc2UgQUxMX0ZJRUxEX1RZUEVTLmJvb2xlYW46XG4gICAgICByZXR1cm4gWzAsIDFdO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gWzAsIDFdO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIGZpZWxkIFRoaXMgZnVuY3Rpb24gbXV0YXRlcyB0aGUgZmllbGQgcGFyYW1ldGVyXG4gKi9cbmZ1bmN0aW9uIG1lcmdlQXR0cmlidXRlRG9tYWluKGZpZWxkOiBLZXBsZXJGaWVsZCwgYXR0cmlidXRlOiBUaXBwZWNhbm9lTGF5ZXJBdHRyaWJ1dGUpOiB2b2lkIHtcbiAgc3dpdGNoIChmaWVsZC50eXBlKSB7XG4gICAgY2FzZSBBTExfRklFTERfVFlQRVMucmVhbDpcbiAgICBjYXNlIEFMTF9GSUVMRF9UWVBFUy5pbnRlZ2VyOiB7XG4gICAgICBjb25zdCBkb21haW4gPSBmaWVsZC5tZXRhZGF0YT8uZG9tYWluIHx8IGZpZWxkLmZpbHRlclByb3BzPy5kb21haW47XG4gICAgICBpZiAoZG9tYWluKSB7XG4gICAgICAgIGRvbWFpbi5taW4gPSBjb21wYXJlKGF0dHJpYnV0ZS5taW4sIGRvbWFpblswXSwgJ21pbicpO1xuICAgICAgICBkb21haW4ubWF4ID0gY29tcGFyZShhdHRyaWJ1dGUubWF4LCBkb21haW5bMV0sICdtYXgnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybjtcbiAgfVxufVxuXG4vLyBwb3NzaWJsZSB0eXBlcyBodHRwczovL2dpdGh1Yi5jb20vbWFwYm94L3RpcHBlY2Fub2UjbW9kaWZ5aW5nLWZlYXR1cmUtYXR0cmlidXRlc1xuY29uc3QgYXR0clR5cGVNYXAgPSB7XG4gIG51bWJlcjoge1xuICAgIHR5cGU6IEFMTF9GSUVMRF9UWVBFUy5yZWFsLFxuICAgIGFuYWx5emVyVHlwZTogREFUQV9UWVBFUy5GTE9BVFxuICB9LFxuICBudW1lcmljOiB7XG4gICAgdHlwZTogQUxMX0ZJRUxEX1RZUEVTLnJlYWwsXG4gICAgYW5hbHl6ZXJUeXBlOiBEQVRBX1RZUEVTLkZMT0FUXG4gIH0sXG4gIHN0cmluZzoge1xuICAgIHR5cGU6IEFMTF9GSUVMRF9UWVBFUy5zdHJpbmcsXG4gICAgYW5hbHl6ZXJUeXBlOiBEQVRBX1RZUEVTLlNUUklOR1xuICB9LFxuICB2YWNoYXI6IHtcbiAgICB0eXBlOiBBTExfRklFTERfVFlQRVMuc3RyaW5nLFxuICAgIGFuYWx5emVyVHlwZTogREFUQV9UWVBFUy5TVFJJTkdcbiAgfSxcbiAgZmxvYXQ6IHtcbiAgICB0eXBlOiBBTExfRklFTERfVFlQRVMucmVhbCxcbiAgICBhbmFseXplclR5cGU6IERBVEFfVFlQRVMuRkxPQVRcbiAgfSxcbiAgaW50OiB7XG4gICAgdHlwZTogQUxMX0ZJRUxEX1RZUEVTLmludGVnZXIsXG4gICAgYW5hbHl6ZXJUeXBlOiBEQVRBX1RZUEVTLklOVFxuICB9LFxuICBpbnQ0OiB7XG4gICAgdHlwZTogQUxMX0ZJRUxEX1RZUEVTLmludGVnZXIsXG4gICAgYW5hbHl6ZXJUeXBlOiBEQVRBX1RZUEVTLklOVFxuICB9LFxuICBib29sZWFuOiB7XG4gICAgdHlwZTogQUxMX0ZJRUxEX1RZUEVTLmJvb2xlYW4sXG4gICAgYW5hbHl6ZXJUeXBlOiBEQVRBX1RZUEVTLkJPT0xFQU5cbiAgfSxcbiAgYm9vbDoge1xuICAgIHR5cGU6IEFMTF9GSUVMRF9UWVBFUy5ib29sZWFuLFxuICAgIGFuYWx5emVyVHlwZTogREFUQV9UWVBFUy5CT09MRUFOXG4gIH1cbn07XG5cbmZ1bmN0aW9uIGF0dHJpYnV0ZVR5cGVUb0ZpZWxkVHlwZShhVHlwZT86IHN0cmluZyk6IHt0eXBlOiBzdHJpbmc7IGFuYWx5emVyVHlwZTogc3RyaW5nfSB7XG4gIGNvbnN0IHR5cGUgPSBhVHlwZT8udG9Mb3dlckNhc2UoKTtcbiAgaWYgKCF0eXBlIHx8ICFhdHRyVHlwZU1hcFt0eXBlXSkge1xuICAgIENvbnNvbGUud2FybihcbiAgICAgIGBjYW5ub3QgY29udmVydCBhdHRyaWJ1dGUgdHlwZSAke3R5cGV9IHRvIGtlcGxlci5nbCBkYXRhIHR5cGUsIHVzZSBzdHJpbmcgYnkgZGVmYXVsdGBcbiAgICApO1xuICAgIHJldHVybiBhdHRyVHlwZU1hcC5zdHJpbmc7XG4gIH1cblxuICByZXR1cm4gYXR0clR5cGVNYXBbdHlwZV07XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIGEgZGF0YXNldCBjYW4gYmUgdXNlZCBhcyBzb3VyY2UgZGF0YSBmb3IgYSBsYXllci5cbiAqIEBwYXJhbSBkYXRhc2V0IEEgZGF0YXNldC5cbiAqIEBwYXJhbSBsYXllciBBIGxheWVyLlxuICogQHJldHVybnMgUmV0dXJucyB0cnVlIGlmIGEgZGF0YXNldCBjYW4gYmUgdXNlZCBhcyBzb3VyY2UgZGF0YSBmb3IgYSBsYXllci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoRGF0YXNldFR5cGUoZGF0YXNldDogS2VwbGVyRGF0YXNldCwgbGF5ZXI6IEtlcGxlckxheWVyKTogYm9vbGVhbiB7XG4gIC8vIGFsbG93IHNlbGVjdGlvbiBpZiB0eXBlIGlzIG5vdCBhc3NpZ25lZCB5ZXRcbiAgaWYgKCFsYXllci50eXBlKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgLy8gYWxsb3cgc2VsZWN0aW9uIGlmIGlzIGN1cnJlbnQgc2VsZWN0ZWQgZGF0YXNldFxuICBpZiAobGF5ZXIuY29uZmlnLmRhdGFJZCA9PT0gZGF0YXNldC5pZCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIC8vIGFsbG93IHNlbGVjdGlvbiBpZiBsYXllciBkb2Vzbid0IGhhdmUgc3VwcG9ydGVkRGF0YXNldFR5cGVzXG4gIGlmICghbGF5ZXIuc3VwcG9ydGVkRGF0YXNldFR5cGVzKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIEFycmF5LmlzQXJyYXkobGF5ZXIuc3VwcG9ydGVkRGF0YXNldFR5cGVzKSAmJlxuICAgIGxheWVyLnN1cHBvcnRlZERhdGFzZXRUeXBlcy5pbmNsdWRlcyhkYXRhc2V0LnR5cGUgfHwgJycpXG4gICk7XG59XG5cbnR5cGUgR2V0RmllbGRzRnJvbVRpbGVQcm9wcyA9IHtcbiAgcmVtb3RlVGlsZUZvcm1hdDogUmVtb3RlVGlsZUZvcm1hdDtcbiAgdGlsZXNldFVybDogc3RyaW5nIHwgbnVsbDtcbiAgbWV0YWRhdGFVcmw6IHN0cmluZyB8IG51bGw7XG4gIG1ldGFkYXRhOiBWZWN0b3JUaWxlTWV0YWRhdGEgfCBudWxsO1xufTtcblxuLyoqXG4gKiBFeHRyYWN0cyBmaWVsZHMgZnJvbSBhIHRpbGUgYW5kIHVwZGF0ZXMgdGhlIG1ldGFkYXRhIG9iamVjdCB3aXRoIGZvdW5kIGZpZWxkcy5cbiAqIE5vdGU6IHRoaXMgZnVuY3Rpb24gaXMgZm9yIHRpbGVzZXRzIHRoYXQgZG9uJ3QgaW5jbHVkZSBmaWVsZHMgaW4gbWV0YWRhdGEgKG1vc3QgbGlrZWx5IHNhdmVkIHdpdGggb2xkZXIgc3BlYy4pLlxuICogQHBhcmFtIHBhcmFtcy5yZW1vdGVUaWxlRm9ybWF0IFRoZSBmb3JtYXQgb2YgdGhlIHJlbW90ZSB0aWxlIChNVlQgb3IgUE1UaWxlcykuXG4gKiBAcGFyYW0gcGFyYW1zLnRpbGVzZXRVcmwgVGhlIFVSTCBvZiB0aGUgdGlsZXNldC5cbiAqIEBwYXJhbSBwYXJhbXMubWV0YWRhdGFVcmwgVGhlIFVSTCBvZiB0aGUgbWV0YWRhdGEuXG4gKiBAcGFyYW0gcGFyYW1zLm1ldGFkYXRhIFRoZSBtZXRhZGF0YSBvYmplY3QgY29udGFpbmluZyBmaWVsZHMgYW5kIHRpbGUgcHJvcGVydGllcy5cbiAqL1xuZXhwb3J0IGNvbnN0IGdldEZpZWxkc0Zyb21UaWxlID0gYXN5bmMgKHtcbiAgcmVtb3RlVGlsZUZvcm1hdCxcbiAgdGlsZXNldFVybCxcbiAgbWV0YWRhdGFVcmwsXG4gIG1ldGFkYXRhXG59OiBHZXRGaWVsZHNGcm9tVGlsZVByb3BzKSA9PiB7XG4gIHRyeSB7XG4gICAgaWYgKFxuICAgICAgdGlsZXNldFVybCAmJlxuICAgICAgbWV0YWRhdGFVcmwgJiZcbiAgICAgIG1ldGFkYXRhICYmXG4gICAgICBtZXRhZGF0YS5maWVsZHM/Lmxlbmd0aCA9PT0gMCAmJlxuICAgICAgbWV0YWRhdGEubWluWm9vbSAmJlxuICAgICAgbWV0YWRhdGEuYm91bmRzPy5sZW5ndGggPT09IDQgJiZcbiAgICAgICghbWV0YWRhdGEucG10aWxlc1R5cGUgfHwgbWV0YWRhdGEucG10aWxlc1R5cGUgPT09IFBNVGlsZXNUeXBlLk1WVClcbiAgICApIHtcbiAgICAgIGNvbnN0IGxvbiA9IChtZXRhZGF0YS5ib3VuZHNbMF0gKyBtZXRhZGF0YS5ib3VuZHNbMl0pIC8gMjtcbiAgICAgIGNvbnN0IGxhdCA9IChtZXRhZGF0YS5ib3VuZHNbMV0gKyBtZXRhZGF0YS5ib3VuZHNbM10pIC8gMjtcbiAgICAgIGNvbnN0IHRpbGVJbmRpY2VzID0gbG9uTGF0VG9UaWxlSW5kZXgobG9uLCBsYXQsIG1ldGFkYXRhLm1pblpvb20pO1xuXG4gICAgICBjb25zdCB0aWxlU291cmNlID1cbiAgICAgICAgcmVtb3RlVGlsZUZvcm1hdCA9PT0gUmVtb3RlVGlsZUZvcm1hdC5NVlRcbiAgICAgICAgICA/IE1WVFNvdXJjZS5jcmVhdGVEYXRhU291cmNlKGRlY29kZVVSSUNvbXBvbmVudCh0aWxlc2V0VXJsKSwge1xuICAgICAgICAgICAgICBtdnQ6IHtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YVVybDogZGVjb2RlVVJJQ29tcG9uZW50KG1ldGFkYXRhVXJsKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIDogUE1UaWxlc1NvdXJjZS5jcmVhdGVEYXRhU291cmNlKHRpbGVzZXRVcmwsIHt9KTtcbiAgICAgIGNvbnN0IHRpbGUgPSBhd2FpdCB0aWxlU291cmNlLmdldFRpbGVEYXRhKHtpbmRleDogdGlsZUluZGljZXN9IGFzIGFueSk7XG4gICAgICBjb25zdCB1cGRhdGVkRmllbGRzID0gdGlsZVRvRmllbGRzKHRpbGUpLm1hcChmID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5mLFxuICAgICAgICAgIGFuYWx5emVyVHlwZTogZi5hbmFseXplclR5cGUgfHwgQUxMX0ZJRUxEX1RZUEVTLnN0cmluZyxcbiAgICAgICAgICBpZDogZi5pZCB8fCBmLm5hbWVcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICBtZXRhZGF0YS5maWVsZHMgPSB1cGRhdGVkRmllbGRzO1xuICAgIH1cbiAgfSBjYXRjaCB7XG4gICAgLy8gaWdub3JlLCBhcyB0aGlzIGlzIGV4cGVyaW1lbnRhbCBmYWxsYmFja1xuICB9XG59O1xuXG4vKipcbiAqIENvbnZlcnRzIHRpbGUgZmVhdHVyZXMgaW50byBLZXBsZXIgZmllbGRzLlxuICogQHBhcmFtIHRpbGUgVGhlIHRpbGUgb2JqZWN0IGNvbnRhaW5pbmcgZmVhdHVyZXMuXG4gKiBAcmV0dXJucyBBbiBhcnJheSBvZiBLZXBsZXIgZmllbGRzIGRlcml2ZWQgZnJvbSB0aGUgdGlsZSdzIGZlYXR1cmVzLlxuICovXG5jb25zdCB0aWxlVG9GaWVsZHMgPSAodGlsZToge2ZlYXR1cmVzOiBGZWF0dXJlW119KTogS2VwbGVyRmllbGRbXSA9PiB7XG4gIGlmICh0aWxlPy5mZWF0dXJlcz8ubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGhlYWRlciA9IE9iamVjdC5rZXlzKHRpbGUuZmVhdHVyZXNbMF0ucHJvcGVydGllcyk7XG4gICAgY29uc3Qgb3V0cHV0ID0gdGlsZS5mZWF0dXJlcy5tYXAoZiA9PiB7XG4gICAgICBjb25zdCBvYmogPSB7fTtcbiAgICAgIGhlYWRlci5mb3JFYWNoKGNvbHVtbk5hbWUgPT4ge1xuICAgICAgICBvYmpbY29sdW1uTmFtZV0gPSBmLnByb3BlcnRpZXNbY29sdW1uTmFtZV07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSk7XG5cbiAgICBjb25zdCBmaWVsZHMgPSBnZXRGaWVsZHNGcm9tRGF0YShvdXRwdXQsIGhlYWRlcik7XG4gICAgLy8gZXh0cmEgdHJhbnNmb3JtYXRpb24gb2Ygc3RyaW5ncyB0byBudW1iZXJzIGZvciB0aWxlcyBpc24ndCBpbXBsZW1lbnRlZCwgc28gdXNlIHN0cmluZywgbm90IGNvbXB1dGVkIHR5cGVzXG4gICAgcmV0dXJuIGZpZWxkcy5tYXAoZiA9PiB7XG4gICAgICBjb25zdCBmb3JjZVN0cmluZyA9XG4gICAgICAgIChmLnR5cGUgPT09ICdpbnRlZ2VyJyB8fCBmLnR5cGUgPT09ICdmbG9hdCcpICYmXG4gICAgICAgIHR5cGVvZiB0aWxlLmZlYXR1cmVzWzBdLnByb3BlcnRpZXNbZi5uYW1lXSA9PT0gJ3N0cmluZyc7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmYsXG4gICAgICAgIGFuYWx5emVyVHlwZTogZm9yY2VTdHJpbmcgPyBBTkFMWVpFUl9EQVRBX1RZUEVTLlNUUklORyA6IGYuYW5hbHl6ZXJUeXBlLFxuICAgICAgICB0eXBlOiBmb3JjZVN0cmluZyA/ICdzdHJpbmcnIDogZi50eXBlXG4gICAgICB9O1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBbXTtcbn07XG5cbi8qKlxuICogQ29udmVydHMgbG9uZ2l0dWRlLCBsYXRpdHVkZSwgYW5kIHpvb20gbGV2ZWwgaW50byB2ZWN0b3IgdGlsZSBpbmRpY2VzICh4LCB5LCB6KS5cbiAqIEBwYXJhbSBsb24gTG9uZ2l0dWRlIGluIGRlZ3JlZXMsIHJhbmdpbmcgZnJvbSAtMTgwIHRvIDE4MC5cbiAqIEBwYXJhbSBsYXQgTGF0aXR1ZGUgaW4gZGVncmVlcywgcmFuZ2luZyBmcm9tIC05MCB0byA5MC5cbiAqIEBwYXJhbSB6b29tIFpvb20gbGV2ZWwgKGludGVnZXIpLCB3aGVyZSBoaWdoZXIgdmFsdWVzIHByb3ZpZGUgbW9yZSBkZXRhaWwuXG4gKiBAcmV0dXJucyBUaWxlIGluZGljZXMgd2l0aCB4IGFuZCB5IGNvb3JkaW5hdGVzIGFuZCB6b29tIGxldmVsIHouXG4gKi9cbmZ1bmN0aW9uIGxvbkxhdFRvVGlsZUluZGV4KGxvbjogbnVtYmVyLCBsYXQ6IG51bWJlciwgem9vbTogbnVtYmVyKSB7XG4gIGlmIChsYXQgPCAtODUuMDUxMSB8fCBsYXQgPiA4NS4wNTExKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMYXRpdHVkZSBvdXQgb2YgcmFuZ2UuIE11c3QgYmUgYmV0d2VlbiAtODUuMDUxMSBhbmQgODUuMDUxMS4nKTtcbiAgfVxuICBpZiAoem9vbSA8IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1pvb20gbGV2ZWwgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBpbnRlZ2VyLicpO1xuICB9XG5cbiAgLy8gMl56b29tIChudW1iZXIgb2YgdGlsZXMgcGVyIGF4aXMgYXQgZ2l2ZW4gem9vbSBsZXZlbClcbiAgY29uc3Qgc2NhbGUgPSAxIDw8IHpvb207XG4gIC8vIENvbnZlcnQgbG9uZ2l0dWRlIHRvIHRpbGUgWFxuICBjb25zdCB4ID0gTWF0aC5mbG9vcigoKGxvbiArIDE4MCkgLyAzNjApICogc2NhbGUpO1xuICAvLyBDb252ZXJ0IGxhdGl0dWRlIHRvIHRpbGUgWVxuICBjb25zdCBsYXRSYWQgPSAobGF0ICogTWF0aC5QSSkgLyAxODA7XG4gIGNvbnN0IHkgPSBNYXRoLmZsb29yKFxuICAgICgoMSAtIE1hdGgubG9nKE1hdGgudGFuKGxhdFJhZCkgKyAxIC8gTWF0aC5jb3MobGF0UmFkKSkgLyBNYXRoLlBJKSAvIDIpICogc2NhbGVcbiAgKTtcblxuICByZXR1cm4ge3gsIHksIHo6IHpvb219O1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBR0EsSUFBQUEsYUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsUUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBQyxzQkFBQSxDQUFBSCxPQUFBO0FBQ0EsSUFBQUksS0FBQSxHQUFBRCxzQkFBQSxDQUFBSCxPQUFBO0FBR0EsSUFBQUssSUFBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sUUFBQSxHQUFBTixPQUFBO0FBRUEsSUFBQU8sWUFBQSxHQUFBUCxPQUFBO0FBT0EsSUFBQVEsVUFBQSxHQUFBUixPQUFBO0FBU0EsSUFBQVMsTUFBQSxHQUFBVCxPQUFBO0FBQWdHLFNBQUFVLDJCQUFBQyxDQUFBLEVBQUFDLENBQUEsUUFBQUMsQ0FBQSx5QkFBQUMsTUFBQSxJ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LElBQUlqQyxDQUFDLENBQUNpQyxJQUFJLEtBQUssT0FBTyxLQUMzQyxPQUFPcU8sSUFBSSxDQUFDcUIsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDRSxVQUFVLENBQUM3UixDQUFDLENBQUNXLElBQUksQ0FBQyxLQUFLLFFBQVE7TUFFekQsT0FBQVksYUFBQSxDQUFBQSxhQUFBLEtBQ0t2QixDQUFDO1FBQ0prTyxZQUFZLEVBQUVnRSxXQUFXLEdBQUdDLHdCQUFtQixDQUFDN0QsTUFBTSxHQUFHdE8sQ0FBQyxDQUFDa08sWUFBWTtRQUN2RWpNLElBQUksRUFBRWlRLFdBQVcsR0FBRyxRQUFRLEdBQUdsUyxDQUFDLENBQUNpQztNQUFJO0lBRXpDLENBQUMsQ0FBQztFQUNKO0VBQ0EsT0FBTyxFQUFFO0FBQ1gsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMyTyxpQkFBaUJBLENBQUNWLEdBQVcsRUFBRUMsR0FBVyxFQUFFaUMsSUFBWSxFQUFFO0VBQ2pFLElBQUlqQyxHQUFHLEdBQUcsQ0FBQyxPQUFPLElBQUlBLEdBQUcsR0FBRyxPQUFPLEVBQUU7SUFDbkMsTUFBTSxJQUFJa0MsS0FBSyxDQUFDLDhEQUE4RCxDQUFDO0VBQ2pGO0VBQ0EsSUFBSUQsSUFBSSxHQUFHLENBQUMsRUFBRTtJQUNaLE1BQU0sSUFBSUMsS0FBSyxDQUFDLDRDQUE0QyxDQUFDO0VBQy9EOztFQUVBO0VBQ0EsSUFBTUMsS0FBSyxHQUFHLENBQUMsSUFBSUYsSUFBSTtFQUN2QjtFQUNBLElBQU1HLENBQUMsR0FBRzlGLElBQUksQ0FBQytGLEtBQUssQ0FBRSxDQUFDdEMsR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUFHLEdBQUlvQyxLQUFLLENBQUM7RUFDakQ7RUFDQSxJQUFNRyxNQUFNLEdBQUl0QyxHQUFHLEdBQUcxRCxJQUFJLENBQUNpRyxFQUFFLEdBQUksR0FBRztFQUNwQyxJQUFNQyxDQUFDLEdBQUdsRyxJQUFJLENBQUMrRixLQUFLLENBQ2pCLENBQUMsQ0FBQyxHQUFHL0YsSUFBSSxDQUFDbUcsR0FBRyxDQUFDbkcsSUFBSSxDQUFDb0csR0FBRyxDQUFDSixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUdoRyxJQUFJLENBQUNxRyxHQUFHLENBQUNMLE1BQU0sQ0FBQyxDQUFDLEdBQUdoRyxJQUFJLENBQUNpRyxFQUFFLElBQUksQ0FBQyxHQUFJSixLQUM1RSxDQUFDO0VBRUQsT0FBTztJQUFDQyxDQUFDLEVBQURBLENBQUM7SUFBRUksQ0FBQyxFQUFEQSxDQUFDO0lBQUVJLENBQUMsRUFBRVg7RUFBSSxDQUFDO0FBQ3hCIiwiaWdub3JlTGlzdCI6W119